<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>Web Authentication: An API for accessing Scoped Credentials </title>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <meta content="ED" name="w3c-status">
  <meta content="Bikeshed version 176d39d5a285c04f57d2f0e078fa69273028eb45" name="generator">
<style>/* style-md-lists */

            /* This is a weird hack for me not yet following the commonmark spec
               regarding paragraph and lists. */
            [data-md] > :first-child {
                margin-top: 0;
            }
            [data-md] > :last-child {
                margin-bottom: 0;
            }</style>
<style>/* style-selflinks */

            .heading, .issue, .note, .example, li, dt {
                position: relative;
            }
            a.self-link {
                position: absolute;
                top: 0;
                left: calc(-1 * (3.5rem - 26px));
                width: calc(3.5rem - 26px);
                height: 2em;
                text-align: center;
                border: none;
                transition: opacity .2s;
                opacity: .5;
            }
            a.self-link:hover {
                opacity: 1;
            }
            .heading > a.self-link {
                font-size: 83%;
            }
            li > a.self-link {
                left: calc(-1 * (3.5rem - 26px) - 2em);
            }
            dfn > a.self-link {
                top: auto;
                left: auto;
                opacity: 0;
                width: 1.5em;
                height: 1.5em;
                background: gray;
                color: white;
                font-style: normal;
                transition: opacity .2s, background-color .2s, color .2s;
            }
            dfn:hover > a.self-link {
                opacity: 1;
            }
            dfn > a.self-link:hover {
                color: black;
            }

            a.self-link::before            { content: "¶"; }
            .heading > a.self-link::before { content: "§"; }
            dfn > a.self-link::before      { content: "#"; }</style>
<style>/* style-counters */

            body {
                counter-reset: example figure issue;
            }
            .issue {
                counter-increment: issue;
            }
            .issue:not(.no-marker)::before {
                content: "Issue " counter(issue);
            }

            .example {
                counter-increment: example;
            }
            .example:not(.no-marker)::before {
                content: "Example " counter(example);
            }
            .invalid.example:not(.no-marker)::before,
            .illegal.example:not(.no-marker)::before {
                content: "Invalid Example" counter(example);
            }

            figcaption {
                counter-increment: figure;
            }
            figcaption:not(.no-marker)::before {
                content: "Figure " counter(figure) " ";
            }</style>
<style>/* style-autolinks */

            .css.css, .property.property, .descriptor.descriptor {
                color: #005a9c;
                font-size: inherit;
                font-family: inherit;
            }
            .css::before, .property::before, .descriptor::before {
                content: "‘";
            }
            .css::after, .property::after, .descriptor::after {
                content: "’";
            }
            .property, .descriptor {
                /* Don't wrap property and descriptor names */
                white-space: nowrap;
            }
            .type { /* CSS value <type> */
                font-style: italic;
            }
            pre .property::before, pre .property::after {
                content: "";
            }
            [data-link-type="property"]::before,
            [data-link-type="propdesc"]::before,
            [data-link-type="descriptor"]::before,
            [data-link-type="value"]::before,
            [data-link-type="function"]::before,
            [data-link-type="at-rule"]::before,
            [data-link-type="selector"]::before,
            [data-link-type="maybe"]::before {
                content: "‘";
            }
            [data-link-type="property"]::after,
            [data-link-type="propdesc"]::after,
            [data-link-type="descriptor"]::after,
            [data-link-type="value"]::after,
            [data-link-type="function"]::after,
            [data-link-type="at-rule"]::after,
            [data-link-type="selector"]::after,
            [data-link-type="maybe"]::after {
                content: "’";
            }

            [data-link-type].production::before,
            [data-link-type].production::after,
            .prod [data-link-type]::before,
            .prod [data-link-type]::after {
                content: "";
            }

            [data-link-type=element],
            [data-link-type=element-attr] {
                font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
                font-size: .9em;
            }
            [data-link-type=element]::before { content: "<" }
            [data-link-type=element]::after  { content: ">" }

            [data-link-type=biblio] {
                white-space: pre;
            }</style>
<style>/* style-dfn-panel */

        .dfn-panel {
            position: absolute;
            z-index: 35;
            height: auto;
            width: -webkit-fit-content;
            width: fit-content;
            max-width: 300px;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.75em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: #DDDDDD;
            color: black;
            border: outset 0.2em;
        }
        .dfn-panel:not(.on) { display: none; }
        .dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
        .dfn-panel > b { display: block; }
        .dfn-panel a { color: black; }
        .dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
        .dfn-panel > b + b { margin-top: 0.25em; }
        .dfn-panel ul { padding: 0; }
        .dfn-panel li { list-style: inside; }
        .dfn-panel.activated {
            display: inline-block;
            position: fixed;
            left: .5em;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - 1.5em - .4em - .5em);
            max-height: 30vh;
        }

        .dfn-paneled { cursor: pointer; }
        </style>
<style>/* style-syntax-highlighting */
pre.idl.highlight { color: #708090; }
        .highlight:not(.idl) { background: hsl(24, 20%, 95%); }
        code.highlight { padding: .1em; border-radius: .3em; }
        pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }
        .highlight .c { color: #708090 } /* Comment */
        .highlight .k { color: #990055 } /* Keyword */
        .highlight .l { color: #000000 } /* Literal */
        .highlight .n { color: #0077aa } /* Name */
        .highlight .o { color: #999999 } /* Operator */
        .highlight .p { color: #999999 } /* Punctuation */
        .highlight .cm { color: #708090 } /* Comment.Multiline */
        .highlight .cp { color: #708090 } /* Comment.Preproc */
        .highlight .c1 { color: #708090 } /* Comment.Single */
        .highlight .cs { color: #708090 } /* Comment.Special */
        .highlight .kc { color: #990055 } /* Keyword.Constant */
        .highlight .kd { color: #990055 } /* Keyword.Declaration */
        .highlight .kn { color: #990055 } /* Keyword.Namespace */
        .highlight .kp { color: #990055 } /* Keyword.Pseudo */
        .highlight .kr { color: #990055 } /* Keyword.Reserved */
        .highlight .kt { color: #990055 } /* Keyword.Type */
        .highlight .ld { color: #000000 } /* Literal.Date */
        .highlight .m { color: #000000 } /* Literal.Number */
        .highlight .s { color: #a67f59 } /* Literal.String */
        .highlight .na { color: #0077aa } /* Name.Attribute */
        .highlight .nc { color: #0077aa } /* Name.Class */
        .highlight .no { color: #0077aa } /* Name.Constant */
        .highlight .nd { color: #0077aa } /* Name.Decorator */
        .highlight .ni { color: #0077aa } /* Name.Entity */
        .highlight .ne { color: #0077aa } /* Name.Exception */
        .highlight .nf { color: #0077aa } /* Name.Function */
        .highlight .nl { color: #0077aa } /* Name.Label */
        .highlight .nn { color: #0077aa } /* Name.Namespace */
        .highlight .py { color: #0077aa } /* Name.Property */
        .highlight .nt { color: #669900 } /* Name.Tag */
        .highlight .nv { color: #222222 } /* Name.Variable */
        .highlight .ow { color: #999999 } /* Operator.Word */
        .highlight .mb { color: #000000 } /* Literal.Number.Bin */
        .highlight .mf { color: #000000 } /* Literal.Number.Float */
        .highlight .mh { color: #000000 } /* Literal.Number.Hex */
        .highlight .mi { color: #000000 } /* Literal.Number.Integer */
        .highlight .mo { color: #000000 } /* Literal.Number.Oct */
        .highlight .sb { color: #a67f59 } /* Literal.String.Backtick */
        .highlight .sc { color: #a67f59 } /* Literal.String.Char */
        .highlight .sd { color: #a67f59 } /* Literal.String.Doc */
        .highlight .s2 { color: #a67f59 } /* Literal.String.Double */
        .highlight .se { color: #a67f59 } /* Literal.String.Escape */
        .highlight .sh { color: #a67f59 } /* Literal.String.Heredoc */
        .highlight .si { color: #a67f59 } /* Literal.String.Interpol */
        .highlight .sx { color: #a67f59 } /* Literal.String.Other */
        .highlight .sr { color: #a67f59 } /* Literal.String.Regex */
        .highlight .s1 { color: #a67f59 } /* Literal.String.Single */
        .highlight .ss { color: #a67f59 } /* Literal.String.Symbol */
        .highlight .vc { color: #0077aa } /* Name.Variable.Class */
        .highlight .vg { color: #0077aa } /* Name.Variable.Global */
        .highlight .vi { color: #0077aa } /* Name.Variable.Instance */
        .highlight .il { color: #000000 } /* Literal.Number.Integer.Long */
        </style>
  <link href="https://www.w3.org/StyleSheets/TR/2016/W3C-ED" rel="stylesheet" type="text/css">
 <body class="h-entry">
  <div class="head">
   <header>
    <p data-fill-with="logo"><a href="https://www.w3.org/"><img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C" width="72"></a> </p>
    <h1 class="p-name no-ref" id="title">Web Authentication: An API for accessing Scoped Credentials </h1>
    <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">Editor’s Draft, <time class="dt-updated" datetime="2017-01-11">11 January 2017</time></span></h2>
   </header>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://w3c.github.io/webauthn/">https://w3c.github.io/webauthn/</a>
     <dt>Latest published version:
     <dd><a href="https://www.w3.org/TR/webauthn/">https://www.w3.org/TR/webauthn/</a>
     <dt>Previous Versions:
     <dd><a href="https://www.w3.org/TR/2016/WD-webauthn-20161207/" rel="previous">https://www.w3.org/TR/2016/WD-webauthn-20161207/</a>
     <dd><a href="https://www.w3.org/TR/2016/WD-webauthn-20160928/" rel="previous">https://www.w3.org/TR/2016/WD-webauthn-20160928/</a>
     <dd><a href="https://www.w3.org/TR/2016/WD-webauthn-20160902/" rel="previous">https://www.w3.org/TR/2016/WD-webauthn-20160902/</a>
     <dd><a href="https://www.w3.org/TR/2016/WD-webauthn-20160531/" rel="previous">https://www.w3.org/TR/2016/WD-webauthn-20160531/</a>
     <dt>Issue Tracking:
     <dd><a href="https://github.com/w3c/webauthn/issues">Github</a>
     <dt class="editor">Editors:
     <dd class="editor p-author h-card vcard" data-editor-id="55440"><a class="p-name fn u-email email" href="mailto:vijay.bharadwaj@microsoft.com">Vijay Bharadwaj</a> (<span class="p-org org">Microsoft</span>)
     <dd class="editor p-author h-card vcard" data-editor-id="84817"><a class="p-name fn u-email email" href="mailto:hlevangong@paypal.com">Hubert Le Van Gong</a> (<span class="p-org org">PayPal</span>)
     <dd class="editor p-author h-card vcard" data-editor-id="47648"><a class="p-name fn u-email email" href="mailto:balfanz@google.com">Dirk Balfanz</a> (<span class="p-org org">Google</span>)
     <dd class="editor p-author h-card vcard" data-editor-id="87258"><a class="p-name fn u-email email" href="mailto:aczeskis@google.com">Alexei Czeskis</a> (<span class="p-org org">Google</span>)
     <dd class="editor p-author h-card vcard" data-editor-id="87332"><a class="p-name fn u-email email" href="mailto:arnarb@google.com">Arnar Birgisson</a> (<span class="p-org org">Google</span>)
     <dd class="editor p-author h-card vcard" data-editor-id="43843"><a class="p-name fn u-email email" href="mailto:Jeff.Hodges@paypal.com">Jeff Hodges</a> (<span class="p-org org">PayPal</span>)
     <dd class="editor p-author h-card vcard" data-editor-id="38745"><a class="p-name fn u-email email" href="mailto:mbj@microsoft.com">Michael B. Jones</a> (<span class="p-org org">Microsoft</span>)
     <dd class="editor p-author h-card vcard" data-editor-id="84447"><a class="p-name fn u-email email" href="mailto:rolf@noknok.com">Rolf Lindemann</a> (<span class="p-org org">Nok Nok Labs</span>)
     <dd class="editor p-author h-card vcard" data-editor-id="87240"><a class="p-name fn u-email email" href="mailto:jc@mozilla.com">J.C. Jones</a> (<span class="p-org org">Mozilla</span>)
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2017 <a href="https://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="http://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href="http://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="http://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>). W3C <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="https://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply. </p>
   <hr title="Separator for header">
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
  <div class="p-summary" data-fill-with="abstract">
   <p>This specification defines an API enabling the creation and use of strong, attested, cryptographic scoped credentials

by web applications, for the purpose of strongly authenticating users. Conceptually, one or more credentials, each scoped to a
given Relying Party, are created and stored on an authenticator by the user agent in conjunction with the web application. The
user agent mediates access to scoped credentials in order to preserve user privacy. Authenticators are responsible for ensuring
that no operation is performed without user consent. Authenticators provide cryptographic proof of their properties to relying
parties via attestation. This specification also describes the functional model for WebAuthn conformant authenticators,
including their signature and attestation functionality.</p>
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> <em>This section describes the status of this document at the time of its publication. Other
    documents may supersede this document. A list of current <abbr title="World Wide Web Consortium">W3C</abbr> publications and the latest revision of this
    technical report can be found in the <a href="https://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> technical
    reports index</a> at https://www.w3.org/TR/.</em> </p>
   <p> This document was published by the <a href="https://www.w3.org/webauthn/">Web Authentication Working Group</a> as an Editors' Draft. This document is intended to become a W3C Recommendation.

    Feedback and comments on this specification are welcome. Please use <a href="https://github.com/w3c/webauthn/issues">Github issues</a>.
    Discussions may also be found in the <a href="https://lists.w3.org/Archives/Public/public-webauthn/">public-webauthn@w3.org archives</a>. </p>
   <p> Publication as an Editors' Draft does not imply endorsement by the <abbr title="World Wide Web Consortium">W3C</abbr> Membership. This is a draft document and may
    be updated, replaced or obsoleted by other documents at any time. It is inappropriate to cite
    this document as other than work in progress. </p>
   <p> This document was produced by a group operating under the <a href="https://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004 <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>. <abbr title="World Wide Web Consortium">W3C</abbr> maintains a <a href="https://www.w3.org/2004/01/pp-impl/87227/status" rel="disclosure">public list of any
    patent disclosures</a> made in connection with the deliverables of the group; that page also
    includes instructions for disclosing a patent. An individual who has actual knowledge of a
    patent which the individual believes contains <a href="https://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential
    Claim(s)</a> must disclose the information in accordance with <a href="https://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section 6 of the <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>. </p>
   <p> This document is governed by the <a href="https://www.w3.org/2015/Process-20150901/" id="w3c_process_revision">1 September 2015 <abbr title="World Wide Web Consortium">W3C</abbr> Process Document</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ol class="toc">
      <li>
       <a href="#use-cases"><span class="secno">1.1</span> <span class="content">Use Cases</span></a>
       <ol class="toc">
        <li><a href="#usecase-registration"><span class="secno">1.1.1</span> <span class="content">Registration</span></a>
        <li><a href="#usecase-authentication"><span class="secno">1.1.2</span> <span class="content">Authentication</span></a>
        <li><a href="#other-configurations"><span class="secno">1.1.3</span> <span class="content">Other use cases and configurations</span></a>
       </ol>
     </ol>
    <li>
     <a href="#conformance"><span class="secno">2</span> <span class="content">Conformance</span></a>
     <ol class="toc">
      <li><a href="#dependencies"><span class="secno">2.1</span> <span class="content">Dependencies</span></a>
     </ol>
    <li><a href="#terminology"><span class="secno">3</span> <span class="content">Terminology</span></a>
    <li>
     <a href="#api"><span class="secno">4</span> <span class="content"><span>Web Authentication API</span></span></a>
     <ol class="toc">
      <li>
       <a href="#iface-credential"><span class="secno">4.1</span> <span class="content"><span>WebAuthentication</span> Interface</span></a>
       <ol class="toc">
        <li><a href="#makeCredential"><span class="secno">4.1.1</span> <span class="content">Create a new credential (<span>makeCredential()</span> method)</span></a>
        <li><a href="#getAssertion"><span class="secno">4.1.2</span> <span class="content">Use an existing credential (<span>getAssertion()</span> method)</span></a>
       </ol>
      <li><a href="#iface-credentialInfo"><span class="secno">4.2</span> <span class="content">Information about Scoped Credential (interface <span>ScopedCredentialInfo</span>)</span></a>
      <li><a href="#iface-account"><span class="secno">4.3</span> <span class="content">User Account Information (dictionary <span>Account</span>)</span></a>
      <li><a href="#credential-params"><span class="secno">4.4</span> <span class="content">Parameters for Credential Generation (dictionary <span>ScopedCredentialParameters</span>)</span></a>
      <li>
       <a href="#credential-options"><span class="secno">4.5</span> <span class="content">Additional options for Credential Generation (dictionary <span>ScopedCredentialOptions</span>)</span></a>
       <ol class="toc">
        <li><a href="#attachment"><span class="secno">4.5.1</span> <span class="content">Credential Attachment enumeration (enum <span>Attachment</span>)</span></a>
       </ol>
      <li><a href="#iface-assertion"><span class="secno">4.6</span> <span class="content">Web Authentication Assertion (interface <span>AuthenticationAssertion</span>)</span></a>
      <li><a href="#assertion-options"><span class="secno">4.7</span> <span class="content">Additional options for Assertion Generation (dictionary <span>AssertionOptions</span>)</span></a>
      <li><a href="#iface-assertion-extensions"><span class="secno">4.8</span> <span class="content">Authentication Assertion Extensions (dictionary <span>AuthenticationExtensions</span>)</span></a>
      <li><a href="#iface-attestation"><span class="secno">4.9</span> <span class="content">Credential Attestation Structure (interface <span>AuthenticationAttestation</span>)</span></a>
      <li>
       <a href="#supporting-data-structures"><span class="secno">4.10</span> <span class="content">Supporting Data Structures</span></a>
       <ol class="toc">
        <li><a href="#sec-client-data"><span class="secno">4.10.1</span> <span class="content">Client data used in WebAuthn signatures (dictionary <span>ClientData</span>)</span></a>
        <li><a href="#credentialType"><span class="secno">4.10.2</span> <span class="content">Credential Type enumeration (enum <span>ScopedCredentialType</span>)</span></a>
        <li><a href="#credential-identifier"><span class="secno">4.10.3</span> <span class="content">Unique Identifier for Credential (interface <span>ScopedCredential</span>)</span></a>
        <li><a href="#credential-dictionary"><span class="secno">4.10.4</span> <span class="content">Credential Descriptor (dictionary <span>ScopedCredentialDescriptor</span>)</span></a>
        <li><a href="#transport"><span class="secno">4.10.5</span> <span class="content">Credential Transport enumeration (enum <span>ExternalTransport</span>)</span></a>
        <li><a href="#alg-identifier"><span class="secno">4.10.6</span> <span class="content">Cryptographic Algorithm Identifier (type <code class="idl"><span>AlgorithmIdentifier</span></code>)</span></a>
       </ol>
     </ol>
    <li>
     <a href="#authenticator-model"><span class="secno">5</span> <span class="content">WebAuthn Authenticator model</span></a>
     <ol class="toc">
      <li>
       <a href="#authenticator-ops"><span class="secno">5.1</span> <span class="content">Authenticator operations</span></a>
       <ol class="toc">
        <li><a href="#op-make-cred"><span class="secno">5.1.1</span> <span class="content">The <span>authenticatorMakeCredential</span> operation</span></a>
        <li><a href="#op-get-assertion"><span class="secno">5.1.2</span> <span class="content">The <span>authenticatorGetAssertion</span> operation</span></a>
        <li><a href="#op-cancel"><span class="secno">5.1.3</span> <span class="content">The <span>authenticatorCancel</span> operation</span></a>
       </ol>
      <li>
       <a href="#signature-format"><span class="secno">5.2</span> <span class="content">Signature Format</span></a>
       <ol class="toc">
        <li><a href="#sec-authenticator-data"><span class="secno">5.2.1</span> <span class="content">Authenticator data</span></a>
        <li><a href="#authenticator-signature"><span class="secno">5.2.2</span> <span class="content">Generating a signature</span></a>
        <li><a href="#authenticator-signature-verification"><span class="secno">5.2.3</span> <span class="content">Verifying a signature</span></a>
       </ol>
      <li>
       <a href="#cred-attestation-stmts"><span class="secno">5.3</span> <span class="content">Credential Attestation Statements</span></a>
       <ol class="toc">
        <li><a href="#attestation-formats"><span class="secno">5.3.1</span> <span class="content">Attestation Formats</span></a>
        <li><a href="#sctn-attestation-types"><span class="secno">5.3.2</span> <span class="content">Attestation Types</span></a>
        <li><a href="#generating-an-attestation-statement"><span class="secno">5.3.3</span> <span class="content">Generating an Attestation Statement</span></a>
        <li><a href="#verifying-an-attestation-statement"><span class="secno">5.3.4</span> <span class="content">Verifying an Attestation Statement</span></a>
        <li>
         <a href="#sec-attestation-security-considerations"><span class="secno">5.3.5</span> <span class="content">Security Considerations</span></a>
         <ol class="toc">
          <li><a href="#sec-attestation-privacy"><span class="secno">5.3.5.1</span> <span class="content">Privacy</span></a>
          <li><a href="#ca-compromise"><span class="secno">5.3.5.2</span> <span class="content">Attestation Certificate and Attestation Certificate CA Compromise</span></a>
          <li><a href="#cert-hierarchy"><span class="secno">5.3.5.3</span> <span class="content">Attestation Certificate Hierarchy</span></a>
         </ol>
       </ol>
     </ol>
    <li>
     <a href="#defined-attestation-formats"><span class="secno">6</span> <span class="content">Defined Attestation Formats</span></a>
     <ol class="toc">
      <li><a href="#sctn-attstn-fmt-ids"><span class="secno">6.1</span> <span class="content">Attestation Format Identifiers</span></a>
      <li>
       <a href="#packed-attestation"><span class="secno">6.2</span> <span class="content">Packed Attestation Format</span></a>
       <ol class="toc">
        <li><a href="#packed-attestation-cert-requirements"><span class="secno">6.2.1</span> <span class="content">Packed attestation statement certificate requirements</span></a>
       </ol>
      <li>
       <a href="#tpm-attestation"><span class="secno">6.3</span> <span class="content">TPM Attestation Format</span></a>
       <ol class="toc">
        <li><a href="#tpm-cert-requirements"><span class="secno">6.3.1</span> <span class="content">TPM attestation statement certificate requirements</span></a>
       </ol>
      <li><a href="#android-key-attestation"><span class="secno">6.4</span> <span class="content">Android Key Attestation Format</span></a>
      <li><a href="#android-safetynet-attestation"><span class="secno">6.5</span> <span class="content">Android SafetyNet Attestation Format</span></a>
     </ol>
    <li>
     <a href="#extensions"><span class="secno">7</span> <span class="content">WebAuthn Extensions</span></a>
     <ol class="toc">
      <li><a href="#extension-id"><span class="secno">7.1</span> <span class="content">Extension Identifiers</span></a>
      <li><a href="#extension-specification"><span class="secno">7.2</span> <span class="content">Defining extensions</span></a>
      <li><a href="#extension-request-parameters"><span class="secno">7.3</span> <span class="content">Extending request parameters</span></a>
      <li><a href="#extension-client-processing"><span class="secno">7.4</span> <span class="content">Extending client processing</span></a>
      <li><a href="#extension-authenticator-processing"><span class="secno">7.5</span> <span class="content">Extending authenticator processing</span></a>
      <li><a href="#sample-extensions"><span class="secno">7.6</span> <span class="content">Example extension</span></a>
     </ol>
    <li>
     <a href="#extension-predef"><span class="secno">8</span> <span class="content">Pre-defined extensions</span></a>
     <ol class="toc">
      <li><a href="#extension-appid"><span class="secno">8.1</span> <span class="content">FIDO AppId</span></a>
      <li><a href="#extension-txauth"><span class="secno">8.2</span> <span class="content">Transaction authorization</span></a>
      <li><a href="#extension-authenticator-selection"><span class="secno">8.3</span> <span class="content">Authenticator Selection Extension</span></a>
      <li><a href="#supported-extensions-extension"><span class="secno">8.4</span> <span class="content">SupportedExtensions Extension</span></a>
      <li><a href="#uvi-extension"><span class="secno">8.5</span> <span class="content">User Verification Index (UVI) Extension</span></a>
      <li><a href="#uvi-location"><span class="secno">8.6</span> <span class="content">Location Extension</span></a>
      <li><a href="#uvm-extension"><span class="secno">8.7</span> <span class="content">User Verification Mode (UVM) Extension</span></a>
     </ol>
    <li><a href="#iana-considerations"><span class="secno">9</span> <span class="content">IANA Considerations</span></a>
    <li>
     <a href="#sample-scenarios"><span class="secno">10</span> <span class="content">Sample scenarios</span></a>
     <ol class="toc">
      <li><a href="#sample-registration"><span class="secno">10.1</span> <span class="content">Registration</span></a>
      <li><a href="#sample-authentication"><span class="secno">10.2</span> <span class="content">Authentication</span></a>
      <li><a href="#sample-decommissioning"><span class="secno">10.3</span> <span class="content">Decommissioning</span></a>
     </ol>
    <li><a href="#acknowledgements"><span class="secno">11</span> <span class="content">Acknowledgements</span></a>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
   <p><em>This section is not normative.</em></p>
   <p>This specification defines an API enabling the creation and use of strong, attested, cryptographic <em><a data-link-type="dfn" href="#scoped-credential" id="ref-for-scoped-credential-1">scoped
credentials</a></em> by web applications, for the purpose of strongly authenticating users. A <a data-link-type="dfn" href="#scoped-credential" id="ref-for-scoped-credential-2">scoped credential</a> is
created and stored by an <em><a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-1">authenticator</a></em> at the behest of a <em><a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-1">Relying Party</a></em>, subject to <em><a data-link-type="dfn" href="#user-consent" id="ref-for-user-consent-1">user
consent</a></em>. Subsequently, the scoped credential can only be accessed by origins belonging to that Relying Party.
This scoping is enforced jointly by <em><a data-link-type="dfn" href="#conforming-user-agent" id="ref-for-conforming-user-agent-1">conforming User Agents</a></em> and <em><a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-2">authenticators</a></em>.
Additionally, privacy across <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-2">Relying Parties</a> is maintained; Relying Parties are not able to detect any properties, or even
the existence, of credentials scoped to other Relying Parties.</p>
   <p>Relying Parties employ the <a data-link-type="dfn" href="#web-authentication-api" id="ref-for-web-authentication-api-1">Web Authentication API</a> during two distinct, but related, <a data-link-type="dfn" href="#ceremony" id="ref-for-ceremony-1">ceremonies</a> involving a user. The first
is <a data-link-type="dfn" href="#registration" id="ref-for-registration-1">Registration</a>, where a <a data-link-type="dfn" href="#scoped-credential" id="ref-for-scoped-credential-3">scoped credential</a> is created on an <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-3">authenticator</a>, and associated by a <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-3">Relying Party</a> with the present user’s account (the account may already exist or may be created at this time). The second is <a data-link-type="dfn" href="#authentication" id="ref-for-authentication-1">Authentication</a>, where the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-4">Relying Party</a> is presented with an <em><a data-link-type="dfn" href="#authentication-assertion" id="ref-for-authentication-assertion-1">Authentication Assertion</a></em> proving the presence
and consent of the user who registered the <a data-link-type="dfn" href="#scoped-credential" id="ref-for-scoped-credential-4">scoped credential</a>. Functionally, the <a data-link-type="dfn" href="#web-authentication-api" id="ref-for-web-authentication-api-2">Web Authentication API</a> comprises
two methods (along with associated data structures): <a data-link-type="functionish" href="#dom-webauthentication-makecredential" id="ref-for-dom-webauthentication-makecredential-1">makeCredential()</a> and <a data-link-type="functionish" href="#dom-webauthentication-getassertion" id="ref-for-dom-webauthentication-getassertion-1">getAssertion()</a>. The former is used
during <a data-link-type="dfn" href="#registration" id="ref-for-registration-2">Registration</a> and the latter during <a data-link-type="dfn" href="#authentication" id="ref-for-authentication-2">Authentication</a>.</p>
   <p>Broadly, compliant <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-4">authenticators</a> protect <a data-link-type="dfn" href="#scoped-credential" id="ref-for-scoped-credential-5">scoped credentials</a>, and
interact with user agents to implement the <a data-link-type="dfn" href="#web-authentication-api" id="ref-for-web-authentication-api-3">Web Authentication API</a>. Some
authenticators may run on the same computing device (e.g., smart phone, tablet,
desktop PC) as the user agent is running on. For instance, such an authenticator
might consist of a Trusted Execution Environment (TEE) applet, a Trusted
Platform Module (TPM), or a Secure Element (SE) integrated into the computing
device in conjunction with some means for <a data-link-type="dfn" href="#user-verification" id="ref-for-user-verification-1">user verification</a>, along with
appropriate platform software to mediate access to these components'
functionality. Other authenticators may operate autonomously from the computing
device running the user agent, and be accessed over a transport such as
Universal Serial Bus (USB), Bluetooth Low Energy (BLE) or Near Field
Communications (NFC).</p>
   <h3 class="heading settled" data-level="1.1" id="use-cases"><span class="secno">1.1. </span><span class="content">Use Cases</span><a class="self-link" href="#use-cases"></a></h3>
   <p>The below use case scenarios illustrate use of two very different types of <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-5">authenticators</a>, as well as outline further
scenarios. Additional scenarios, including sample code, are given later in <a href="#sample-scenarios">§10 Sample scenarios</a>.</p>
   <h4 class="heading settled" data-level="1.1.1" id="usecase-registration"><span class="secno">1.1.1. </span><span class="content">Registration</span><a class="self-link" href="#usecase-registration"></a></h4>
   <ul>
    <li data-md="">
     <p>On a phone:</p>
     <ul>
      <li data-md="">
       <p>User navigates to example.com in a browser and signs in to an existing account using whatever method they have been using
(possibly a legacy method such as a password), or creates a new account.</p>
      <li data-md="">
       <p>The phone prompts, "Do you want to register this device with example.com?"</p>
      <li data-md="">
       <p>User agrees.</p>
      <li data-md="">
       <p>The phone prompts the user for a previously configured <a data-link-type="dfn" href="#authorization-gesture" id="ref-for-authorization-gesture-1">authorization gesture</a> (PIN, biometric, etc.); the user
provides this.</p>
      <li data-md="">
       <p>Website shows message, "Registration complete."</p>
     </ul>
   </ul>
   <h4 class="heading settled" data-level="1.1.2" id="usecase-authentication"><span class="secno">1.1.2. </span><span class="content">Authentication</span><a class="self-link" href="#usecase-authentication"></a></h4>
   <ul>
    <li data-md="">
     <p>On a laptop or desktop:</p>
     <ul>
      <li data-md="">
       <p>User navigates to example.com in a browser, sees an option to "Sign in with your phone."</p>
      <li data-md="">
       <p>User chooses this option and gets a message from the browser, "Please complete this action on your phone."</p>
     </ul>
    <li data-md="">
     <p>Next, on their phone:</p>
     <ul>
      <li data-md="">
       <p>User sees a discrete prompt or notification, "Sign in to example.com."</p>
      <li data-md="">
       <p>User selects this prompt / notification.</p>
      <li data-md="">
       <p>User is shown a list of their example.com identities, e.g., "Sign in as Alice / Sign in as Bob."</p>
      <li data-md="">
       <p>User picks an identity, is prompted for an <a data-link-type="dfn" href="#authorization-gesture" id="ref-for-authorization-gesture-2">authorization gesture</a> (PIN, biometric, etc.) and provides this.</p>
     </ul>
    <li data-md="">
     <p>Now, back on the laptop:</p>
     <ul>
      <li data-md="">
       <p>Web page shows that the selected user is signed-in, and navigates to the signed-in page.</p>
     </ul>
   </ul>
   <h4 class="heading settled" data-level="1.1.3" id="other-configurations"><span class="secno">1.1.3. </span><span class="content">Other use cases and configurations</span><a class="self-link" href="#other-configurations"></a></h4>
   <p>A variety of additional use cases and configurations are also possible, including (but not limited to):</p>
   <ul>
    <li data-md="">
     <p>A user navigates to example.com on their laptop, is guided through a flow to create and register a credential on their phone.</p>
    <li data-md="">
     <p>A user obtains an discrete, <a data-link-type="dfn" href="#attachment-roaming-authenticators" id="ref-for-attachment-roaming-authenticators-1">roaming authenticator</a>, such as a "fob" with USB or USB+NFC/BLE connectivity options, loads
example.com in their browser on a laptop or phone, and is guided though a flow to create and register a credential on the
fob.</p>
    <li data-md="">
     <p>A Relying Party prompts the user for their <a data-link-type="dfn" href="#authorization-gesture" id="ref-for-authorization-gesture-3">authorization gesture</a> in order to authorize a single transaction, such as a payment
or other financial transaction.</p>
   </ul>
   <h2 class="heading settled" data-level="2" id="conformance"><span class="secno">2. </span><span class="content">Conformance</span><a class="self-link" href="#conformance"></a></h2>
   <p>This specification defines criteria for a <a data-link-type="dfn" href="#conforming-user-agent" id="ref-for-conforming-user-agent-2">Conforming User Agent</a>: A User Agent MUST behave as described in this
specification in order to be considered conformant. <a data-link-type="dfn" href="#conforming-user-agent" id="ref-for-conforming-user-agent-3">Conforming User Agents</a> MAY implement algorithms given in this
specification in any way desired, so long as the end result is indistinguishable from the result that would be obtained by the
specification’s algorithms. A conforming User Agent MUST also be a conforming implementation of the IDL fragments of this
specification, as described in the “Web IDL” specification. <a data-link-type="biblio" href="#biblio-webidl-1">[WebIDL-1]</a></p>
   <p>This specification also defines a model of a conformant <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-6">authenticator</a> (see <a href="#authenticator-model">§5 WebAuthn Authenticator model</a>). This is a set of
functional and security requirements for an authenticator to be usable by a <a data-link-type="dfn" href="#conforming-user-agent" id="ref-for-conforming-user-agent-4">Conforming User Agent</a>. As described in <a href="#use-cases">§1.1 Use Cases</a>, an authenticator may be implemented in the operating system underlying the User Agent, or in external hardware,
or a combination of both.</p>
   <h3 class="heading settled" data-level="2.1" id="dependencies"><span class="secno">2.1. </span><span class="content">Dependencies</span><a class="self-link" href="#dependencies"></a></h3>
   <p>This specification relies on several other underlying specifications.</p>
   <dl>
    <dt data-md="">
     <p>HTML</p>
    <dd data-md="">
     <p>The concepts of <a data-link-type="dfn" href="https://www.w3.org/TR/html51/webappapis.html#current-settings-object">current settings object</a>, <a data-link-type="dfn" href="https://www.w3.org/TR/html51/browsers.html#concept-cross-origin">origin</a>, <a data-link-type="dfn" href="https://www.w3.org/TR/html51/browsers.html#opaque-origin">opaque origin</a>, <a data-link-type="dfn" href="https://www.w3.org/TR/html51/browsers.html#relaxing-the-same-origin-restriction">relaxing the same-origin restriction</a>, and the <a data-link-type="dfn" href="https://www.w3.org/TR/html51/webappapis.html#the-navigator-object">Navigator</a> interface are
defined in <a data-link-type="biblio" href="#biblio-html51">[HTML51]</a>.</p>
    <dt data-md="">
     <p>Web IDL</p>
    <dd data-md="">
     <p>Many of the interface definitions and all of the IDL in this specification depend on <a data-link-type="biblio" href="#biblio-webidl-1">[WebIDL-1]</a>. This updated version of
the Web IDL standard adds support for <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="promises">Promises</dfn>, which are now the preferred mechanism for asynchronous
interaction in all new web APIs.</p>
    <dt data-md="">
     <p>DOM</p>
    <dd data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="domexception">DOMException</dfn> and the DOMException values used in this specification are defined in <a data-link-type="biblio" href="#biblio-dom4">[DOM4]</a>.</p>
    <dt data-md="">
     <p>Web Cryptography API</p>
    <dd data-md="">
     <p>The <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-algorithmidentifier">AlgorithmIdentifier</dfn> type and the method for <a data-link-type="dfn" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-normalize-an-algorithm">normalizing an algorithm</a> are defined in <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#algorithm-dictionary">Web Cryptography API §algorithm-dictionary</a>.</p>
    <dt data-md="">
     <p>Base64url encoding</p>
    <dd data-md="">
     <p>The term <dfn data-dfn-type="dfn" data-noexport="" id="base64url-encoding">Base64url Encoding<a class="self-link" href="#base64url-encoding"></a></dfn> refers to the base64 encoding using the URL- and filename-safe character set defined
in Section 5 of <a data-link-type="biblio" href="#biblio-rfc4648">[RFC4648]</a>, with all trailing '=' characters omitted (as permitted by Section 3.2) and without the
inclusion of any line breaks, whitespace, or other additional characters. This is the same encoding as used by JSON Web
Signature (JWS) <a data-link-type="biblio" href="#biblio-rfc7515">[RFC7515]</a>.</p>
   </dl>
   <p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED",  "MAY", and
"OPTIONAL" in this document are to be interpreted as described in <a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a>.</p>
   <h2 class="heading settled" data-level="3" id="terminology"><span class="secno">3. </span><span class="content">Terminology</span><a class="self-link" href="#terminology"></a></h2>
   <dl>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="ascii-case-insensitive-match">ASCII case-insensitive match</dfn></p>
    <dd data-md="">
     <p>A method of testing two strings for equality by comparing them exactly, code point for code point, except that the codepoints
in the range U+0041 .. U+005A (i.e. LATIN CAPITAL LETTER A to LATIN CAPITAL LETTER Z) and the corresponding codepoints in
the range U+0061 .. U+007A (i.e. LATIN SMALL LETTER A to LATIN SMALL LETTER Z) are also considered to match.</p>
    <dt data-md="">
     <p><dfn data-dfn-type="dfn" data-noexport="" id="assertion">Assertion<a class="self-link" href="#assertion"></a></dfn></p>
    <dd data-md="">
     <p>See <a data-link-type="dfn" href="#authentication-assertion" id="ref-for-authentication-assertion-2">Authentication Assertion</a>.</p>
    <dt data-md="">
     <p><dfn data-dfn-type="dfn" data-noexport="" id="attestation">Attestation<a class="self-link" href="#attestation"></a></dfn></p>
    <dd data-md="">
     <p>Generally, a statement that serves to bear witness, confirm, or authenticate.
In the WebAuthn context, attestation is employed to attest to the provenance of an authenticator and the data it emits;
including, for example: credential IDs, credential key pairs, signature counters, etc. <dfn data-dfn-type="dfn" data-noexport="" id="attestation-information">Attestation information<a class="self-link" href="#attestation-information"></a></dfn> is 
conveyed in <a data-link-type="dfn" href="#authenticationattestation-attestation-statement" id="ref-for-authenticationattestation-attestation-statement-1">attestation statements</a>. 
See also <a data-link-type="dfn" href="#attestation-format" id="ref-for-attestation-format-1">attestation format</a>, and <a data-link-type="dfn" href="#attestation-type" id="ref-for-attestation-type-1">attestation type</a>.</p>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="attestation-certificate">Attestation Certificate</dfn></p>
    <dd data-md="">
     <p>A X.509 Certificate for the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="attestation-key-pair">attestation key pair</dfn> used by an <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-7">Authenticator</a> to attest to its manufacture
and capabilities. At <a data-link-type="dfn" href="#registration" id="ref-for-registration-3">registration</a> time, the <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-8">authenticator</a> uses the <dfn data-dfn-type="dfn" data-noexport="" id="attestation-private-key">attestation private key<a class="self-link" href="#attestation-private-key"></a></dfn> to sign
the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-5">Relying Party</a>-specific <a data-link-type="dfn" href="#credential-public-key" id="ref-for-credential-public-key-1">credential public key</a> (and additional data) that it generates and returns via the <a data-link-type="dfn" href="#authenticatormakecredential" id="ref-for-authenticatormakecredential-1">authenticatorMakeCredential</a> operation. Relying Parties use the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="attestation-public-key">attestation public key</dfn> conveyed in the <a data-link-type="dfn" href="#attestation-certificate" id="ref-for-attestation-certificate-1">attestation
certificate</a> to verify the attestation signature. Note that in the case of <a data-link-type="dfn" href="#self-attestation" id="ref-for-self-attestation-1">self attestation</a>, the <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-9">authenticator</a> has no distinct <a data-link-type="dfn" href="#attestation-key-pair" id="ref-for-attestation-key-pair-1">attestation key pair</a> nor <a data-link-type="dfn" href="#attestation-certificate" id="ref-for-attestation-certificate-2">attestation certificate</a>, see <a data-link-type="dfn" href="#self-attestation" id="ref-for-self-attestation-2">self
attestation</a> for details.</p>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="authentication">Authentication</dfn></p>
    <dd data-md="">
     <p>The <a data-link-type="dfn" href="#ceremony" id="ref-for-ceremony-2">ceremony</a> where a user, and the user’s computing device(s) (containing at least one <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-10">authenticator</a>) work in
concert to cryptographically prove to an <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-6">Relying Party</a> that the user controls the private key associated with a
previously-registered <a data-link-type="dfn" href="#scoped-credential" id="ref-for-scoped-credential-6">scoped credential</a> (see <a data-link-type="dfn" href="#registration" id="ref-for-registration-4">Registration</a>). Note that this includes employing <a data-link-type="dfn" href="#user-verification" id="ref-for-user-verification-2">user
verification</a>.</p>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="authenticator">Authenticator</dfn></p>
    <dd data-md="">
     <p>A cryptographic device used by a <a data-link-type="dfn" href="#webauthn-client" id="ref-for-webauthn-client-1">WebAuthn Client</a> to (i) generate a <a data-link-type="dfn" href="#scoped-credential" id="ref-for-scoped-credential-7">scoped credential</a> and register it with a <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-7">Relying Party</a>,
and (ii) subsequently used to cryptographically sign and return, in the form of an <a data-link-type="dfn" href="#authentication-assertion" id="ref-for-authentication-assertion-3">Authentication Assertion</a>, a challenge
and other data presented by a <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-8">Relying Party</a> (in concert with the <a data-link-type="dfn" href="#webauthn-client" id="ref-for-webauthn-client-2">WebAuthn Client</a>) in order to effect authentication.</p>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="authorization-gesture">Authorization Gesture</dfn></p>
    <dd data-md="">
     <p>Essentially the same as <a data-link-type="dfn" href="#user-verification" id="ref-for-user-verification-3">user verification</a>.</p>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="ceremony">Ceremony</dfn></p>
    <dd data-md="">
     <p>The concept of a ceremony <a data-link-type="biblio" href="#biblio-ceremony">[Ceremony]</a> is an extension of the concept of a network protocol, with human nodes alongside
computer nodes and with communication links that include UI, human-to-human communication and transfers of physical objects
that carry data. What is out-of-band to a protocol is in-band to a ceremony. In this specification, <a data-link-type="dfn" href="#registration" id="ref-for-registration-5">Registration</a>, <a data-link-type="dfn" href="#authentication" id="ref-for-authentication-3">Authentication</a>, and <a data-link-type="dfn" href="#user-verification" id="ref-for-user-verification-4">user verification</a> are ceremonies.</p>
    <dt data-md="">
     <p><dfn data-dfn-type="dfn" data-noexport="" id="client">Client<a class="self-link" href="#client"></a></dfn></p>
    <dd data-md="">
     <p>See <a data-link-type="dfn" href="#conforming-user-agent" id="ref-for-conforming-user-agent-5">Conforming User Agent</a>.</p>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="conforming-user-agent">Conforming User Agent</dfn></p>
    <dd data-md="">
     <p>A user agent implementing, in conjunction with the underlying platform, the <a data-link-type="dfn" href="#web-authentication-api" id="ref-for-web-authentication-api-4">Web Authentication API</a> and algorithms
given in this specification, and handling communication between <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-11">Authenticators</a> and <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-9">Relying Parties</a>.</p>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="credential-public-key">Credential Public Key</dfn></p>
    <dd data-md="">
     <p>The public key portion of an <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-10">Relying Party</a>-specific <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="credential-key-pair">credential key pair</dfn>, generated by an <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-12">authenticator</a> and
returned to an Relying Party at <a data-link-type="dfn" href="#registration" id="ref-for-registration-6">registration</a> time (see also <a data-link-type="dfn" href="#scoped-credential" id="ref-for-scoped-credential-8">scoped credential</a>). The private key portion of the <a data-link-type="dfn" href="#credential-key-pair" id="ref-for-credential-key-pair-1">credential key pair</a> is known as the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="credential-private-key">credential private key</dfn>. Note that in the case of <a data-link-type="dfn" href="#self-attestation" id="ref-for-self-attestation-3">self
attestation</a>, the <a data-link-type="dfn" href="#credential-key-pair" id="ref-for-credential-key-pair-2">credential key pair</a> is also used as the <a data-link-type="dfn" href="#attestation-key-pair" id="ref-for-attestation-key-pair-2">attestation key pair</a>, see <a data-link-type="dfn" href="#self-attestation" id="ref-for-self-attestation-4">self attestation</a> for details.</p>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="registration">Registration</dfn></p>
    <dd data-md="">
     <p>The <a data-link-type="dfn" href="#ceremony" id="ref-for-ceremony-3">ceremony</a> where a user, a <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-11">Relying Party</a>, and the user’s computing device(s) (containing at least one <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-13">authenticator</a>) work in concert to create a <a data-link-type="dfn" href="#scoped-credential" id="ref-for-scoped-credential-9">scoped credential</a> and associate it with the user’s <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-12">Relying Party</a> account. Note that this includes employing <a data-link-type="dfn" href="#user-verification" id="ref-for-user-verification-5">user verification</a>.</p>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="relying-party">Relying Party</dfn></p>
    <dd data-md="">
     <p>The entity whose web application utilizes the <a data-link-type="dfn" href="#web-authentication-api" id="ref-for-web-authentication-api-5">Web Authentication API</a> to register and authenticate users. See <a data-link-type="dfn" href="#registration" id="ref-for-registration-7">Registration</a> and <a data-link-type="dfn" href="#authentication" id="ref-for-authentication-4">Authentication</a>, respectively.</p>
     <p class="note" role="note">Note: While the term Relying Party is used in other contexts (e.g., X.509 and OAuth), an entity acting as a Relying Party in one context is
    not necessarily a Relying Party in other contexts.</p>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="relying-party-identifier">Relying Party Identifier</dfn></p>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="rp-id">RP ID</dfn></p>
    <dd data-md="">
     <p>An identifier for the Relying Party on whose behalf a given registration or authentication ceremony is being performed. Scoped
credentials can only be used for authentication by the same entity (as identified by RP ID) that created and registered
them. By default, the RP ID for a WebAuthn operation is set to the <a data-link-type="dfn" href="https://www.w3.org/TR/html51/webappapis.html#current-settings-object">current settings object</a>’s <a data-link-type="dfn" href="https://www.w3.org/TR/html51/browsers.html#concept-cross-origin">origin</a>. This default can be overridden by the caller subject to certain restrictions, as specified in <a href="#makeCredential">§4.1.1 Create a new credential (makeCredential() method)</a> and <a href="#getAssertion">§4.1.2 Use an existing credential (getAssertion() method)</a>.</p>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="scoped-credential">Scoped Credential</dfn></p>
    <dd data-md="">
     <p>Generically, a credential is data one entity presents to another in order to authenticate the former’s identity <a data-link-type="biblio" href="#biblio-rfc4949">[RFC4949]</a>.
A WebAuthn <em><a data-link-type="dfn" href="#scoped-credential" id="ref-for-scoped-credential-10">scoped credential</a></em> is a <code>{ identifier, type }</code> pair identifying authentication
information established by the authenticator and the Relying Party, together, at <a data-link-type="dfn" href="#registration" id="ref-for-registration-8">registration</a> time. The authentication
information consists of an asymmetric key pair, where the public key portion is returned to the Relying Party, which stores it in
conjunction with the present user’s account. The authenticator maps the private key to the Relying Party’s <a data-link-type="dfn" href="#rp-id" id="ref-for-rp-id-1">RP ID</a> and stores
it. Subsequently, only that Relying Party, as identified by its <a data-link-type="dfn" href="#rp-id" id="ref-for-rp-id-2">RP ID</a>, is able to employ the <a data-link-type="dfn" href="#scoped-credential" id="ref-for-scoped-credential-11">scoped credential</a> in <a data-link-type="dfn" href="#authentication" id="ref-for-authentication-5">authentication</a> ceremonies, via the <a data-link-type="functionish" href="#dom-webauthentication-getassertion" id="ref-for-dom-webauthentication-getassertion-2">getAssertion()</a> method. The Relying Party uses its copy of the stored public key to
verify the resultant <a data-link-type="dfn" href="#authentication-assertion" id="ref-for-authentication-assertion-4">Authentication Assertion</a>.</p>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="user-consent">User Consent</dfn></p>
    <dd data-md="">
     <p>User consent means the user agrees with what they are being asked, i.e., it encompasses reading and understanding prompts. <a data-link-type="dfn" href="#user-verification" id="ref-for-user-verification-6">User verification</a> encompasses the means employed by the user to indicate consent.</p>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="user-verification">User Verification</dfn></p>
    <dd data-md="">
     <p>The process by which an <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-14">authenticator</a> <em>locally authorizes</em> the invocation of the <a data-link-type="dfn" href="#authenticatormakecredential" id="ref-for-authenticatormakecredential-2">authenticatorMakeCredential</a> and <a data-link-type="dfn" href="#authenticatorgetassertion" id="ref-for-authenticatorgetassertion-1">authenticatorGetAssertion</a> operations, for example through a touch plus pin
code, a password, a gesture (e.g., presenting a fingerprint), or other modality. Note that invocation of said operations
implies use of key material managed by the authenticator.</p>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="authentication-assertion">Authentication Assertion</dfn></p>
    <dd data-md="">
     <p>The cryptographically signed <code class="idl"><a data-link-type="idl" href="#authenticationassertion" id="ref-for-authenticationassertion-1">AuthenticationAssertion</a></code> object returned by an <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-15">authenticator</a> as the result of an <a data-link-type="dfn" href="#authenticatorgetassertion" id="ref-for-authenticatorgetassertion-2">authenticatorGetAssertion</a> operation.</p>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="webauthn-client">WebAuthn Client</dfn></p>
    <dd data-md="">
     <p>See <a data-link-type="dfn" href="#conforming-user-agent" id="ref-for-conforming-user-agent-6">Conforming User Agent</a>.</p>
   </dl>
   <h2 class="heading settled" data-level="4" id="api"><span class="secno">4. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="web-authentication-api">Web Authentication API</dfn></span><a class="self-link" href="#api"></a></h2>
   <p>This section normatively specifies the API for creating and using scoped credentials. Support for deleting credentials is
deliberately omitted; this is expected to be done through platform-specific user interfaces rather than from a script. The basic
idea is that the credentials belong to the user and are managed by an authenticator, with which the Relying Party interacts through the
client (consisting of the browser and underlying OS platform). Scripts can (with the user’s consent) request the browser to
create a new credential for future use by the Relying Party. Scripts can also request the user’s permission to perform authentication
operations with an existing credential. All such operations are performed in the authenticator and are mediated by the browser
and/or platform on the user’s behalf. At no point does the script get access to the credentials themselves; it only gets
information about the credentials in the form of objects.</p>
   <p>The security properties of this API are provided by the client and the authenticator working together. The authenticator, which
holds and manages credentials, ensures that all operations are scoped to a particular origin, and cannot be replayed against
a different origin, by incorporating the origin in its responses. Specifically, as defined in <a href="#signature-format">§5.2 Signature Format</a>, the full
origin of the requester is included, and signed over, in the attestation statement produced when a new credential is created as
well as in all assertions produced by WebAuthn credentials.</p>
   <p>Additionally, to maintain user privacy and prevent malicious Relying Parties from probing for the presence of credentials belonging to
other Relying Parties, each credential is also associated with a Relying Party Identifier, or RP ID. This RP ID is provided by the client
to the authenticator for all operations, and the authenticator ensures that credentials created by a Relying Party can only be used in
operations requested by the same RP ID. Separating the origin from the RP ID in this way allows the API to be used in cases
where a single Relying Party maintains multiple origins.</p>
   <p>The client facilitates these security measures by providing correct origins and RP IDs to the authenticator for each
operation. Since this is an integral part of the WebAuthn security model, user agents MUST only expose this API to callers in <dfn data-dfn-type="dfn" data-noexport="" id="secure-contexts">secure contexts<a class="self-link" href="#secure-contexts"></a></dfn>, as defined in <a data-link-type="biblio" href="#biblio-secure-contexts">[secure-contexts]</a>.</p>
   <p>The Web Authentication API is defined by the union of the Web IDL fragments presented in the following sections. A combined IDL listing is given in the <a href="#idl-index">IDL Index</a>. The API is defined as a part of the <a data-link-type="dfn" href="https://www.w3.org/TR/html51/webappapis.html#the-navigator-object">Navigator</a> interface:</p>
<pre class="idl highlight def"><span class="kt">partial</span> <span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/webappapis.html#navigator">Navigator</a> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#webauthentication" id="ref-for-webauthentication-1">WebAuthentication</a> <dfn class="nv idl-code" data-dfn-for="Navigator" data-dfn-type="attribute" data-export="" data-readonly="" data-type="WebAuthentication" id="dom-navigator-authentication">authentication<a class="self-link" href="#dom-navigator-authentication"></a></dfn>;
};
</pre>
   <h3 class="heading settled" data-level="4.1" id="iface-credential"><span class="secno">4.1. </span><span class="content"><dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="webauthentication">WebAuthentication</dfn> Interface</span><a class="self-link" href="#iface-credential"></a></h3>
<pre class="idl highlight def">[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext">SecureContext</a>]
<span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="#webauthentication" id="ref-for-webauthentication-2">WebAuthentication</a> {
    <span class="kt">Promise</span> &lt; <a class="n" data-link-type="idl-name" href="#scopedcredentialinfo" id="ref-for-scopedcredentialinfo-1">ScopedCredentialInfo</a> > <a class="nv idl-code" data-link-type="method" href="#dom-webauthentication-makecredential" id="ref-for-dom-webauthentication-makecredential-2">makeCredential</a> (
        <a class="n" data-link-type="idl-name" href="#dictdef-account" id="ref-for-dictdef-account-1">Account</a>                                 <dfn class="nv dfn-paneled idl-code" data-dfn-for="WebAuthentication/makeCredential(accountInformation, cryptoParameters, attestationChallenge, options), WebAuthentication/makeCredential(accountInformation, cryptoParameters, attestationChallenge)" data-dfn-type="argument" data-export="" id="dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-accountinformation">accountInformation</dfn>,
        <span class="kt">sequence</span> &lt; <a class="n" data-link-type="idl-name" href="#dictdef-scopedcredentialparameters" id="ref-for-dictdef-scopedcredentialparameters-1">ScopedCredentialParameters</a> > <dfn class="nv dfn-paneled idl-code" data-dfn-for="WebAuthentication/makeCredential(accountInformation, cryptoParameters, attestationChallenge, options), WebAuthentication/makeCredential(accountInformation, cryptoParameters, attestationChallenge)" data-dfn-type="argument" data-export="" id="dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-cryptoparameters">cryptoParameters</dfn>,
        <a class="n" data-link-type="idl-name" href="https://heycam.github.io/webidl/#BufferSource">BufferSource</a>                            <dfn class="nv dfn-paneled idl-code" data-dfn-for="WebAuthentication/makeCredential(accountInformation, cryptoParameters, attestationChallenge, options), WebAuthentication/makeCredential(accountInformation, cryptoParameters, attestationChallenge)" data-dfn-type="argument" data-export="" id="dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-attestationchallenge">attestationChallenge</dfn>,
        <span class="kt">optional</span> <a class="n" data-link-type="idl-name" href="#dictdef-scopedcredentialoptions" id="ref-for-dictdef-scopedcredentialoptions-1">ScopedCredentialOptions</a>        <dfn class="nv dfn-paneled idl-code" data-dfn-for="WebAuthentication/makeCredential(accountInformation, cryptoParameters, attestationChallenge, options), WebAuthentication/makeCredential(accountInformation, cryptoParameters, attestationChallenge)" data-dfn-type="argument" data-export="" id="dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options">options</dfn>
    );

    <span class="kt">Promise</span> &lt; <a class="n" data-link-type="idl-name" href="#authenticationassertion" id="ref-for-authenticationassertion-2">AuthenticationAssertion</a> > <a class="nv idl-code" data-link-type="method" href="#dom-webauthentication-getassertion" id="ref-for-dom-webauthentication-getassertion-3">getAssertion</a> (
        <a class="n" data-link-type="idl-name" href="https://heycam.github.io/webidl/#BufferSource">BufferSource</a>                    <dfn class="nv dfn-paneled idl-code" data-dfn-for="WebAuthentication/getAssertion(assertionChallenge, options), WebAuthentication/getAssertion(assertionChallenge)" data-dfn-type="argument" data-export="" id="dom-webauthentication-getassertion-assertionchallenge-options-assertionchallenge">assertionChallenge</dfn>,
        <span class="kt">optional</span> <a class="n" data-link-type="idl-name" href="#dictdef-assertionoptions" id="ref-for-dictdef-assertionoptions-1">AssertionOptions</a>       <dfn class="nv idl-code" data-dfn-for="WebAuthentication/getAssertion(assertionChallenge, options), WebAuthentication/getAssertion(assertionChallenge)" data-dfn-type="argument" data-export="" id="dom-webauthentication-getassertion-assertionchallenge-options-options">options<a class="self-link" href="#dom-webauthentication-getassertion-assertionchallenge-options-options"></a></dfn>
    );
};
</pre>
   <p>This interface has two methods, which are described in the following subsections.</p>
   <h4 class="heading settled" data-level="4.1.1" id="makeCredential"><span class="secno">4.1.1. </span><span class="content">Create a new credential (<dfn class="dfn-paneled idl-code" data-dfn-for="WebAuthentication" data-dfn-type="method" data-export="" data-lt="makeCredential(accountInformation, cryptoParameters, attestationChallenge, options)|makeCredential(accountInformation, cryptoParameters, attestationChallenge)" id="dom-webauthentication-makecredential">makeCredential()</dfn> method)</span><a class="self-link" href="#makeCredential"></a></h4>
   <p>With this method, a script can request the User Agent to create a new credential of a given type and persist it to the
underlying platform, which may involve data storage managed by the browser or the OS. The user agent will prompt the user to
approve this operation. On success, the promise will be resolved with a <code class="idl"><a data-link-type="idl" href="#scopedcredentialinfo" id="ref-for-scopedcredentialinfo-2">ScopedCredentialInfo</a></code> object describing the newly
created credential.</p>
   <p>This method takes the following parameters:</p>
   <ul>
    <li data-md="">
     <p>The <dfn data-dfn-type="dfn" data-noexport="" id="accountinformation">accountInformation<a class="self-link" href="#accountinformation"></a></dfn> parameter specifies information about the user account for which the credential is being
created. This is meant for later use by the authenticator when it needs to prompt the user to select a credential. An
authenticator is only required to store one credential for any given value of <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-accountinformation" id="ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-accountinformation-1">accountInformation</a></code>. Specifically, if an
authenticator already has a credential for the specified value of <code class="idl"><a data-link-type="idl" href="#dom-account-id" id="ref-for-dom-account-id-1">id</a></code> in <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-accountinformation" id="ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-accountinformation-2">accountInformation</a></code>, and if this
credential is not listed in the <code class="idl"><a data-link-type="idl" href="#dom-scopedcredentialoptions-excludelist" id="ref-for-dom-scopedcredentialoptions-excludelist-1">excludeList</a></code> member of <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options" id="ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options-1">options</a></code>, then after successful
execution of this method:</p>
     <ul>
      <li data-md="">
       <p>Any calls to <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-getassertion" id="ref-for-dom-webauthentication-getassertion-4">getAssertion()</a></code> that do not specify <code class="idl"><a data-link-type="idl" href="#dom-assertionoptions-allowlist" id="ref-for-dom-assertionoptions-allowlist-1">allowList</a></code> will not result in the older
credential being offered to the user.</p>
      <li data-md="">
       <p>Any calls to <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-getassertion" id="ref-for-dom-webauthentication-getassertion-5">getAssertion()</a></code> that specify the older credential in the <code class="idl"><a data-link-type="idl" href="#dom-assertionoptions-allowlist" id="ref-for-dom-assertionoptions-allowlist-2">allowList</a></code> may also not
result in it being offered to the user.</p>
     </ul>
    <li data-md="">
     <p>The <dfn data-dfn-type="dfn" data-noexport="" id="cryptoparameters">cryptoParameters<a class="self-link" href="#cryptoparameters"></a></dfn> parameter supplies information about the desired properties of the credential to be created.
The sequence is ordered from most preferred to least preferred. The platform makes a best effort to create the most
preferred credential that it can.</p>
    <li data-md="">
     <p>The <dfn data-dfn-type="dfn" data-noexport="" id="attestationchallenge">attestationChallenge<a class="self-link" href="#attestationchallenge"></a></dfn> parameter contains a challenge intended to be used for generating the attestation
statement of the newly created credential.</p>
    <li data-md="">
     <p>The optional <dfn data-dfn-for="makeCredential()" data-dfn-type="dfn" data-noexport="" id="makecredential-options">options<a class="self-link" href="#makecredential-options"></a></dfn> parameter specifies additional options, as described in <a href="#credential-options">§4.5 Additional options for Credential Generation (dictionary ScopedCredentialOptions)</a>.</p>
   </ul>
   <p>When this method is invoked, the user agent MUST execute the following algorithm:</p>
   <ol>
    <li data-md="">
     <p>If the <code class="idl"><a data-link-type="idl" href="#dom-scopedcredentialoptions-timeoutseconds" id="ref-for-dom-scopedcredentialoptions-timeoutseconds-1">timeoutSeconds</a></code> member of <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options" id="ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options-2">options</a></code> is <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-present">present</a>, check if its value lies
within a reasonable range as defined by
the platform and if not, correct it to the closest value lying within that range. Set <var>adjustedTimeout</var> to this adjusted
value. If <code class="idl"><a data-link-type="idl" href="#dom-scopedcredentialoptions-timeoutseconds" id="ref-for-dom-scopedcredentialoptions-timeoutseconds-2">timeoutSeconds</a></code> was not specified, then set <var>adjustedTimeout</var> to a platform-specific
default.</p>
    <li data-md="">
     <p>Let <var>promise</var> be a new <a data-link-type="dfn" href="#promises" id="ref-for-promises-1">Promise</a>. Return <var>promise</var> and start a timer for <var>adjustedTimeout</var> seconds.
Then asynchronously continue executing the following steps. If any fatal error is encountered in this process other than the
ones enumerated below, cancel the timer, reject <var>promise</var> with a DOMException whose name is "UnknownError", and terminate
this algorithm.</p>
    <li data-md="">
     <p>Set <var>callerOrigin</var> to the <a data-link-type="dfn" href="https://www.w3.org/TR/html51/webappapis.html#current-settings-object">current settings object</a>’s <a data-link-type="dfn" href="https://www.w3.org/TR/html51/browsers.html#concept-cross-origin">origin</a>. If <var>callerOrigin</var> is
an <a data-link-type="dfn" href="https://www.w3.org/TR/html51/browsers.html#opaque-origin">opaque origin</a>, reject <var>promise</var> with a <a data-link-type="dfn" href="#domexception" id="ref-for-domexception-1">DOMException</a> whose name is "NotAllowedError", and
terminate this algorithm. Otherwise,</p>
     <ul>
      <li data-md="">
       <p>If the <code class="idl"><a data-link-type="idl" href="#dom-scopedcredentialoptions-rpid" id="ref-for-dom-scopedcredentialoptions-rpid-1">rpId</a></code> member of <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options" id="ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options-3">options</a></code> is not <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-present">present</a>, then set <var>rpId</var> to <var>callerOrigin</var>,
and <var>rpIdHash</var> to the SHA-256 hash of <var>rpId</var>.</p>
      <li data-md="">
       <p>If the <code class="idl"><a data-link-type="idl" href="#dom-scopedcredentialoptions-rpid" id="ref-for-dom-scopedcredentialoptions-rpid-2">rpId</a></code> member of <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options" id="ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options-4">options</a></code> is <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-present">present</a>, then invoke the procedure used for <a data-link-type="dfn" href="https://www.w3.org/TR/html51/browsers.html#relaxing-the-same-origin-restriction">relaxing the same-origin
restriction</a> by setting the <code>document.domain</code> attribute, using <code class="idl"><a data-link-type="idl" href="#dom-scopedcredentialoptions-rpid" id="ref-for-dom-scopedcredentialoptions-rpid-3">rpId</a></code> as the given value
but without changing the current document’s <code>domain</code>. If no errors are thrown, set <var>rpId</var> to the value of <code>host</code> as
computed by this procedure, and <var>rpIdHash</var> to the SHA-256 hash of the <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8-encode">UTF-8 encoding</a> of <var>rpId</var>. Otherwise, reject <var>promise</var> with a <a data-link-type="dfn" href="#domexception" id="ref-for-domexception-2">DOMException</a> whose name is "SecurityError", and terminate this algorithm.</p>
     </ul>
    <li data-md="">
     <p>Process each element of <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-cryptoparameters" id="ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-cryptoparameters-1">cryptoParameters</a></code> using the following steps, to produce a new sequence <var>normalizedParameters</var>.</p>
     <ul>
      <li data-md="">
       <p>Let <var>current</var> be the currently selected element of <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-cryptoparameters" id="ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-cryptoparameters-2">cryptoParameters</a></code>.</p>
      <li data-md="">
       <p>If <code>current.type</code> does not contain a <code class="idl"><a data-link-type="idl" href="#enumdef-scopedcredentialtype" id="ref-for-enumdef-scopedcredentialtype-1">ScopedCredentialType</a></code> supported by this implementation, then stop processing <var>current</var> and move on to the next element in <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-cryptoparameters" id="ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-cryptoparameters-3">cryptoParameters</a></code>.</p>
      <li data-md="">
       <p>Let <var>normalizedAlgorithm</var> be the result of <a data-link-type="dfn" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-normalize-an-algorithm">normalizing an algorithm</a> <a data-link-type="biblio" href="#biblio-webcryptoapi">[WebCryptoAPI]</a>,
with <var>alg</var> set to <code>current.algorithm</code> and <var>op</var> set to 'generateKey'. If an error occurs during this
procedure, then stop processing <var>current</var> and move on to the next element in <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-cryptoparameters" id="ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-cryptoparameters-4">cryptoParameters</a></code>.</p>
      <li data-md="">
       <p>Add a new object of type <code class="idl"><a data-link-type="idl" href="#dictdef-scopedcredentialparameters" id="ref-for-dictdef-scopedcredentialparameters-2">ScopedCredentialParameters</a></code> to <var>normalizedParameters</var>, with <var>type</var> set to <code>current.type</code> and <var>algorithm</var> set to <var>normalizedAlgorithm</var>.</p>
     </ul>
    <li data-md="">
     <p>If <var>normalizedAlgorithm</var> is empty and <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-cryptoparameters" id="ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-cryptoparameters-5">cryptoParameters</a></code> was not empty, cancel the timer started in step 2, reject <var>promise</var> with a DOMException whose name is "NotSupportedError", and terminate this algorithm.</p>
    <li data-md="">
     <p>If the <code class="idl"><a data-link-type="idl" href="#dom-scopedcredentialoptions-extensions" id="ref-for-dom-scopedcredentialoptions-extensions-1">extensions</a></code> member of <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options" id="ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options-5">options</a></code> is <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-present">present</a>, process any extensions supported by
this client platform, to produce the extension data that needs to be sent to the authenticator. If an error is encountered
while processing an extension, skip that extension and do not produce any extension data for it. Call the result of this
processing <var>clientExtensions</var>.</p>
    <li data-md="">
     <p>Use <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-attestationchallenge" id="ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-attestationchallenge-1">attestationChallenge</a></code>, <var>callerOrigin</var> and <var>rpId</var>, along with the token binding key associated with <var>callerOrigin</var> (if
any), to create a <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-1">ClientData</a></code> structure representing this request. Choose a hash algorithm for <code class="idl"><a data-link-type="idl" href="#dom-clientdata-hashalg" id="ref-for-dom-clientdata-hashalg-1">hashAlg</a></code> and
compute the <a data-link-type="dfn" href="#clientdatajson" id="ref-for-clientdatajson-1">clientDataJSON</a> and <a data-link-type="dfn" href="#clientdatahash" id="ref-for-clientdatahash-1">clientDataHash</a>.</p>
    <li data-md="">
     <p>Initialize <var>issuedRequests</var> and <var>currentlyAvailableAuthenticators</var> to empty lists.</p>
    <li data-md="">
     <p>For each authenticator currently available on this platform, add the authenticator to <var>currentlyAvailableAuthenticators</var> unless the <code class="idl"><a data-link-type="idl" href="#dom-scopedcredentialoptions-attachment" id="ref-for-dom-scopedcredentialoptions-attachment-1">attachment</a></code> member of <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options" id="ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options-6">options</a></code> is <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-present">present</a>. In that case, let <var>attachment</var> be <code class="idl"><a data-link-type="idl" href="#dom-scopedcredentialoptions-attachment" id="ref-for-dom-scopedcredentialoptions-attachment-2">attachment</a></code>, and add the authenticator to <var>currentlyAvailableAuthenticators</var> if its attachment
modality matches <var>attachment</var>.</p>
    <li data-md="">
     <p>For each authenticator in <var>currentlyAvailableAuthenticators</var>: asynchronously invoke the <a data-link-type="dfn" href="#authenticatormakecredential" id="ref-for-authenticatormakecredential-3">authenticatorMakeCredential</a> operation on that authenticator with <var>rpIdHash</var>, <a data-link-type="dfn" href="#clientdatahash" id="ref-for-clientdatahash-2">clientDataHash</a>, <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-accountinformation" id="ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-accountinformation-3">accountInformation</a></code>, <var>normalizedParameters</var>, <code class="idl"><a data-link-type="idl" href="#dom-scopedcredentialoptions-excludelist" id="ref-for-dom-scopedcredentialoptions-excludelist-2">excludeList</a></code> and <var>clientExtensions</var> as parameters. Add a corresponding entry to <var>issuedRequests</var>.</p>
     <ul>
      <li data-md="">
       <p>For each credential <var>C</var> in the <code class="idl"><a data-link-type="idl" href="#dom-scopedcredentialoptions-excludelist" id="ref-for-dom-scopedcredentialoptions-excludelist-3">excludeList</a></code> member of <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options" id="ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options-7">options</a></code> that has a non-empty <var>transports</var> list, optionally use only the specified transports to test for the existence of <var>C</var>.</p>
     </ul>
    <li data-md="">
     <p>While <var>issuedRequests</var> is not empty, perform the following actions depending upon the <var>adjustedTimeout</var> timer and responses
from the authenticators:</p>
     <ul>
      <li data-md="">
       <p>If the <var>adjustedTimeout</var> timer expires, then for each entry in <var>issuedRequests</var> invoke the <a data-link-type="dfn" href="#authenticatorcancel" id="ref-for-authenticatorcancel-1">authenticatorCancel</a> operation on that authenticator and remove its entry from the list.</p>
      <li data-md="">
       <p>If any authenticator returns a status indicating that the user cancelled the operation, delete that authenticator’s
entry from <var>issuedRequests</var>. For each remaining entry in <var>issuedRequests</var> invoke the <a data-link-type="dfn" href="#authenticatorcancel" id="ref-for-authenticatorcancel-2">authenticatorCancel</a> operation on that authenticator and remove its entry from the list.</p>
      <li data-md="">
       <p>If any authenticator returns an error status, delete the corresponding entry from <var>issuedRequests</var>.</p>
      <li data-md="">
       <p>If any authenticator indicates success:</p>
       <ul>
        <li data-md="">
         <p>Remove this authenticator’s entry from <var>issuedRequests</var>.</p>
        <li data-md="">
         <p>Create a new <code class="idl"><a data-link-type="idl" href="#scopedcredentialinfo" id="ref-for-scopedcredentialinfo-3">ScopedCredentialInfo</a></code> object named <var>value</var> and populate its fields with the values returned from the
authenticator as well as the <a data-link-type="dfn" href="#clientdatajson" id="ref-for-clientdatajson-2">clientDataJSON</a> computed earlier.</p>
        <li data-md="">
         <p>For each remaining entry in <var>issuedRequests</var> invoke the <a data-link-type="dfn" href="#authenticatorcancel" id="ref-for-authenticatorcancel-3">authenticatorCancel</a> operation on that authenticator and
remove its entry from the list.</p>
        <li data-md="">
         <p>Resolve <var>promise</var> with <var>value</var> and terminate this algorithm.</p>
       </ul>
     </ul>
    <li data-md="">
     <p>Reject <var>promise</var> with a <a data-link-type="dfn" href="#domexception" id="ref-for-domexception-3">DOMException</a> whose name is "NotAllowedError", and terminate this algorithm.</p>
   </ol>
   <p>During the above process, the user agent SHOULD show some UI to the user to guide them in the process of selecting and
authorizing an authenticator.</p>
   <h4 class="heading settled" data-level="4.1.2" id="getAssertion"><span class="secno">4.1.2. </span><span class="content">Use an existing credential (<dfn class="dfn-paneled idl-code" data-dfn-for="WebAuthentication" data-dfn-type="method" data-export="" data-lt="getAssertion(assertionChallenge, options)|getAssertion(assertionChallenge)" id="dom-webauthentication-getassertion">getAssertion()</dfn> method)</span><a class="self-link" href="#getAssertion"></a></h4>
   <p>This method is used to discover and use an existing scoped credential, with the user’s consent. The script optionally specifies
some criteria to indicate what credentials are acceptable to it. The user agent and/or platform locates credentials matching the
specified criteria, and guides the user to pick one that the script should be allowed to use. The user may choose not to provide
a credential even if one is present, for example to maintain privacy.</p>
   <p>This method takes the following parameters:</p>
   <ul>
    <li data-md="">
     <p>The <dfn data-dfn-type="dfn" data-noexport="" id="assertionchallenge">assertionChallenge<a class="self-link" href="#assertionchallenge"></a></dfn> parameter contains a challenge that the selected authenticator is expected to sign to
produce the assertion.</p>
    <li data-md="">
     <p>The optional <dfn data-dfn-for="getAssertion()" data-dfn-type="dfn" data-noexport="" id="getassertion-options">options<a class="self-link" href="#getassertion-options"></a></dfn> parameter specifies additional options, as described in <a href="#assertion-options">§4.7 Additional options for Assertion Generation (dictionary AssertionOptions)</a>.</p>
   </ul>
   <p>When this method is invoked, the user agent MUST execute the following algorithm:</p>
   <ol>
    <li data-md="">
     <p>If the <code class="idl"><a data-link-type="idl" href="#dom-assertionoptions-timeoutseconds" id="ref-for-dom-assertionoptions-timeoutseconds-1">timeoutSeconds</a></code> member of <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options" id="ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options-8">options</a></code> is <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-present">present</a>, check if its value lies within a
reasonable range as defined by the platform and if not, correct it to the closest value lying within that range. Set <var>adjustedTimeout</var> to this adjusted value. If <code class="idl"><a data-link-type="idl" href="#dom-assertionoptions-timeoutseconds" id="ref-for-dom-assertionoptions-timeoutseconds-2">timeoutSeconds</a></code> is not <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-present">present</a>, then set <var>adjustedTimeout</var> to a platform-specific default.</p>
    <li data-md="">
     <p>Let <var>promise</var> be a new <a data-link-type="dfn" href="#promises" id="ref-for-promises-2">Promise</a>. Return <var>promise</var> and start a timer for <var>adjustedTimeout</var> seconds.
Then asynchronously continue executing the following steps. If any fatal error is encountered in this process other than the
ones enumerated below, cancel the timer, reject <var>promise</var> with a DOMException whose name is "UnknownError", and terminate
this algorithm.</p>
    <li data-md="">
     <p>Set <var>callerOrigin</var> to the <a data-link-type="dfn" href="https://www.w3.org/TR/html51/webappapis.html#current-settings-object">current settings object</a>’s <a data-link-type="dfn" href="https://www.w3.org/TR/html51/browsers.html#concept-cross-origin">origin</a>. If <var>callerOrigin</var> is
an <a data-link-type="dfn" href="https://www.w3.org/TR/html51/browsers.html#opaque-origin">opaque origin</a>, reject <var>promise</var> with a <a data-link-type="dfn" href="#domexception" id="ref-for-domexception-4">DOMException</a> whose name is "NotAllowedError", and
terminate this algorithm. Otherwise,</p>
     <ul>
      <li data-md="">
       <p>If the <code class="idl"><a data-link-type="idl" href="#dom-assertionoptions-rpid" id="ref-for-dom-assertionoptions-rpid-1">rpId</a></code> member of <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options" id="ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options-9">options</a></code> is not <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-present">present</a>, then set <var>rpId</var> to <var>callerOrigin</var>, and <var>rpIdHash</var> to the SHA-256 hash of the UTF-8 encoding of <var>rpId</var>.</p>
      <li data-md="">
       <p>If the <code class="idl"><a data-link-type="idl" href="#dom-assertionoptions-rpid" id="ref-for-dom-assertionoptions-rpid-2">rpId</a></code> member of <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options" id="ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options-10">options</a></code> is <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-present">present</a>, then invoke the procedure used for <a data-link-type="dfn" href="https://www.w3.org/TR/html51/browsers.html#relaxing-the-same-origin-restriction">relaxing
the same-origin restriction</a> by setting the <code>document.domain</code> attribute, using <code class="idl"><a data-link-type="idl" href="#dom-assertionoptions-rpid" id="ref-for-dom-assertionoptions-rpid-3">rpId</a></code> as the given
value but without changing the current document’s <code>domain</code>. If no errors are thrown, set <var>rpId</var> to the value of <code>host</code> as computed by this procedure, and <var>rpIdHash</var> to the SHA-256 hash of the UTF-8 encoding of <var>rpId</var>. Otherwise, reject <var>promise</var> with a <a data-link-type="dfn" href="#domexception" id="ref-for-domexception-5">DOMException</a> whose name is "SecurityError", and terminate this algorithm.</p>
     </ul>
    <li data-md="">
     <p>If the <code class="idl"><a data-link-type="idl" href="#dom-assertionoptions-extensions" id="ref-for-dom-assertionoptions-extensions-1">extensions</a></code> member of <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options" id="ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options-11">options</a></code> is <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-present">present</a>, process any extensions supported by this
client platform, to produce the extension data that needs to be sent to the authenticator. If an error is encountered while
processing an extension, skip that extension and do not produce any extension data for it. Call the result of this
processing <var>clientExtensions</var>.</p>
    <li data-md="">
     <p>Use <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-getassertion-assertionchallenge-options-assertionchallenge" id="ref-for-dom-webauthentication-getassertion-assertionchallenge-options-assertionchallenge-1">assertionChallenge</a></code>, <var>callerOrigin</var> and <var>rpId</var>, along with the token binding key associated with <var>callerOrigin</var> (if
any), to create a <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-2">ClientData</a></code> structure representing this request. Choose a hash algorithm for <code class="idl"><a data-link-type="idl" href="#dom-clientdata-hashalg" id="ref-for-dom-clientdata-hashalg-2">hashAlg</a></code> and
compute the <a data-link-type="dfn" href="#clientdatajson" id="ref-for-clientdatajson-3">clientDataJSON</a> and <a data-link-type="dfn" href="#clientdatahash" id="ref-for-clientdatahash-3">clientDataHash</a>.</p>
    <li data-md="">
     <p>Initialize <var>issuedRequests</var> to an empty list.</p>
    <li data-md="">
     <p>For each authenticator currently available on this platform, perform the following steps:</p>
     <ul>
      <li data-md="">
       <p>If the <code class="idl"><a data-link-type="idl" href="#dom-assertionoptions-allowlist" id="ref-for-dom-assertionoptions-allowlist-3">allowList</a></code> member of <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options" id="ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options-12">options</a></code> is empty, let <var>credentialList</var> be an empty list. Otherwise,
execute a platform-specific procedure to determine which, if any, credentials listed in <code class="idl"><a data-link-type="idl" href="#dom-assertionoptions-allowlist" id="ref-for-dom-assertionoptions-allowlist-4">allowList</a></code> might be present on this authenticator, and set <var>credentialList</var> to this filtered list. If no such filtering is
possible, set <var>credentialList</var> to an empty list.</p>
      <li data-md="">
       <p>For each credential C within the <var>credentialList</var> that has a non-empty <var>transports</var> list, optionally use only the
specified transports to get assertions using credential C.</p>
      <li data-md="">
       <p>If the above filtering process concludes that none of the credentials on the <code class="idl"><a data-link-type="idl" href="#dom-assertionoptions-allowlist" id="ref-for-dom-assertionoptions-allowlist-5">allowList</a></code> can possibly
be on this authenticator, do not perform any of the following steps for this authenticator, and proceed to the next
authenticator (if any).</p>
      <li data-md="">
       <p>Asynchronously invoke the <a data-link-type="dfn" href="#authenticatorgetassertion" id="ref-for-authenticatorgetassertion-3">authenticatorGetAssertion</a> operation on this authenticator with <var>rpIdHash</var>, <a data-link-type="dfn" href="#clientdatahash" id="ref-for-clientdatahash-4">clientDataHash</a>, <var>credentialList</var>, and <var>clientExtensions</var> as parameters.</p>
      <li data-md="">
       <p>Add an entry to <var>issuedRequests</var>, corresponding to this request.</p>
     </ul>
    <li data-md="">
     <p>While <var>issuedRequests</var> is not empty, perform the following actions depending upon the <var>adjustedTimeout</var> timer and responses
from the authenticators:</p>
     <ul>
      <li data-md="">
       <p>If the timer for <var>adjustedTimeout</var> expires, then for each entry in <var>issuedRequests</var> invoke the <a data-link-type="dfn" href="#authenticatorcancel" id="ref-for-authenticatorcancel-4">authenticatorCancel</a> operation on that authenticator and remove its entry from the list.</p>
      <li data-md="">
       <p>If any authenticator returns a status indicating that the user cancelled the operation, delete that authenticator’s entry
from <var>issuedRequests</var>. For each remaining entry in <var>issuedRequests</var> invoke the <a data-link-type="dfn" href="#authenticatorcancel" id="ref-for-authenticatorcancel-5">authenticatorCancel</a> operation on
that authenticator, and remove its entry from the list.</p>
      <li data-md="">
       <p>If any authenticator returns an error status, delete the corresponding entry from <var>issuedRequests</var>.</p>
      <li data-md="">
       <p>If any authenticator returns success:</p>
       <ul>
        <li data-md="">
         <p>Remove this authenticator’s entry from <var>issuedRequests</var>.</p>
        <li data-md="">
         <p>Create a new <code class="idl"><a data-link-type="idl" href="#authenticationassertion" id="ref-for-authenticationassertion-3">AuthenticationAssertion</a></code> object named <var>value</var> and populate its fields with the values returned from the
authenticator as well as the <a data-link-type="dfn" href="#clientdatajson" id="ref-for-clientdatajson-4">clientDataJSON</a> computed earlier.</p>
        <li data-md="">
         <p>For each remaining entry in <var>issuedRequests</var> invoke the <a data-link-type="dfn" href="#authenticatorcancel" id="ref-for-authenticatorcancel-6">authenticatorCancel</a> operation on that authenticator and
remove its entry from the list.</p>
        <li data-md="">
         <p>Resolve <var>promise</var> with <var>value</var> and terminate this algorithm.</p>
       </ul>
     </ul>
    <li data-md="">
     <p>Reject <var>promise</var> with a <a data-link-type="dfn" href="#domexception" id="ref-for-domexception-6">DOMException</a> whose name is "NotAllowedError", and terminate this algorithm.</p>
   </ol>
   <p>During the above process, the user agent SHOULD show some UI to the user to guide them in the process of selecting and
authorizing an authenticator with which to complete the operation.</p>
   <h3 class="heading settled" data-level="4.2" id="iface-credentialInfo"><span class="secno">4.2. </span><span class="content">Information about Scoped Credential (interface <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="scopedcredentialinfo">ScopedCredentialInfo</dfn>)</span><a class="self-link" href="#iface-credentialInfo"></a></h3>
<pre class="idl highlight def">[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext">SecureContext</a>]
<span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="#scopedcredentialinfo" id="ref-for-scopedcredentialinfo-4">ScopedCredentialInfo</a> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#scopedcredential" id="ref-for-scopedcredential-1">ScopedCredential</a>           <dfn class="nv idl-code" data-dfn-for="ScopedCredentialInfo" data-dfn-type="attribute" data-export="" data-readonly="" data-type="ScopedCredential" id="dom-scopedcredentialinfo-credential">credential<a class="self-link" href="#dom-scopedcredentialinfo-credential"></a></dfn>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#authenticationattestation" id="ref-for-authenticationattestation-1">AuthenticationAttestation</a>  <dfn class="nv idl-code" data-dfn-for="ScopedCredentialInfo" data-dfn-type="attribute" data-export="" data-readonly="" data-type="AuthenticationAttestation" id="dom-scopedcredentialinfo-attestation">attestation<a class="self-link" href="#dom-scopedcredentialinfo-attestation"></a></dfn>;
};
</pre>
   <div>
     This interface represents a newly-created scoped credential. It contains information about the credential that can be used
    to locate it later for use, and also contains metadata that can be used by the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-13">Relying Party</a> to assess the strength of the
    credential during registration. 
    <p>The <dfn data-dfn-for="ScopedCredentialInfo" data-dfn-type="dfn" data-noexport="" id="scopedcredentialinfo-credential">credential<a class="self-link" href="#scopedcredentialinfo-credential"></a></dfn> attribute contains an object whose attributes state the type of, and identifier for, the
    credential represented by <code class="idl"><a data-link-type="idl" href="#scopedcredentialinfo" id="ref-for-scopedcredentialinfo-5">ScopedCredentialInfo</a></code>.</p>
    <p>The <dfn data-dfn-for="ScopedCredentialInfo" data-dfn-type="dfn" data-noexport="" id="scopedcredentialinfo-attestation">attestation<a class="self-link" href="#scopedcredentialinfo-attestation"></a></dfn> attribute contains an attestation statement returned by the authenticator. This provides
    information about the credential and the authenticator it is held in, such as the <a data-link-type="dfn" href="#credential-public-key" id="ref-for-credential-public-key-2">credential public key</a> and the level
    of security assurance provided by the authenticator.</p>
   </div>
   <h3 class="heading settled" data-level="4.3" id="iface-account"><span class="secno">4.3. </span><span class="content">User Account Information (dictionary <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-account">Account</dfn>)</span><a class="self-link" href="#iface-account"></a></h3>
<pre class="idl highlight def"><span class="kt">dictionary</span> <a class="nv idl-code" data-link-type="dictionary" href="#dictdef-account" id="ref-for-dictdef-account-2">Account</a> {
    <span class="kt">required</span> <span class="kt">DOMString</span> <dfn class="nv idl-code" data-dfn-for="Account" data-dfn-type="dict-member" data-export="" data-type="DOMString " id="dom-account-rpdisplayname">rpDisplayName<a class="self-link" href="#dom-account-rpdisplayname"></a></dfn>;
    <span class="kt">required</span> <span class="kt">DOMString</span> <dfn class="nv idl-code" data-dfn-for="Account" data-dfn-type="dict-member" data-export="" data-type="DOMString " id="dom-account-displayname">displayName<a class="self-link" href="#dom-account-displayname"></a></dfn>;
    <span class="kt">required</span> <span class="kt">DOMString</span> <dfn class="nv dfn-paneled idl-code" data-dfn-for="Account" data-dfn-type="dict-member" data-export="" data-type="DOMString " id="dom-account-id">id</dfn>;
    <span class="kt">DOMString</span>          <dfn class="nv idl-code" data-dfn-for="Account" data-dfn-type="dict-member" data-export="" data-type="DOMString          " id="dom-account-name">name<a class="self-link" href="#dom-account-name"></a></dfn>;
    <span class="kt">DOMString</span>          <dfn class="nv idl-code" data-dfn-for="Account" data-dfn-type="dict-member" data-export="" data-type="DOMString          " id="dom-account-imageurl">imageURL<a class="self-link" href="#dom-account-imageurl"></a></dfn>;
};
</pre>
   <div>
     This dictionary is used by the caller to specify information about the user account and <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-14">Relying Party</a> with which a credential
    is to be associated. It is intended to help the authenticator in providing a friendly credential selection interface for the
    user. 
    <p>The <dfn data-dfn-for="Account" data-dfn-type="dfn" data-noexport="" id="account-rpdisplayname">rpDisplayName<a class="self-link" href="#account-rpdisplayname"></a></dfn> member contains the friendly name of the Relying Party, such as "Acme Corporation", "Widgets Inc" or
    "Awesome Site".</p>
    <p>The <dfn data-dfn-for="Account" data-dfn-type="dfn" data-noexport="" id="account-displayname">displayName<a class="self-link" href="#account-displayname"></a></dfn> member contains the friendly name associated with the user account by the Relying Party, such as "John P.
    Smith".</p>
    <p>The <dfn data-dfn-for="Account" data-dfn-type="dfn" data-noexport="" id="account-id">id<a class="self-link" href="#account-id"></a></dfn> member contains an identifier for the account, specified by the Relying Party. This is not meant to be displayed
    to the user. It is used by the Relying Party to control the number of credentials - an authenticator will never contain more than one
    credential for a given Relying Party under the same <code class="idl"><a data-link-type="idl" href="#dom-account-id" id="ref-for-dom-account-id-2">id</a></code>.</p>
    <p>The <dfn data-dfn-for="Account" data-dfn-type="dfn" data-noexport="" id="account-name">name<a class="self-link" href="#account-name"></a></dfn> member contains a detailed name for the account, such as "john.p.smith@example.com".</p>
    <p>The <dfn data-dfn-for="Account" data-dfn-type="dfn" data-noexport="" id="account-imageurl">imageURL<a class="self-link" href="#account-imageurl"></a></dfn> member contains a URL that resolves to the user’s account image. This may be a URL that can be used
    to retrieve an image containing the user’s current avatar, or a data URI that contains the image data.</p>
   </div>
   <h3 class="heading settled" data-level="4.4" id="credential-params"><span class="secno">4.4. </span><span class="content">Parameters for Credential Generation (dictionary <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-scopedcredentialparameters">ScopedCredentialParameters</dfn>)</span><a class="self-link" href="#credential-params"></a></h3>
<pre class="idl highlight def"><span class="kt">dictionary</span> <a class="nv idl-code" data-link-type="dictionary" href="#dictdef-scopedcredentialparameters" id="ref-for-dictdef-scopedcredentialparameters-3">ScopedCredentialParameters</a> {
    <span class="kt">required</span> <a class="n" data-link-type="idl-name" href="#enumdef-scopedcredentialtype" id="ref-for-enumdef-scopedcredentialtype-2">ScopedCredentialType</a>  <dfn class="nv idl-code" data-dfn-for="ScopedCredentialParameters" data-dfn-type="dict-member" data-export="" data-type="ScopedCredentialType  " id="dom-scopedcredentialparameters-type">type<a class="self-link" href="#dom-scopedcredentialparameters-type"></a></dfn>;
    <span class="kt">required</span> <a class="n" data-link-type="idl-name" href="#dictdef-algorithmidentifier" id="ref-for-dictdef-algorithmidentifier-1">AlgorithmIdentifier</a>   <dfn class="nv idl-code" data-dfn-for="ScopedCredentialParameters" data-dfn-type="dict-member" data-export="" data-type="AlgorithmIdentifier   " id="dom-scopedcredentialparameters-algorithm">algorithm<a class="self-link" href="#dom-scopedcredentialparameters-algorithm"></a></dfn>;
};
</pre>
   <div>
     This dictionary is used to supply additional parameters when creating a new credential. 
    <p>The <dfn data-dfn-for="ScopedCredentialParameters" data-dfn-type="dfn" data-noexport="" id="scopedcredentialparameters-type">type<a class="self-link" href="#scopedcredentialparameters-type"></a></dfn> member specifies the type of credential to be created.</p>
    <p>The <dfn data-dfn-for="ScopedCredentialParameters" data-dfn-type="dfn" data-noexport="" id="scopedcredentialparameters-algorithm">algorithm<a class="self-link" href="#scopedcredentialparameters-algorithm"></a></dfn> member specifies the cryptographic signature algorithm with which the newly generated credential
    will be used, and thus also the type of asymmetric key pair to be generated, e.g., RSA or Elliptic Curve.</p>
   </div>
   <h3 class="heading settled" data-level="4.5" id="credential-options"><span class="secno">4.5. </span><span class="content">Additional options for Credential Generation (dictionary <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-scopedcredentialoptions">ScopedCredentialOptions</dfn>)</span><a class="self-link" href="#credential-options"></a></h3>
<pre class="idl highlight def"><span class="kt">dictionary</span> <a class="nv idl-code" data-link-type="dictionary" href="#dictdef-scopedcredentialoptions" id="ref-for-dictdef-scopedcredentialoptions-2">ScopedCredentialOptions</a> {
    <span class="kt">unsigned</span> <span class="kt">long</span>                           <dfn class="nv dfn-paneled idl-code" data-dfn-for="ScopedCredentialOptions" data-dfn-type="dict-member" data-export="" data-type="unsigned long                           " id="dom-scopedcredentialoptions-timeoutseconds">timeoutSeconds</dfn>;
    <span class="kt">USVString</span>                               <dfn class="nv dfn-paneled idl-code" data-dfn-for="ScopedCredentialOptions" data-dfn-type="dict-member" data-export="" data-type="USVString                               " id="dom-scopedcredentialoptions-rpid">rpId</dfn>;
    <span class="kt">sequence</span> &lt; <a class="n" data-link-type="idl-name" href="#dictdef-scopedcredentialdescriptor" id="ref-for-dictdef-scopedcredentialdescriptor-1">ScopedCredentialDescriptor</a> > <dfn class="nv dfn-paneled idl-code" data-default="None" data-dfn-for="ScopedCredentialOptions" data-dfn-type="dict-member" data-export="" data-type="sequence < ScopedCredentialDescriptor > " id="dom-scopedcredentialoptions-excludelist">excludeList</dfn> = [];
    <a class="n" data-link-type="idl-name" href="#enumdef-attachment" id="ref-for-enumdef-attachment-1">Attachment</a>                              <dfn class="nv dfn-paneled idl-code" data-dfn-for="ScopedCredentialOptions" data-dfn-type="dict-member" data-export="" data-type="Attachment                              " id="dom-scopedcredentialoptions-attachment">attachment</dfn>;
    <a class="n" data-link-type="idl-name" href="#dictdef-authenticationextensions" id="ref-for-dictdef-authenticationextensions-1">AuthenticationExtensions</a>                <dfn class="nv dfn-paneled idl-code" data-dfn-for="ScopedCredentialOptions" data-dfn-type="dict-member" data-export="" data-type="AuthenticationExtensions                " id="dom-scopedcredentialoptions-extensions">extensions</dfn>;
};
</pre>
   <div>
     This dictionary is used to supply additional options when creating a new credential. All these parameters are optional. 
    <ul>
     <li data-md="">
      <p>The <dfn data-dfn-for="ScopedCredentialOptions" data-dfn-type="dfn" data-noexport="" id="scopedcredentialoptions-timeoutseconds">timeoutSeconds<a class="self-link" href="#scopedcredentialoptions-timeoutseconds"></a></dfn> parameter specifies a time, in seconds, that the caller is willing to wait for the call to
complete. This is treated as a hint, and may be overridden by the platform.</p>
     <li data-md="">
      <p>The <dfn data-dfn-for="ScopedCredentialOptions" data-dfn-type="dfn" data-noexport="" id="scopedcredentialoptions-rpid">rpId<a class="self-link" href="#scopedcredentialoptions-rpid"></a></dfn> parameter explicitly specifies the RP ID that the credential should be associated with. If it is
omitted, the RP ID will be set to the <a data-link-type="dfn" href="https://www.w3.org/TR/html51/webappapis.html#current-settings-object">current settings object</a>’s <a data-link-type="dfn" href="https://www.w3.org/TR/html51/browsers.html#concept-cross-origin">origin</a>.</p>
     <li data-md="">
      <p>The <dfn data-dfn-for="ScopedCredentialOptions" data-dfn-type="dfn" data-noexport="" id="scopedcredentialoptions-excludelist">excludeList<a class="self-link" href="#scopedcredentialoptions-excludelist"></a></dfn> parameter is intended for use by <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-15">Relying Parties</a> that wish to limit the creation of multiple
credentials for the same account on a single authenticator. The platform is requested to return an error if the new
credential would be created on an authenticator that also contains one of the credentials enumerated in this parameter.</p>
     <li data-md="">
      <p>The <dfn data-dfn-for="ScopedCredentialOptions" data-dfn-type="dfn" data-noexport="" id="scopedcredentialoptions-extensions">extensions<a class="self-link" href="#scopedcredentialoptions-extensions"></a></dfn> parameter contains additional parameters requesting additional processing by the client and
authenticator. For example, the caller may request that only authenticators with certain capabilities be used to create
the credential, or that additional information be returned in the attestation statement. Alternatively, the caller may
specify an additional message that they would like the authenticator to display to the user. Extensions are defined in <a href="#extensions">§7 WebAuthn Extensions</a>.</p>
     <li data-md="">
      <p>The <dfn data-dfn-for="ScopedCredentialOptions" data-dfn-type="dfn" data-noexport="" id="scopedcredentialoptions-attachment">attachment<a class="self-link" href="#scopedcredentialoptions-attachment"></a></dfn> parameter contains authenticator attachment descriptions, which are used as an additional
constraint on which authenticators are eligible to participate in a <a href="#makeCredential">§4.1.1 Create a new credential (makeCredential() method)</a> or <a href="#getAssertion">§4.1.2 Use an existing credential (getAssertion() method)</a> operation.
See <a href="#attachment">§4.5.1 Credential Attachment enumeration (enum Attachment)</a> for a description of the attachment values and their meanings.</p>
    </ul>
   </div>
   <h4 class="heading settled" data-level="4.5.1" id="attachment"><span class="secno">4.5.1. </span><span class="content">Credential Attachment enumeration (enum <dfn class="dfn-paneled idl-code" data-dfn-type="enum" data-export="" id="enumdef-attachment">Attachment</dfn>)</span><a class="self-link" href="#attachment"></a></h4>
<pre class="idl highlight def"><span class="kt">enum</span> <a class="nv idl-code" data-link-type="enum" href="#enumdef-attachment" id="ref-for-enumdef-attachment-2">Attachment</a> {
    <dfn class="s idl-code" data-dfn-for="Attachment" data-dfn-type="enum-value" data-export="" data-lt="&quot;platform&quot;|platform" id="dom-attachment-platform">"platform"<a class="self-link" href="#dom-attachment-platform"></a></dfn>,
    <dfn class="s idl-code" data-dfn-for="Attachment" data-dfn-type="enum-value" data-export="" data-lt="&quot;cross-platform&quot;|cross-platform" id="dom-attachment-cross-platform">"cross-platform"<a class="self-link" href="#dom-attachment-cross-platform"></a></dfn>
};
</pre>
   <div>
     Clients may communicate with authenticators using a variety of mechanisms. For example, a client may use a platform-specific
    API to communicate with an authenticator which is physically bound to a platform. On the other hand, a client may use a
    variety of standardized cross-platform transport protocols such as Bluetooth (see <a href="#transport">§4.10.5 Credential Transport enumeration (enum ExternalTransport)</a>) to discover and
    communicate with <a data-link-type="dfn" href="#attachment-cross-platform-attached" id="ref-for-attachment-cross-platform-attached-1">cross-platform attached</a> authenticators. We define authenticators that are part of the client’s
    platform as having a <a data-link-type="dfn" href="#attachment-platform-attachment" id="ref-for-attachment-platform-attachment-1">platform attachment</a>, and refer to them as <dfn class="dfn-paneled" data-dfn-for="Attachment" data-dfn-type="dfn" data-noexport="" id="attachment-platform-authenticators">platform authenticators</dfn>. While those that
    are reachable via cross-platform transport protocols are defined as having <a data-link-type="dfn" href="#attachment-cross-platform-attached" id="ref-for-attachment-cross-platform-attached-2">cross-platform attachment</a>, and refer to
    them as <dfn class="dfn-paneled" data-dfn-for="Attachment" data-dfn-type="dfn" data-noexport="" id="attachment-roaming-authenticators">roaming authenticators</dfn>. 
    <ul>
     <li><dfn class="dfn-paneled" data-dfn-for="Attachment" data-dfn-type="dfn" data-noexport="" id="attachment-platform-attachment">platform attachment</dfn> - the respective authenticator is attached
            using platform-specific transports.  Usually, authenticators of
            this class are non-removable from the platform. 
     <li><dfn class="dfn-paneled" data-dfn-for="Attachment" data-dfn-type="dfn" data-lt="cross-platform attached|cross-platform attachment" data-noexport="" id="attachment-cross-platform-attached">cross-platform attachment</dfn> - the respective
            authenticator is attached using cross-platform transports. Authenticators of this class are removable from, and can
            "roam" among, client platforms. 
    </ul>
    <p>This distinction is important because there are use-cases where only <a data-link-type="dfn" href="#attachment-platform-authenticators" id="ref-for-attachment-platform-authenticators-1">platform authenticators</a> are acceptable to a
    Relying Party, and conversely ones where only <a data-link-type="dfn" href="#attachment-roaming-authenticators" id="ref-for-attachment-roaming-authenticators-2">roaming authenticators</a> are employed. As a concrete example of the former, a
    credential on a <a data-link-type="dfn" href="#attachment-platform-authenticators" id="ref-for-attachment-platform-authenticators-2">platform authenticator</a> may be used by Relying Parties to quickly and conveniently reauthenticate the user with
    a minimum of friction, e.g., the user will not have to dig around in their pocket for their key fob or phone. As a concrete
    example of the latter, when the user is accessing the Relying Party from a given client for the first time, they may be required to
    use a <a data-link-type="dfn" href="#attachment-roaming-authenticators" id="ref-for-attachment-roaming-authenticators-3">roaming authenticator</a> which was originally registered with the Relying Party using a different client.</p>
   </div>
   <h3 class="heading settled" data-level="4.6" id="iface-assertion"><span class="secno">4.6. </span><span class="content">Web Authentication Assertion (interface <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="authenticationassertion">AuthenticationAssertion</dfn>)</span><a class="self-link" href="#iface-assertion"></a></h3>
<pre class="idl highlight def">[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext">SecureContext</a>]
<span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="#authenticationassertion" id="ref-for-authenticationassertion-4">AuthenticationAssertion</a> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#scopedcredential" id="ref-for-scopedcredential-2">ScopedCredential</a>  <dfn class="nv idl-code" data-dfn-for="AuthenticationAssertion" data-dfn-type="attribute" data-export="" data-readonly="" data-type="ScopedCredential" id="dom-authenticationassertion-credential">credential<a class="self-link" href="#dom-authenticationassertion-credential"></a></dfn>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>       <dfn class="nv dfn-paneled idl-code" data-dfn-for="AuthenticationAssertion" data-dfn-type="attribute" data-export="" data-readonly="" data-type="ArrayBuffer" id="dom-authenticationassertion-clientdata">clientData</dfn>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>       <dfn class="nv dfn-paneled idl-code" data-dfn-for="AuthenticationAssertion" data-dfn-type="attribute" data-export="" data-readonly="" data-type="ArrayBuffer" id="dom-authenticationassertion-authenticatordata">authenticatorData</dfn>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>       <dfn class="nv dfn-paneled idl-code" data-dfn-for="AuthenticationAssertion" data-dfn-type="attribute" data-export="" data-readonly="" data-type="ArrayBuffer" id="dom-authenticationassertion-signature">signature</dfn>;
};
</pre>
   <p>Scoped credentials produce a cryptographic signature that provides proof of possession of a private key as well as evidence of
user consent to a specific transaction. The structure of these signatures is defined as follows.</p>
   <div>
     The <dfn data-dfn-for="AuthenticationAssertion" data-dfn-type="dfn" data-noexport="" id="authenticationassertion-credential">credential<a class="self-link" href="#authenticationassertion-credential"></a></dfn> member represents the credential that was used to generate this assertion. 
    <p>The <dfn data-dfn-for="AuthenticationAssertion" data-dfn-type="dfn" data-noexport="" id="authenticationassertion-clientdata">clientData<a class="self-link" href="#authenticationassertion-clientdata"></a></dfn> member contains the parameters sent to the authenticator by the client, in serialized form. See <a href="#sec-client-data">§4.10.1 Client data used in WebAuthn signatures (dictionary ClientData)</a> for the format of this parameter and how it is generated.</p>
    <p>The <b><em>authenticatorData</em></b> member contains the serialized data returned by the authenticator. See <a href="#sec-authenticator-data">§5.2.1 Authenticator data</a>.</p>
    <p>The <dfn data-dfn-for="AuthenticationAssertion" data-dfn-type="dfn" data-noexport="" id="authenticationassertion-signature">signature<a class="self-link" href="#authenticationassertion-signature"></a></dfn> member contains the raw signature returned from the authenticator. See <a href="#authenticator-signature">§5.2.2 Generating a signature</a>.</p>
   </div>
   <h3 class="heading settled" data-level="4.7" id="assertion-options"><span class="secno">4.7. </span><span class="content">Additional options for Assertion Generation (dictionary <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-assertionoptions">AssertionOptions</dfn>)</span><a class="self-link" href="#assertion-options"></a></h3>
<pre class="idl highlight def"><span class="kt">dictionary</span> <a class="nv idl-code" data-link-type="dictionary" href="#dictdef-assertionoptions" id="ref-for-dictdef-assertionoptions-2">AssertionOptions</a> {
    <span class="kt">unsigned</span> <span class="kt">long</span>                           <dfn class="nv dfn-paneled idl-code" data-dfn-for="AssertionOptions" data-dfn-type="dict-member" data-export="" data-type="unsigned long                           " id="dom-assertionoptions-timeoutseconds">timeoutSeconds</dfn>;
    <span class="kt">USVString</span>                               <dfn class="nv dfn-paneled idl-code" data-dfn-for="AssertionOptions" data-dfn-type="dict-member" data-export="" data-type="USVString                               " id="dom-assertionoptions-rpid">rpId</dfn>;
    <span class="kt">sequence</span> &lt; <a class="n" data-link-type="idl-name" href="#dictdef-scopedcredentialdescriptor" id="ref-for-dictdef-scopedcredentialdescriptor-2">ScopedCredentialDescriptor</a> > <dfn class="nv dfn-paneled idl-code" data-default="None" data-dfn-for="AssertionOptions" data-dfn-type="dict-member" data-export="" data-type="sequence < ScopedCredentialDescriptor > " id="dom-assertionoptions-allowlist">allowList</dfn> = [];
    <a class="n" data-link-type="idl-name" href="#dictdef-authenticationextensions" id="ref-for-dictdef-authenticationextensions-2">AuthenticationExtensions</a>                <dfn class="nv dfn-paneled idl-code" data-dfn-for="AssertionOptions" data-dfn-type="dict-member" data-export="" data-type="AuthenticationExtensions                " id="dom-assertionoptions-extensions">extensions</dfn>;
};
</pre>
   <div>
     This dictionary is used to supply additional options when generating an assertion. All these parameters are optional. 
    <ul>
     <li data-md="">
      <p>The optional <dfn data-dfn-for="AssertionOptions" data-dfn-type="dfn" data-noexport="" id="assertionoptions-timeoutseconds">timeoutSeconds<a class="self-link" href="#assertionoptions-timeoutseconds"></a></dfn> parameter specifies a time, in seconds, that the caller is willing to wait for the
call to complete. This is treated as a hint, and may be overridden by the platform.</p>
     <li data-md="">
      <p>The optional <dfn data-dfn-for="AssertionOptions" data-dfn-type="dfn" data-noexport="" id="assertionoptions-rpid">rpId<a class="self-link" href="#assertionoptions-rpid"></a></dfn> parameter specifies the rpId claimed by the caller. If it is omitted, it will be assumed to
be equal to the <a data-link-type="dfn" href="https://www.w3.org/TR/html51/webappapis.html#current-settings-object">current settings object</a>’s <a data-link-type="dfn" href="https://www.w3.org/TR/html51/browsers.html#concept-cross-origin">origin</a>.</p>
     <li data-md="">
      <p>The optional <dfn data-dfn-for="AssertionOptions" data-dfn-type="dfn" data-noexport="" id="assertionoptions-allowlist">allowList<a class="self-link" href="#assertionoptions-allowlist"></a></dfn> member contains a list of credentials acceptable to the caller, in order of the caller’s
preference.</p>
     <li data-md="">
      <p>The optional <dfn data-dfn-for="AssertionOptions" data-dfn-type="dfn" data-noexport="" id="assertionoptions-extensions">extensions<a class="self-link" href="#assertionoptions-extensions"></a></dfn> parameter contains additional parameters requesting additional processing by the client
and authenticator. For example, if transaction confirmation is sought from the user, then the prompt string would be
included in an extension. Extensions are defined in a companion specification.</p>
    </ul>
   </div>
   <h3 class="heading settled" data-level="4.8" id="iface-assertion-extensions"><span class="secno">4.8. </span><span class="content">Authentication Assertion Extensions (dictionary <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-authenticationextensions">AuthenticationExtensions</dfn>)</span><a class="self-link" href="#iface-assertion-extensions"></a></h3>
<pre class="idl highlight def"><span class="kt">dictionary</span> <a class="nv idl-code" data-link-type="dictionary" href="#dictdef-authenticationextensions" id="ref-for-dictdef-authenticationextensions-3">AuthenticationExtensions</a> {
};
</pre>
   <p>This is a dictionary containing zero or more extensions as defined in <a href="#extensions">§7 WebAuthn Extensions</a>. An extension is an additional parameter
that can be passed to the <a data-link-type="functionish" href="#dom-webauthentication-getassertion" id="ref-for-dom-webauthentication-getassertion-6">getAssertion()</a> method and triggers some additional processing by the client platform and/or the
authenticator.</p>
   <p>If the caller wishes to pass extensions to the platform, it MUST do so by adding one entry per extension to this dictionary
with the extension identifier as the key, and the extension’s value as the value (see <a href="#extensions">§7 WebAuthn Extensions</a> for details).</p>
   <h3 class="heading settled" data-level="4.9" id="iface-attestation"><span class="secno">4.9. </span><span class="content">Credential Attestation Structure (interface <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="authenticationattestation">AuthenticationAttestation</dfn>)</span><a class="self-link" href="#iface-attestation"></a></h3>
<pre class="idl highlight def">[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext">SecureContext</a>]
<span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="#authenticationattestation" id="ref-for-authenticationattestation-2">AuthenticationAttestation</a> {
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">USVString</span>     <dfn class="nv dfn-paneled idl-code" data-dfn-for="AuthenticationAttestation" data-dfn-type="attribute" data-export="" data-readonly="" data-type="USVString" id="dom-authenticationattestation-format">format</dfn>;
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>   <dfn class="nv dfn-paneled idl-code" data-dfn-for="AuthenticationAttestation" data-dfn-type="attribute" data-export="" data-readonly="" data-type="ArrayBuffer" id="dom-authenticationattestation-clientdata">clientData</dfn>;
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>   <dfn class="nv dfn-paneled idl-code" data-dfn-for="AuthenticationAttestation" data-dfn-type="attribute" data-export="" data-readonly="" data-type="ArrayBuffer" id="dom-authenticationattestation-authenticatordata">authenticatorData</dfn>;
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">any</span>           <dfn class="nv dfn-paneled idl-code" data-dfn-for="AuthenticationAttestation" data-dfn-type="attribute" data-export="" data-readonly="" data-type="any" id="dom-authenticationattestation-attestation">attestation</dfn>;
};
</pre>
   <p>Authenticators must also provide some form of attestation. The basic requirement is that the authenticator can produce, for each <a data-link-type="dfn" href="#credential-public-key" id="ref-for-credential-public-key-3">credential public key</a>, attestation information that can be verified by a <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-16">Relying Party</a>. Typically, this information
contains a signature by an attestation private key over the attested <a data-link-type="dfn" href="#credential-public-key" id="ref-for-credential-public-key-4">credential public key</a> and a challenge, as well as a
certificate or similar information providing provenance information for the <a data-link-type="dfn" href="#attestation-public-key" id="ref-for-attestation-public-key-1">attestation public key</a>, enabling a trust
decision to be made. However, if an <a data-link-type="dfn" href="#attestation-key-pair" id="ref-for-attestation-key-pair-3">attestation key pair</a> is not available, then the authenticator MUST perform <a data-link-type="dfn" href="#self-attestation" id="ref-for-self-attestation-5">self
attestation</a> of the <a data-link-type="dfn" href="#credential-public-key" id="ref-for-credential-public-key-5">credential public key</a> with the corresponding <a data-link-type="dfn" href="#credential-private-key" id="ref-for-credential-private-key-1">credential private key</a>.</p>
   <div>
     The <dfn data-dfn-for="AuthenticationAttestation" data-dfn-type="dfn" data-noexport="" id="authenticationattestation-format">format<a class="self-link" href="#authenticationattestation-format"></a></dfn> member specifies the format of attestation statement contained in this structure. Attestation formats
    are defined in <a href="#attestation-formats">§5.3.1 Attestation Formats</a>. This specification supports a number of attestation formats, in <a href="#defined-attestation-formats">§6 Defined Attestation Formats</a>. Other attestation formats may be defined in later versions of this specification. 
    <p>The <dfn data-dfn-for="AuthenticationAttestation" data-dfn-type="dfn" data-noexport="" id="authenticationattestation-clientdata">clientData<a class="self-link" href="#authenticationattestation-clientdata"></a></dfn> member contains the <a data-link-type="dfn" href="#clientdatajson" id="ref-for-clientdatajson-5">clientDataJSON</a> (see <a href="#signature-format">§5.2 Signature Format</a>). The exact JSON encoding
    must be preserved as the hash (<a data-link-type="dfn" href="#clientdatahash" id="ref-for-clientdatahash-5">clientDataHash</a>) has been computed over it.</p>
    <p>The <b><em>authenticatorData</em></b> member contains the serialized data returned by the authenticator. See <a href="#sec-authenticator-data">§5.2.1 Authenticator data</a>.</p>
    <p>The <dfn data-dfn-for="AuthenticationAttestation" data-dfn-type="dfn" data-noexport="" id="authenticationattestation-attestation">attestation<a class="self-link" href="#authenticationattestation-attestation"></a></dfn> element contains the actual <dfn class="dfn-paneled" data-dfn-for="AuthenticationAttestation" data-dfn-type="dfn" data-noexport="" id="authenticationattestation-attestation-statement">attestation statement</dfn>. The structure of this object
    depends on the <a data-link-type="dfn" href="#attestation-format" id="ref-for-attestation-format-2">attestation format</a>. For more details, see <a href="#cred-attestation-stmts">§5.3 Credential Attestation Statements</a>.</p>
   </div>
   <p>This attestation structure is delivered to the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-17">Relying Party</a> by the Relying Party’s script running on the client, using methods outside
the scope of this specification. It contains all the information that the Relying Party’s server requires to validate the statement, as
well as to decode and validate the bindings of both the client and authenticator data.</p>
   <h3 class="heading settled" data-level="4.10" id="supporting-data-structures"><span class="secno">4.10. </span><span class="content">Supporting Data Structures</span><a class="self-link" href="#supporting-data-structures"></a></h3>
   <p>The scoped credential type uses certain data structures that are specified in supporting specifications. These are as follows.</p>
   <h4 class="heading settled" data-level="4.10.1" id="sec-client-data"><span class="secno">4.10.1. </span><span class="content">Client data used in WebAuthn signatures (dictionary <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-clientdata">ClientData</dfn>)</span><a class="self-link" href="#sec-client-data"></a></h4>
   <p>The client data represents the contextual bindings of both the Relying Party and the client platform. It is a key-value mapping with
string-valued keys. Values may be any type that has a valid encoding in JSON. Its structure is defined by the following Web IDL.</p>
<pre class="idl highlight def"><span class="kt">dictionary</span> <a class="nv idl-code" data-link-type="dictionary" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-3">ClientData</a> {
    <span class="kt">required</span> <span class="kt">DOMString</span>           <dfn class="nv dfn-paneled idl-code" data-dfn-for="ClientData" data-dfn-type="dict-member" data-export="" data-type="DOMString           " id="dom-clientdata-challenge">challenge</dfn>;
    <span class="kt">required</span> <span class="kt">DOMString</span>           <dfn class="nv dfn-paneled idl-code" data-dfn-for="ClientData" data-dfn-type="dict-member" data-export="" data-type="DOMString           " id="dom-clientdata-origin">origin</dfn>;
    <span class="kt">required</span> <a class="n" data-link-type="idl-name" href="#dictdef-algorithmidentifier" id="ref-for-dictdef-algorithmidentifier-2">AlgorithmIdentifier</a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="ClientData" data-dfn-type="dict-member" data-export="" data-type="AlgorithmIdentifier " id="dom-clientdata-hashalg">hashAlg</dfn>;
    <span class="kt">DOMString</span>                    <dfn class="nv dfn-paneled idl-code" data-dfn-for="ClientData" data-dfn-type="dict-member" data-export="" data-type="DOMString                    " id="dom-clientdata-tokenbinding">tokenBinding</dfn>;
    <a class="n" data-link-type="idl-name" href="#dictdef-authenticationextensions" id="ref-for-dictdef-authenticationextensions-4">AuthenticationExtensions</a>     <dfn class="nv dfn-paneled idl-code" data-dfn-for="ClientData" data-dfn-type="dict-member" data-export="" data-type="AuthenticationExtensions     " id="dom-clientdata-extensions">extensions</dfn>;
};
</pre>
   <div>
     The <dfn data-dfn-for="ClientData" data-dfn-type="dfn" data-noexport="" id="clientdata-challenge">challenge<a class="self-link" href="#clientdata-challenge"></a></dfn> member contains the base64url encoding of the challenge provided by the RP. 
    <p>The <dfn data-dfn-for="ClientData" data-dfn-type="dfn" data-noexport="" id="clientdata-origin">origin<a class="self-link" href="#clientdata-origin"></a></dfn> member contains the fully qualified origin of the requester, as provided to the authenticator by
    the client, in the syntax defined by <a data-link-type="biblio" href="#biblio-rfc6454">[RFC6454]</a>.</p>
    <p>The <dfn class="dfn-paneled" data-dfn-for="ClientData" data-dfn-type="dfn" data-noexport="" id="clientdata-hashalg">hashAlg</dfn> member specifies the hash algorithm used to compute <a data-link-type="dfn" href="#clientdatahash" id="ref-for-clientdatahash-6">clientDataHash</a> (see <a href="#authenticator-signature">§5.2.2 Generating a signature</a>). Use "S256" for SHA-256, "S384" for SHA384, "S512" for SHA512, and "SM3" for SM3 (see <a href="#iana-considerations">§9 IANA Considerations</a>). This algorithm is chosen by the client at its sole discretion.</p>
    <p>The <dfn data-dfn-for="ClientData" data-dfn-type="dfn" data-noexport="" id="clientdata-tokenbinding">tokenBinding<a class="self-link" href="#clientdata-tokenbinding"></a></dfn> member contains the base64url encoding of the Token Binding ID that this client uses for the
    Token Binding protocol when communicating with the Relying Party. This can be omitted if no Token Binding has been negotiated between
    the client and the Relying Party.</p>
    <p>The optional <dfn data-dfn-for="ClientData" data-dfn-type="dfn" data-noexport="" id="clientdata-extensions">extensions<a class="self-link" href="#clientdata-extensions"></a></dfn> member contains additional parameters generated by processing the extensions passed in
    by the Relying Party. WebAuthn extensions are detailed in Section <a href="#extensions">§7 WebAuthn Extensions</a>.</p>
   </div>
   <p>This structure is used by the client to compute the following quantities:</p>
   <dl>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="clientdatajson">clientDataJSON</dfn></p>
    <dd data-md="">
     <p>This is the <a data-link-type="dfn">UTF-8 encoded</a> JSON serialization <a data-link-type="biblio" href="#biblio-rfc7159">[RFC7159]</a> of a <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-4">ClientData</a></code> dictionary.</p>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="clientdatahash">clientDataHash</dfn></p>
    <dd data-md="">
     <p>This is the hash (computed using <a data-link-type="dfn" href="#clientdata-hashalg" id="ref-for-clientdata-hashalg-1">hashAlg</a>) of <a data-link-type="dfn" href="#clientdatajson" id="ref-for-clientdatajson-6">clientDataJSON</a>.</p>
   </dl>
   <h4 class="heading settled" data-level="4.10.2" id="credentialType"><span class="secno">4.10.2. </span><span class="content">Credential Type enumeration (enum <dfn class="dfn-paneled idl-code" data-dfn-type="enum" data-export="" id="enumdef-scopedcredentialtype">ScopedCredentialType</dfn>)</span><a class="self-link" href="#credentialType"></a></h4>
<pre class="idl highlight def"><span class="kt">enum</span> <a class="nv idl-code" data-link-type="enum" href="#enumdef-scopedcredentialtype" id="ref-for-enumdef-scopedcredentialtype-3">ScopedCredentialType</a> {
    <dfn class="s idl-code" data-dfn-for="ScopedCredentialType" data-dfn-type="enum-value" data-export="" data-lt="&quot;ScopedCred&quot;|ScopedCred" id="dom-scopedcredentialtype-scopedcred">"ScopedCred"<a class="self-link" href="#dom-scopedcredentialtype-scopedcred"></a></dfn>
};
</pre>
   <div>
     This enumeration defines the valid credential types. It is an extension point; values may be added to it in the future, as
    more credential types are defined. The values of this enumeration are used for versioning the WebAuthn assertion and
    attestation structures according to the type of the authenticator. 
    <p>Currently one credential type is defined, namely "<dfn data-dfn-for="ScopedCredentialType" data-dfn-type="dfn" data-noexport="" id="scopedcredentialtype-scopedcred">ScopedCred<a class="self-link" href="#scopedcredentialtype-scopedcred"></a></dfn>".</p>
   </div>
   <h4 class="heading settled" data-level="4.10.3" id="credential-identifier"><span class="secno">4.10.3. </span><span class="content">Unique Identifier for Credential (interface <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="scopedcredential">ScopedCredential</dfn>)</span><a class="self-link" href="#credential-identifier"></a></h4>
<pre class="idl highlight def">[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext">SecureContext</a>]
<span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="#scopedcredential" id="ref-for-scopedcredential-3">ScopedCredential</a> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#enumdef-scopedcredentialtype" id="ref-for-enumdef-scopedcredentialtype-4">ScopedCredentialType</a> <dfn class="nv idl-code" data-dfn-for="ScopedCredential" data-dfn-type="attribute" data-export="" data-readonly="" data-type="ScopedCredentialType" id="dom-scopedcredential-type">type<a class="self-link" href="#dom-scopedcredential-type"></a></dfn>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>          <dfn class="nv idl-code" data-dfn-for="ScopedCredential" data-dfn-type="attribute" data-export="" data-readonly="" data-type="ArrayBuffer" id="dom-scopedcredential-id">id<a class="self-link" href="#dom-scopedcredential-id"></a></dfn>;
};
</pre>
   <p>This interface contains the attributes that are returned to the caller when a new credential is created, and can be used later
by the caller to select a credential for use.</p>
   <div>
     The <dfn data-dfn-for="ScopedCredential" data-dfn-type="dfn" data-noexport="" id="scopedcredential-type">type<a class="self-link" href="#scopedcredential-type"></a></dfn> attribute contains a value of type <code class="idl"><a data-link-type="idl" href="#enumdef-scopedcredentialtype" id="ref-for-enumdef-scopedcredentialtype-5">ScopedCredentialType</a></code>, indicating the specification and version
    that this credential conforms to. 
    <p>The <dfn data-dfn-for="ScopedCredential" data-dfn-type="dfn" data-noexport="" id="scopedcredential-id">id<a class="self-link" href="#scopedcredential-id"></a></dfn> attribute contains an identifier for the credential, chosen by the platform with help from the
    authenticator. This identifier is used to look up credentials for use, and is therefore expected to be globally unique with
    high probability across all credentials of the same type, across all authenticators. This API does not constrain the format
    or length of this identifier, except that it must be sufficient for the platform to uniquely select a key. For example, an
    authenticator without on-board storage may create identifiers that consist of the key material wrapped with a key that is
    burned into the authenticator.</p>
   </div>
   <h4 class="heading settled" data-level="4.10.4" id="credential-dictionary"><span class="secno">4.10.4. </span><span class="content">Credential Descriptor (dictionary <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-scopedcredentialdescriptor">ScopedCredentialDescriptor</dfn>)</span><a class="self-link" href="#credential-dictionary"></a></h4>
<pre class="idl highlight def"><span class="kt">dictionary</span> <a class="nv idl-code" data-link-type="dictionary" href="#dictdef-scopedcredentialdescriptor" id="ref-for-dictdef-scopedcredentialdescriptor-3">ScopedCredentialDescriptor</a> {
    <span class="kt">required</span> <a class="n" data-link-type="idl-name" href="#enumdef-scopedcredentialtype" id="ref-for-enumdef-scopedcredentialtype-6">ScopedCredentialType</a> <dfn class="nv idl-code" data-dfn-for="ScopedCredentialDescriptor" data-dfn-type="dict-member" data-export="" data-type="ScopedCredentialType " id="dom-scopedcredentialdescriptor-type">type<a class="self-link" href="#dom-scopedcredentialdescriptor-type"></a></dfn>;
    <span class="kt">required</span> <a class="n" data-link-type="idl-name" href="https://heycam.github.io/webidl/#BufferSource">BufferSource</a>   <dfn class="nv idl-code" data-dfn-for="ScopedCredentialDescriptor" data-dfn-type="dict-member" data-export="" data-type="BufferSource   " id="dom-scopedcredentialdescriptor-id">id<a class="self-link" href="#dom-scopedcredentialdescriptor-id"></a></dfn>;
    <span class="kt">sequence</span> &lt; <a class="n" data-link-type="idl-name" href="#enumdef-transport" id="ref-for-enumdef-transport-1">Transport</a> >  <dfn class="nv idl-code" data-dfn-for="ScopedCredentialDescriptor" data-dfn-type="dict-member" data-export="" data-type="sequence < Transport >  " id="dom-scopedcredentialdescriptor-transports">transports<a class="self-link" href="#dom-scopedcredentialdescriptor-transports"></a></dfn>;
};
</pre>
   <p>This dictionary contains the attributes that are specified by a caller when referring to a credential as an input parameter to
the <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential" id="ref-for-dom-webauthentication-makecredential-3">makeCredential()</a></code> or <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-getassertion" id="ref-for-dom-webauthentication-getassertion-7">getAssertion()</a></code> method. It mirrors the fields of the <code class="idl"><a data-link-type="idl" href="#scopedcredential" id="ref-for-scopedcredential-4">ScopedCredential</a></code> object returned by
these methods.</p>
   <div>
     The <dfn data-dfn-for="ScopedCredentialDescriptor" data-dfn-type="dfn" data-noexport="" id="scopedcredentialdescriptor-type">type<a class="self-link" href="#scopedcredentialdescriptor-type"></a></dfn> attribute contains the type of the credential the caller is referring to. 
    <p>The <dfn data-dfn-for="ScopedCredentialDescriptor" data-dfn-type="dfn" data-noexport="" id="scopedcredentialdescriptor-id">id<a class="self-link" href="#scopedcredentialdescriptor-id"></a></dfn> attribute contains the identifier of the credential that the caller is referring to.</p>
   </div>
   <h4 class="heading settled" data-level="4.10.5" id="transport"><span class="secno">4.10.5. </span><span class="content">Credential Transport enumeration (enum <dfn class="idl-code" data-dfn-type="enum" data-export="" id="enumdef-externaltransport">ExternalTransport<a class="self-link" href="#enumdef-externaltransport"></a></dfn>)</span><a class="self-link" href="#transport"></a></h4>
<pre class="idl highlight def"><span class="kt">enum</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="enum" data-export="" id="enumdef-transport">Transport</dfn> {
    <dfn class="s idl-code" data-dfn-for="Transport" data-dfn-type="enum-value" data-export="" data-lt="&quot;usb&quot;|usb" id="dom-transport-usb">"usb"<a class="self-link" href="#dom-transport-usb"></a></dfn>,
    <dfn class="s idl-code" data-dfn-for="Transport" data-dfn-type="enum-value" data-export="" data-lt="&quot;nfc&quot;|nfc" id="dom-transport-nfc">"nfc"<a class="self-link" href="#dom-transport-nfc"></a></dfn>,
    <dfn class="s idl-code" data-dfn-for="Transport" data-dfn-type="enum-value" data-export="" data-lt="&quot;ble&quot;|ble" id="dom-transport-ble">"ble"<a class="self-link" href="#dom-transport-ble"></a></dfn>
};
</pre>
   <div>
     Authenticators may communicate with Clients using a variety of transports.
    This enumeration defines a hint as to how Clients might communicate with a
    particular Authenticator in order to obtain an assertion for a specific
    credential.  Note that these hints represent the Relying Party’s best belief as to
    how an Authenticator may be reached.  A Relying Party may obtain a list of
    transports hints from some attestation formats or via some out-of-band
    mechanism; it is outside the scope of this specification to define that
    mechanism. 
    <ul>
     <li><dfn data-dfn-for="Transport" data-dfn-type="dfn" data-noexport="" id="transport-usb">usb<a class="self-link" href="#transport-usb"></a></dfn> - the respective Authenticator may be contacted over
            USB. 
     <li><dfn data-dfn-for="Transport" data-dfn-type="dfn" data-noexport="" id="transport-nfc">nfc<a class="self-link" href="#transport-nfc"></a></dfn> - the respective Authenticator may be contacted over
            Near Field Communication (NFC). 
     <li><dfn data-dfn-for="Transport" data-dfn-type="dfn" data-noexport="" id="transport-ble">ble<a class="self-link" href="#transport-ble"></a></dfn> - the respective Authenticator may be contacted over
            Bluetooth Smart (Bluetooth Low Energy / BLE). 
    </ul>
   </div>
   <h4 class="heading settled" data-level="4.10.6" id="alg-identifier"><span class="secno">4.10.6. </span><span class="content">Cryptographic Algorithm Identifier (type <code class="idl"><a data-link-type="idl" href="#dictdef-algorithmidentifier" id="ref-for-dictdef-algorithmidentifier-3">AlgorithmIdentifier</a></code>)</span><a class="self-link" href="#alg-identifier"></a></h4>
   <p>A string or dictionary identifying a cryptographic algorithm and optionally a set of parameters for that algorithm. This type is
defined in <a data-link-type="biblio" href="#biblio-webcryptoapi">[WebCryptoAPI]</a>.</p>
   <h2 class="heading settled" data-level="5" id="authenticator-model"><span class="secno">5. </span><span class="content">WebAuthn Authenticator model</span><a class="self-link" href="#authenticator-model"></a></h2>
   <p>The API defined in this specification implies a specific abstract functional model for an <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-16">authenticator</a>. This section
describes the authenticator model. Client platforms may implement and expose this abstract model in any way desired. For
instance, this abstract model does not define specific error codes or methods of returning them; however, it does define error
behavior in terms of the needs of the client. Therefore, specific error codes are mentioned as a means of showing which error
conditions must be distinguishable (or not) from each other in order to enable a compliant and secure client implementation.
The overall requirement is that the behavior of the client’s Web Authentication API implementation, when operating on the
authenticators supported by that platform, MUST be indistinguishable from the behavior specified in <a href="#api">§4 Web Authentication API</a>.</p>
   <p>In this abstract model, each authenticator stores some number of scoped credentials. Each scoped credential has an identifier
which is unique (or extremely unlikely to be duplicated) among all scoped credentials. Each credential is also associated with a <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-18">Relying Party</a>, whose identity is represented by a <a data-link-type="dfn" href="#relying-party-identifier" id="ref-for-relying-party-identifier-1">Relying Party Identifier</a> (<a data-link-type="dfn" href="#rp-id" id="ref-for-rp-id-3">RP ID</a>).</p>
   <p>Each authenticator has an AAGUID, which is a 128-bit identifier that indicates the type (e.g. make and model) of the
authenticator. The AAGUID MUST be chosen by the manufacturer to be identical across all substantially identical authenticators
made by that manufacturer, and different (with probability 1-2<sup>-128</sup> or greater) from the AAGUIDs of all other types of
authenticators. The RP MAY use the AAGUID to infer certain properties of the authenticator, such as certification level and
strength of key protection, using information from other sources.</p>
   <h3 class="heading settled" data-level="5.1" id="authenticator-ops"><span class="secno">5.1. </span><span class="content">Authenticator operations</span><a class="self-link" href="#authenticator-ops"></a></h3>
   <p>A client must connect to an authenticator in order to invoke any of the operations of that authenticator. This connection
defines an authenticator session. An authenticator must maintain isolation between sessions. It may do this by only allowing one
session to exist at any particular time, or by providing more complicated session management.</p>
   <p>The following operations can be invoked by the client in an authenticator session.</p>
   <h4 class="heading settled" data-level="5.1.1" id="op-make-cred"><span class="secno">5.1.1. </span><span class="content">The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="authenticatormakecredential">authenticatorMakeCredential</dfn> operation</span><a class="self-link" href="#op-make-cred"></a></h4>
   <p>This operation must be invoked in an authenticator session which has no other operations in progress. It takes the following
input parameters:</p>
   <ul>
    <li data-md="">
     <p>The SHA-256 hash of the caller’s RP ID, as determined by the user agent and the client.</p>
    <li data-md="">
     <p>The <a data-link-type="dfn" href="#clientdatahash" id="ref-for-clientdatahash-7">clientDataHash</a>, which is the hash of the serialized <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-5">ClientData</a></code> and is provided by the client.</p>
    <li data-md="">
     <p>The <code class="idl"><a data-link-type="idl" href="#dictdef-account" id="ref-for-dictdef-account-3">Account</a></code> information provided by the Relying Party.</p>
    <li data-md="">
     <p>The <code class="idl"><a data-link-type="idl" href="#enumdef-scopedcredentialtype" id="ref-for-enumdef-scopedcredentialtype-7">ScopedCredentialType</a></code> and cryptographic parameters requested by the Relying Party, with the cryptographic algorithms normalized
as per the procedure in <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#algorithm-normalization-normalize-an-algorithm">Web Cryptography API §algorithm-normalization-normalize-an-algorithm</a>.</p>
    <li data-md="">
     <p>A list of <code class="idl"><a data-link-type="idl" href="#scopedcredential" id="ref-for-scopedcredential-5">ScopedCredential</a></code> objects provided by the Relying Party with the intention that, if any of these are known to the
authenticator, it should not create a new credential.</p>
    <li data-md="">
     <p>Extension data created by the client based on the extensions requested by the Relying Party.</p>
   </ul>
   <p>When this operation is invoked, the authenticator must perform the following procedure:</p>
   <ul>
    <li data-md="">
     <p>Check if all the supplied parameters are syntactically well-formed and of the correct length. If not, return an error code
equivalent to UnknownError and terminate the operation.</p>
    <li data-md="">
     <p>Check if at least one of the specified combinations of <code class="idl"><a data-link-type="idl" href="#enumdef-scopedcredentialtype" id="ref-for-enumdef-scopedcredentialtype-8">ScopedCredentialType</a></code> and cryptographic parameters is supported. If
not, return an error code equivalent to NotSupportedError and terminate the operation.</p>
    <li data-md="">
     <p>Check if a credential matching any of the supplied <code class="idl"><a data-link-type="idl" href="#scopedcredential" id="ref-for-scopedcredential-6">ScopedCredential</a></code> identifiers is present on this authenticator. If so,
return an error code equivalent to NotAllowedError and terminate the operation.</p>
    <li data-md="">
     <p>Prompt the user for consent to create a new credential. The prompt for obtaining this consent is shown by the authenticator
if it has its own output capability, or by the user agent otherwise. If the user denies consent, return an error code
equivalent to NotAllowedError and terminate the operation.</p>
    <li data-md="">
     <p>Once user consent has been obtained, generate a new credential object:</p>
     <ul>
      <li data-md="">
       <p>Generate a set of cryptographic keys using the most preferred combination of <code class="idl"><a data-link-type="idl" href="#enumdef-scopedcredentialtype" id="ref-for-enumdef-scopedcredentialtype-9">ScopedCredentialType</a></code> and cryptographic
parameters supported by this authenticator.</p>
      <li data-md="">
       <p>Generate an identifier for this credential, such that this identifier is globally unique with high probability across all
credentials with the same type across all authenticators.</p>
      <li data-md="">
       <p>Associate the credential with the specified RP ID hash and the user’s account identifier <code class="idl"><a data-link-type="idl" href="#dom-account-id" id="ref-for-dom-account-id-3">id</a></code>.</p>
      <li data-md="">
       <p>Delete any older credentials with the same RP ID hash and <code class="idl"><a data-link-type="idl" href="#dom-account-id" id="ref-for-dom-account-id-4">id</a></code> that are stored locally in the authenticator.</p>
     </ul>
    <li data-md="">
     <p>If any error occurred while creating the new credential object, return an error code equivalent to UnknownError and terminate
the operation.</p>
    <li data-md="">
     <p>Process all the supported extensions requested by the client, and generate an attestation statement. If no authority key is
available to sign such an attestation statement, then the authenticator performs <a data-link-type="dfn" href="#self-attestation" id="ref-for-self-attestation-6">self attestation</a> of the credential
with its own private key. For more details on attestation, see <a href="#cred-attestation-stmts">§5.3 Credential Attestation Statements</a>.</p>
   </ul>
   <p>On successful completion of this operation, the authenticator must return the following to the client:</p>
   <ul>
    <li data-md="">
     <p>The type and unique identifier of the new credential.</p>
    <li data-md="">
     <p>The new <a data-link-type="dfn" href="#credential-public-key" id="ref-for-credential-public-key-6">credential public key</a>.</p>
    <li data-md="">
     <p>The fields of the attestation structure <code class="idl"><a data-link-type="idl" href="#authenticationattestation" id="ref-for-authenticationattestation-3">AuthenticationAttestation</a></code>, including information about the attestation format used.</p>
   </ul>
   <h4 class="heading settled" data-level="5.1.2" id="op-get-assertion"><span class="secno">5.1.2. </span><span class="content">The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="authenticatorgetassertion">authenticatorGetAssertion</dfn> operation</span><a class="self-link" href="#op-get-assertion"></a></h4>
   <p>This operation must be invoked in an authenticator session which has no other operations in progress. It takes the following
input parameters:</p>
   <ul>
    <li data-md="">
     <p>The SHA-256 hash of the caller’s RP ID, as determined by the user agent and the client.</p>
    <li data-md="">
     <p>The <a data-link-type="dfn" href="#clientdatahash" id="ref-for-clientdatahash-8">clientDataHash</a>, which is the hash of the serialized <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-6">ClientData</a></code> and is provided by the client.</p>
    <li data-md="">
     <p>A list of credentials acceptable to the Relying Party (possibly filtered by the client).</p>
    <li data-md="">
     <p>Extension data created by the client based on the extensions requested by the Relying Party.</p>
   </ul>
   <p>When this method is invoked, the authenticator must perform the following procedure:</p>
   <ul>
    <li data-md="">
     <p>Check if all the supplied parameters are syntactically well-formed and of the correct length. If not, return an error code
equivalent to UnknownError and terminate the operation.</p>
    <li data-md="">
     <p>If a list of credentials was supplied by the client, filter it by removing those credentials that are not present on this
authenticator. If no list was supplied, create a list with all credentials stored for the caller’s RP ID (as determined by
an exact match of the RP ID hash).</p>
    <li data-md="">
     <p>If the previous step resulted in an empty list, return an error code equivalent to NotAllowedError and terminate the
operation.</p>
    <li data-md="">
     <p>Prompt the user to select a credential from among the above list. Obtain user consent for using this credential. The prompt
for obtaining this consent may be shown by the authenticator if it has its own output capability, or by the user agent
otherwise.</p>
    <li data-md="">
     <p>Process all the supported extensions requested by the client, then generate a cryptographic signature using the private key of
the selected credential (as specified in <a href="#signature-format">§5.2 Signature Format</a>), and use it to construct an assertion.</p>
    <li data-md="">
     <p>If any error occurred while generating the assertion, return an error code equivalent to UnknownError and terminate the
operation.</p>
   </ul>
   <p>On successful completion, the authenticator must return to the user agent:</p>
   <ul>
    <li data-md="">
     <p>The identifier of the credential used to generate the signature.</p>
    <li data-md="">
     <p>The <a data-link-type="dfn" href="#authenticatordata" id="ref-for-authenticatordata-1">authenticatorData</a> used to generate the signature.</p>
    <li data-md="">
     <p>The signature itself.</p>
   </ul>
   <p>If the authenticator cannot find any credential corresponding to the specified Relying Party that matches the specified criteria, it
terminates the operation and returns an error.</p>
   <p>If the user refuses consent, the authenticator returns an appropriate error status to the client.</p>
   <h4 class="heading settled" data-level="5.1.3" id="op-cancel"><span class="secno">5.1.3. </span><span class="content">The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="authenticatorcancel">authenticatorCancel</dfn> operation</span><a class="self-link" href="#op-cancel"></a></h4>
   <p>This operation takes no input parameters and returns no result.</p>
   <p>When this operation is invoked by the client in an authenticator session, it has the effect of terminating any <a data-link-type="dfn" href="#authenticatormakecredential" id="ref-for-authenticatormakecredential-4">authenticatorMakeCredential</a> or <a data-link-type="dfn" href="#authenticatorgetassertion" id="ref-for-authenticatorgetassertion-4">authenticatorGetAssertion</a> operation currently in progress in that authenticator
session. The authenticator stops prompting for, or accepting, any user input related to authorizing the canceled operation. The
client ignores any further responses from the authenticator for the canceled operation.</p>
   <p>This operation is ignored if it is invoked in an authenticator session which does not have an <a data-link-type="dfn" href="#authenticatormakecredential" id="ref-for-authenticatormakecredential-5">authenticatorMakeCredential</a> or <a data-link-type="dfn" href="#authenticatorgetassertion" id="ref-for-authenticatorgetassertion-5">authenticatorGetAssertion</a> operation currently in progress.</p>
   <h3 class="heading settled" data-level="5.2" id="signature-format"><span class="secno">5.2. </span><span class="content">Signature Format</span><a class="self-link" href="#signature-format"></a></h3>
   <p>WebAuthn signatures are bound to various contextual data. These data are observed, and added at different levels of the stack as
a signature request passes from the server to the authenticator. In verifying a signature, the server checks these bindings
against expected values.</p>
   <p>The components of a system using WebAuthn can be divided into three layers:</p>
   <ol>
    <li data-md="">
     <p>The <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-19">Relying Party</a> (RP), which uses the WebAuthn services. The RP consists of a server component and a web-application running
in a browser.</p>
    <li data-md="">
     <p>The <a data-link-type="dfn" href="#webauthn-client" id="ref-for-webauthn-client-3">WebAuthn Client</a> platform, which consists of the User Agent and the OS and device on which it executes.</p>
    <li data-md="">
     <p>The <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-17">Authenticator</a> itself, which provides key management and cryptographic signatures. This may be embedded in the
WebAuthn client, or housed in a separate device entirely. In the latter case, the interface between the WebAuthn client and
the authenticator is a separately-defined protocol. The authenticator may itself contain a cryptographic module which
operates at a higher security level than the rest of the authenticator. This is particularly important for authenticators
that are embedded in the WebAuthn client, as in those cases this cryptographic module (which may, for example, be a TPM)
could be considered more trustworthy than the rest of the authenticator.</p>
   </ol>
   <p>This specification defines the common signature format shared by all the above layers. This includes how the different
contextual bindings are encoded, signed over, and delivered to the RP.</p>
   <p>The goals of this design can be summarized as follows.</p>
   <ul>
    <li data-md="">
     <p>The scheme for generating signatures should accommodate cases where the link between the client platform and authenticator
is very limited, in bandwidth and/or latency. Examples include Bluetooth Low Energy and Near-Field Communication.</p>
    <li data-md="">
     <p>The data processed by the authenticator should be small and easy to interpret in low-level code. In particular, authenticators
should not have to parse high-level encodings such as JSON.</p>
    <li data-md="">
     <p>Both the client platform and the authenticator should have the flexibility to add contextual bindings as needed.</p>
    <li data-md="">
     <p>The design aims to reuse as much as possible of existing encoding formats in order to aid adoption and implementation.</p>
   </ul>
   <p>The contextual bindings are divided in two: Those added by the RP or the client platform, referred to as client data; and those
added by the authenticator, referred to as the authenticator data. The client data must be signed over, but an authenticator is
otherwise not interested in its contents. To save bandwidth and processing requirements on the authenticator, the client
platform hashes the <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-7">ClientData</a></code> and sends only the result to the authenticator. The authenticator signs over the combination
of this <a data-link-type="dfn" href="#clientdatahash" id="ref-for-clientdatahash-9">clientDataHash</a>, and its own authenticator data.</p>
   <h4 class="heading settled" data-level="5.2.1" id="sec-authenticator-data"><span class="secno">5.2.1. </span><span class="content">Authenticator data</span><a class="self-link" href="#sec-authenticator-data"></a></h4>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="authenticator-data">authenticator data</dfn>, <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="authenticatordata">authenticatorData</dfn>, encodes contextual bindings made by the <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-18">authenticator</a> itself. These bindings are controlled by the authenticator itself, and derive their trust from the Relying Party’s assessment of the
security of the authenticator. In one extreme case, the authenticator may be embedded in the client, and its bindings may be no
more trustworthy than the <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-8">ClientData</a></code>. At the other extreme, the authenticator may be a discrete entity with high-security
hardware and software, connected to the client over a secure channel. In both cases, the Relying Party receives the authenticator data in
the same format, and uses its knowledge of the authenticator to make trust decisions.</p>
   <p>The authenticator data has a compact but extensible encoding. This is desired since authenticators can be devices with limited
capabilities and low power requirements, with much simpler software stacks than the client platform components.</p>
   <p>The encoding of authenticator data is a byte array of 37 bytes or more, as follows.</p>
   <table class="complex data longlastcol">
    <tbody>
     <tr>
      <th>Length (in bytes)
      <th>Description
     <tr>
      <td>32
      <td> SHA-256 hash of the RP ID associated with the credential. 
     <tr>
      <td>1
      <td>
        Flags (bit 0 is the least significant bit): 
       <ul>
        <li data-md="">
         <p>Bit 0: Test of User Presence (<code>TUP</code>) result.</p>
        <li data-md="">
         <p>Bits 1-5: Reserved for future use (<code>RFU</code>).</p>
        <li data-md="">
         <p>Bit 6: Attestation data included (<code>AT</code>). Indicates whether the authenticator added attestation data.</p>
        <li data-md="">
         <p>Bit 7: Extension data included (<code>ED</code>). Indicates if the authenticator data has extensions.</p>
       </ul>
     <tr>
      <td>4
      <td>Signature counter (<code>signCount</code>), 32-bit unsigned big-endian integer.
     <tr>
      <td>variable (if present)
      <td> Attestation data (if present). See <a href="#generating-an-attestation-statement">§5.3.3 Generating an Attestation Statement</a> for details. Its length n depends on the
            length of the <a data-link-type="dfn" href="#credential-public-key" id="ref-for-credential-public-key-7">credential public key</a> and credential ID being attested. 
     <tr>
      <td>variable (if present)
      <td> Extension-defined authenticator data. This is a CBOR <a data-link-type="biblio" href="#biblio-rfc7049">[RFC7049]</a> map with extension identifiers as keys, and
            extension authenticator data values as values. See <a href="#extensions">§7 WebAuthn Extensions</a> for details. 
   </table>
   <p>The RP ID hash is originally received from the client when the credential is created, and again when an assertion is generated.
However, it differs from other client data in some important ways. First, unlike the client data, the RP ID of a credential does
not change between operations but instead remains the same for the lifetime of that credential. Secondly, it is validated by the
authenticator during the <a data-link-type="dfn" href="#authenticatorgetassertion" id="ref-for-authenticatorgetassertion-6">authenticatorGetAssertion</a> operation, by making sure that the RP ID hash associated with the
requested credential exactly matches the RP ID hash supplied by the client. These differences also explain why the RP ID hash is
always a SHA-256 hash instead of being crypto-agile like the <a data-link-type="dfn" href="#clientdatahash" id="ref-for-clientdatahash-10">clientDataHash</a>; for a given RP ID, we need the hash to be
computed the same way by all clients for all operations so that authenticators can roam among clients without losing
interoperability.</p>
   <p>The <code>TUP</code> flag SHALL be set if and only if the authenticator detected a user through an authenticator specific gesture. The <code>RFU</code> bits in the flags byte SHALL be set to zero.</p>
   <p>For attestation signatures, the authenticator MUST set the AT flag and include the attestation data. For authentication
signatures, the AT flag MUST NOT be set and the attestation data MUST NOT be included.</p>
   <p>If the authenticator does not include any extension data, it MUST set the <code>ED</code> flag in the first byte to zero, and to one if
extension data is included.</p>
   <p>The figure below shows a visual representation of the authenticator data structure.</p>
   <figure>
     <img src="images/fido-signature-formats-figure1.svg"> 
    <figcaption><a data-link-type="dfn" href="#authenticatordata" id="ref-for-authenticatordata-2">authenticatorData</a> layout.</figcaption>
   </figure>
   <p>Note that the <a data-link-type="dfn" href="#authenticatordata" id="ref-for-authenticatordata-3">authenticatorData</a> describes its own length: If the AT and ED flags are not set, it is always 37 bytes long.
The attestation data (which is only present if the AT flag is set) describes its own length. If the ED flag is set, then the
total length is 37 bytes plus the length of the attestation data, plus the length of the CBOR map that follows.</p>
   <h4 class="heading settled" data-level="5.2.2" id="authenticator-signature"><span class="secno">5.2.2. </span><span class="content">Generating a signature</span><a class="self-link" href="#authenticator-signature"></a></h4>
   <p>A raw cryptographic signature must assert the integrity of both the client data and the authenticator data. Thus, an <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-19">authenticator</a> SHALL compute a signature over the concatenation of the <a data-link-type="dfn" href="#authenticatordata" id="ref-for-authenticatordata-4">authenticatorData</a> and the <a data-link-type="dfn" href="#clientdatahash" id="ref-for-clientdatahash-11">clientDataHash</a>.</p>
   <figure id="fig-signature">
     <img src="images/fido-signature-formats-figure2.svg"> 
    <figcaption>Generating a signature on the authenticator.</figcaption>
   </figure>
   <p>A simple, undelimited concatenation is safe to use here because the <a data-link-type="dfn" href="#authenticatordata" id="ref-for-authenticatordata-5">authenticatorData</a> describes its own length. The <a data-link-type="dfn" href="#clientdatahash" id="ref-for-clientdatahash-12">clientDataHash</a> (which potentially has a variable length) is always the last element.</p>
   <p>The authenticator MUST return both the <a data-link-type="dfn" href="#authenticatordata" id="ref-for-authenticatordata-6">authenticatorData</a> and the raw signature back to the client. The client, in turn,
MUST return <a data-link-type="dfn" href="#clientdatajson" id="ref-for-clientdatajson-7">clientDataJSON</a>, <a data-link-type="dfn" href="#authenticatordata" id="ref-for-authenticatordata-7">authenticatorData</a> and the signature to the RP. The first two are returned in the <code>clientData</code> and <code>authenticatorData</code> members respectively of the <code class="idl"><a data-link-type="idl" href="#authenticationassertion" id="ref-for-authenticationassertion-5">AuthenticationAssertion</a></code> and <code class="idl"><a data-link-type="idl" href="#authenticationattestation" id="ref-for-authenticationattestation-4">AuthenticationAttestation</a></code> structures.</p>
   <h4 class="heading settled" data-level="5.2.3" id="authenticator-signature-verification"><span class="secno">5.2.3. </span><span class="content">Verifying a signature</span><a class="self-link" href="#authenticator-signature-verification"></a></h4>
   <p>This section specifies the algorithm for verifying a signature assertion.</p>
   <p>Upon receiving a signature assertion in the form of a <code class="idl"><a data-link-type="idl" href="#authenticationassertion" id="ref-for-authenticationassertion-6">AuthenticationAssertion</a></code> structure, the Relying Party shall:</p>
   <ol>
    <li data-md="">
     <p>Perform JSON decoding to extract the <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-9">ClientData</a></code> used for the assertion from the <code class="idl"><a data-link-type="idl" href="#dom-authenticationassertion-clientdata" id="ref-for-dom-authenticationassertion-clientdata-1">clientData</a></code>.</p>
    <li data-md="">
     <p>Verify that the <code class="idl"><a data-link-type="idl" href="#dom-clientdata-challenge" id="ref-for-dom-clientdata-challenge-1">challenge</a></code> in the <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-10">ClientData</a></code> matches the challenge that was sent to the authenticator.</p>
    <li data-md="">
     <p>Verify that the <code class="idl"><a data-link-type="idl" href="#dom-clientdata-origin" id="ref-for-dom-clientdata-origin-1">origin</a></code> in the <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-11">ClientData</a></code> matches the Relying Party’s origin.</p>
    <li data-md="">
     <p>Verify that the <code class="idl"><a data-link-type="idl" href="#dom-clientdata-tokenbinding" id="ref-for-dom-clientdata-tokenbinding-1">tokenBinding</a></code> (if present) in the <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-12">ClientData</a></code> matches the token
binding public key for the TLS connection
over which the attestation was obtained.</p>
    <li data-md="">
     <p>Verify that the <code class="idl"><a data-link-type="idl" href="#dom-clientdata-extensions" id="ref-for-dom-clientdata-extensions-1">extensions</a></code> in the <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-13">ClientData</a></code> is a proper subset of the extensions requested by the RP.</p>
    <li data-md="">
     <p>Verify that the RP ID hash in the <code class="idl"><a data-link-type="idl" href="#dom-authenticationassertion-authenticatordata" id="ref-for-dom-authenticationassertion-authenticatordata-1">authenticatorData</a></code> is indeed the SHA-256 hash of the RP ID expected
by the RP.</p>
    <li data-md="">
     <p>Compute the <a data-link-type="dfn" href="#clientdatahash" id="ref-for-clientdatahash-13">clientDataHash</a>, i.e. hash of <code class="idl"><a data-link-type="idl" href="#dom-authenticationassertion-clientdata" id="ref-for-dom-authenticationassertion-clientdata-2">clientData</a></code>.</p>
    <li data-md="">
     <p>Look up the previously registered public key associated with the credential (see <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential" id="ref-for-dom-webauthentication-makecredential-4">makeCredential()</a></code>) and
verify the signature in <code class="idl"><a data-link-type="idl" href="#dom-authenticationassertion-signature" id="ref-for-dom-authenticationassertion-signature-1">signature</a></code> computed over the
binary concatenation of <code class="idl"><a data-link-type="idl" href="#dom-authenticationassertion-authenticatordata" id="ref-for-dom-authenticationassertion-authenticatordata-2">authenticatorData</a></code> and <a data-link-type="dfn" href="#clientdatahash" id="ref-for-clientdatahash-14">clientDataHash</a>.</p>
   </ol>
   <p>If all the above steps succeed, then the signature is valid, otherwise it is invalid.</p>
   <h3 class="heading settled" data-level="5.3" id="cred-attestation-stmts"><span class="secno">5.3. </span><span class="content">Credential Attestation Statements</span><a class="self-link" href="#cred-attestation-stmts"></a></h3>
   <p>A credential attestation statement is a specific type of signed data object, containing statements about a credential itself and
the authenticator that created it. It is created using the process described in <a href="#signature-format">§5.2 Signature Format</a>, with the important
difference that the signature is generated not using the private key associated with the credential but using the key of the
attesting authority (except for the case of <a data-link-type="dfn" href="#self-attestation" id="ref-for-self-attestation-7">self attestation</a>). In order to correctly interpret an attestation statement,
a <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-20">Relying Party</a> needs to understand two aspects of the attestation:</p>
   <ol>
    <li data-md="">
     <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="attestation-format">attestation format</dfn> is the manner in which the signature is represented and the various contextual bindings are
incorporated into the attestation statement by the <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-20">authenticator</a>. In other words, this defines the syntax of the
statement. Various existing devices and platforms (such as TPMs and the Android OS) have previously defined attestation
formats. This specification supports a variety of such formats in an extensible way, as defined in <a href="#attestation-formats">§5.3.1 Attestation Formats</a>.</p>
    <li data-md="">
     <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="attestation-type">attestation type</dfn> defines the semantics of the attestation statement and its underlying trust model. It defines
how a Relying Party establishes trust in a particular attestation statement, after verifying that it is cryptographically valid.</p>
   </ol>
   <p>In general, there is no simple mapping between attestation formats and attestation types. For example the "packed" attestation
format defined in <a href="#packed-attestation">§6.2 Packed Attestation Format</a> can be used in conjunction with all attestation types, while other formats and types
have more limited applicability.</p>
   <p>The privacy, security and operational characteristics of attestation depend on:</p>
   <ul>
    <li data-md="">
     <p>The attestation type, which determines the trust model,</p>
    <li data-md="">
     <p>The attestation format, which may constrain the strength of the attestation by limiting what can be expressed in an
attestation statement, and</p>
    <li data-md="">
     <p>The characteristics of the individual authenticator, such as its construction, whether part or all of it runs in a secure
operating environment, and so on.</p>
   </ul>
   <p>It is expected that most authenticators will support a small number of attestation types and formats, while Relying Parties will decide
what attestation types are acceptable to them by policy. Relying Parties will also need to understand the characteristics of the
authenticators that they trust, based on information they have about these authenticators. For example, the FIDO Metadata
Service <a data-link-type="biblio" href="#biblio-fidometadataservice">[FIDOMetadataService]</a> provides one way to access such information.</p>
   <h4 class="heading settled" data-level="5.3.1" id="attestation-formats"><span class="secno">5.3.1. </span><span class="content">Attestation Formats</span><a class="self-link" href="#attestation-formats"></a></h4>
   <p>As described above, an attestation format is a data format which represents a cryptographic signature by an authenticator over a
set of contextual bindings. Each attestation format is defined by the following attributes:</p>
   <ul>
    <li data-md="">
     <p>The name of the format, used to identify it in a <code class="idl"><a data-link-type="idl" href="#authenticationattestation" id="ref-for-authenticationattestation-5">AuthenticationAttestation</a></code> structure. This MUST be an ASCII string, and MUST
NOT be an <a data-link-type="dfn" href="#ascii-case-insensitive-match" id="ref-for-ascii-case-insensitive-match-1">ASCII case-insensitive match</a> for the name of any other attestation format.</p>
    <li data-md="">
     <p>The set of attestation types supported by the format.</p>
    <li data-md="">
     <p>The syntax of an attestation statement produced in this format.</p>
    <li data-md="">
     <p>The procedure for computing an attestation statement in this format given the <a data-link-type="dfn" href="#atttobesigned" id="ref-for-atttobesigned-1">attToBeSigned</a> for the attestation,
created as per <a href="#generating-an-attestation-statement">§5.3.3 Generating an Attestation Statement</a>.</p>
    <li data-md="">
     <p>The procedure for verifying an attestation statement, takes the following inputs:</p>
     <ul>
      <li data-md="">
       <p>The <a data-link-type="dfn" href="#authenticator-data" id="ref-for-authenticator-data-1">authenticator data</a> claimed to have been used for the attestation,</p>
      <li data-md="">
       <p>The <a data-link-type="dfn" href="#clientdatahash" id="ref-for-clientdatahash-15">clientDataHash</a> of the client’s contextual bindings,</p>
      <li data-md="">
       <p>A trust anchor (a root certificate, a DAA root key, or the <a data-link-type="dfn" href="#credential-public-key" id="ref-for-credential-public-key-8">credential public key</a> itself),</p>
     </ul>
     <p>and returns a Boolean value indicating whether the attestation is cryptographically valid, and if so the attestation type.</p>
   </ul>
   <p>The initial list of supported formats is in <a href="#defined-attestation-formats">§6 Defined Attestation Formats</a>.</p>
   <h4 class="heading settled" data-level="5.3.2" id="sctn-attestation-types"><span class="secno">5.3.2. </span><span class="content">Attestation Types</span><a class="self-link" href="#sctn-attestation-types"></a></h4>
   <p>WebAuthn supports multiple attestation types:</p>
   <dl>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="basic-attestation">Basic Attestation</dfn></p>
    <dd data-md="">
     <p>In the case of basic attestation <a data-link-type="biblio" href="#biblio-uafprotocol">[UAFProtocol]</a>, the authenticator’s attestation key pair is specific to an
authenticator model.  Thus, authenticators of the same model often share the same attestation key pair. See <a href="#sec-attestation-privacy">§5.3.5.1 Privacy</a> for futher information.</p>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="self-attestation">Self Attestation</dfn></p>
    <dd data-md="">
     <p>In the case of self attestation, also known as surrogate basic attestation <a data-link-type="biblio" href="#biblio-uafprotocol">[UAFProtocol]</a>, the Authenticator doesn’t have
any specific attestation key. Instead it uses the authentication key itself to sign the attestation statement.
Authenticators without meaningful protection measures for an attestation private key typically use this attestation type.</p>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="privacy-ca">Privacy CA</dfn></p>
    <dd data-md="">
     <p>In this case, the Authenticator owns an authenticator-specific (endorsement) key. This key is used to securely communicate
with a trusted third party, the Privacy CA.  The Authenticator can generate multiple attestation key pairs and asks the
Privacy CA to issue an attestation certificate for it. Using this approach, the Authenticator can limit the exposure of the
endorsement key (which is a global correlation handle) to Privacy CA(s). Attestation keys can be requested for each scoped
credential individually.</p>
     <p class="note" role="note">Note: This concept typically leads to multiple attestation certificates. The attestation certificate requested most recently
    is called "active".</p>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="direct-anonymous-attestation">Direct Anonymous Attestation</dfn> (DAA)</p>
    <dd data-md="">
     <p>In this case, the Authenticator receives DAA credentials from a single DAA-Issuer. These DAA credentials are used along with
blinding to sign the attestation data. The concept of blinding avoids the DAA credentials being misused as global
correlation handle. WebAuthn supports DAA using elliptic curve cryptography and bilinear pairings, called ECDAA (see <a data-link-type="biblio" href="#biblio-fidoecdaaalgorithm">[FIDOEcdaaAlgorithm]</a>) in this specification.</p>
   </dl>
   <h4 class="heading settled" data-level="5.3.3" id="generating-an-attestation-statement"><span class="secno">5.3.3. </span><span class="content">Generating an Attestation Statement</span><a class="self-link" href="#generating-an-attestation-statement"></a></h4>
   <p>This section specifies the algorithm for generating an attestation statement, independent of <a data-link-type="dfn" href="#attestation-format" id="ref-for-attestation-format-3">attestation format</a>.</p>
   <p>When requested to generate an attestation statement for a given credential using a particular <a data-link-type="dfn" href="#attestation-format" id="ref-for-attestation-format-4">attestation format</a>, the
authenticator MUST first generate an <a data-link-type="dfn" href="#authenticatordata" id="ref-for-authenticatordata-8">authenticatorData</a> structure, with the attestation data field populated as follows:</p>
   <table class="complex data longlastcol">
    <tbody>
     <tr>
      <th>Length (in bytes)
      <th>Description
     <tr>
      <td>16
      <td>The AAGUID of the authenticator.
     <tr>
      <td>2
      <td>Byte length l of Credential ID
     <tr>
      <td>(length)
      <td>Credential ID (l bytes)
     <tr>
      <td>2
      <td>
        Public key algorithm and encoding (16-bit big-endian value). Allowed values are: 
       <ol>
        <li data-md="">
         <p>0x0100. This is raw ANSI X9.62 formatted Elliptic Curve public key <a data-link-type="biblio" href="#biblio-sec1">[SEC1]</a>, i.e., <code>[0x04, X (n bytes), Y (n bytes)]</code>, where the byte <code>0x04</code> denotes the uncompressed point compression method and
n denotes the key length in bytes.</p>
        <li data-md="">
         <p>0x0102.  Raw encoded RSA PKCS1 or RSASSA-PSS public key <a data-link-type="biblio" href="#biblio-rfc3447">[RFC3447]</a>. In the case of RSASSA-PSS, the default
parameters according to <a data-link-type="biblio" href="#biblio-rfc4055">[RFC4055]</a> MUST be assumed, i.e.,</p>
         <ul>
          <li data-md="">
           <p>Mask Generation Algorithm MGF1 with SHA256</p>
          <li data-md="">
           <p>Salt Length of 32 bytes, i.e., the length of a SHA256 hash value.</p>
          <li data-md="">
           <p>Trailer Field value of 1, which represents the trailer field with hexadecimal value <code>0xBC</code>.</p>
         </ul>
         <p>That is, <code>[modulus (256 bytes), e (m-n bytes)]</code>, where <code>m</code> is the total length of the field. This total length
should be taken from the object containing this key</p>
       </ol>
     <tr>
      <td>2
      <td>Byte length m of following <a data-link-type="dfn" href="#credential-public-key" id="ref-for-credential-public-key-9">credential public key</a> bytes (16 bit value with most significant byte first).
     <tr>
      <td>(length)
      <td>The <a data-link-type="dfn" href="#credential-public-key" id="ref-for-credential-public-key-10">credential public key</a> (m bytes) according to the encoding denoted before.
   </table>
   <p>The authenticator MUST then concatenate this <a data-link-type="dfn" href="#authenticatordata" id="ref-for-authenticatordata-9">authenticatorData</a> and the client-supplied <a data-link-type="dfn" href="#clientdatahash" id="ref-for-clientdatahash-16">clientDataHash</a> as specified
in <a href="#authenticator-signature">§5.2.2 Generating a signature</a> to form <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="atttobesigned">attToBeSigned</dfn>. It must then run the signing procedure for the desired
attestation format, with <a data-link-type="dfn" href="#atttobesigned" id="ref-for-atttobesigned-2">attToBeSigned</a> as input.</p>
   <h4 class="heading settled" data-level="5.3.4" id="verifying-an-attestation-statement"><span class="secno">5.3.4. </span><span class="content">Verifying an Attestation Statement</span><a class="self-link" href="#verifying-an-attestation-statement"></a></h4>
   <p>This section specifies the algorithm for verifying an attestation statement, independent of attestation format.</p>
   <p>Upon receiving an attestation statement in the form of a <code class="idl"><a data-link-type="idl" href="#authenticationattestation" id="ref-for-authenticationattestation-6">AuthenticationAttestation</a></code> structure, the Relying Party shall:</p>
   <ol>
    <li data-md="">
     <p>Perform JSON decoding to extract the <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-14">ClientData</a></code> used for the attestation from the <code class="idl"><a data-link-type="idl" href="#dom-authenticationattestation-clientdata" id="ref-for-dom-authenticationattestation-clientdata-1">clientData</a></code>.</p>
    <li data-md="">
     <p>Verify that the <code class="idl"><a data-link-type="idl" href="#dom-clientdata-challenge" id="ref-for-dom-clientdata-challenge-2">challenge</a></code> in the <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-15">ClientData</a></code> matches the challenge that was sent to the authenticator.</p>
    <li data-md="">
     <p>Verify that the <code class="idl"><a data-link-type="idl" href="#dom-clientdata-origin" id="ref-for-dom-clientdata-origin-2">origin</a></code> in the <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-16">ClientData</a></code> matches the Relying Party’s origin.</p>
    <li data-md="">
     <p>Verify that the <code class="idl"><a data-link-type="idl" href="#dom-clientdata-tokenbinding" id="ref-for-dom-clientdata-tokenbinding-2">tokenBinding</a></code> in the <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-17">ClientData</a></code> matches the token binding ID for the TLS connection
over which the attestation was obtained.</p>
    <li data-md="">
     <p>Verify that the <code class="idl"><a data-link-type="idl" href="#dom-clientdata-extensions" id="ref-for-dom-clientdata-extensions-2">extensions</a></code> in the <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-18">ClientData</a></code> is a proper subset of the extensions requested by the RP.</p>
    <li data-md="">
     <p>Verify that the RP ID hash in the <code class="idl"><a data-link-type="idl" href="#dom-authenticationattestation-authenticatordata" id="ref-for-dom-authenticationattestation-authenticatordata-1">authenticatorData</a></code> is indeed the SHA-256 hash of the RP ID expected
by the RP.</p>
    <li data-md="">
     <p>Perform an <a data-link-type="dfn" href="#ascii-case-insensitive-match" id="ref-for-ascii-case-insensitive-match-2">ASCII case-insensitive match</a> on <code class="idl"><a data-link-type="idl" href="#dom-authenticationattestation-format" id="ref-for-dom-authenticationattestation-format-1">format</a></code> to determine the attestation format.</p>
    <li data-md="">
     <p>Look up the attestation root certificate or DAA root key from a trusted source. For example, the FIDO Metadata Service <a data-link-type="biblio" href="#biblio-fidometadataservice">[FIDOMetadataService]</a> provides one way to access such information. The AAGUID in the <code class="idl"><a data-link-type="idl" href="#dom-authenticationassertion-authenticatordata" id="ref-for-dom-authenticationassertion-authenticatordata-3">authenticatorData</a></code> can be used for this lookup.</p>
    <li data-md="">
     <p>Using the verification process for the above attestation format, validate that the attestation <code class="idl"><a data-link-type="idl" href="#dom-authenticationattestation-attestation" id="ref-for-dom-authenticationattestation-attestation-1">attestation</a></code> is valid for the given <code class="idl"><a data-link-type="idl" href="#dom-authenticationattestation-authenticatordata" id="ref-for-dom-authenticationattestation-authenticatordata-2">authenticatorData</a></code>, <code class="idl"><a data-link-type="idl" href="#dom-authenticationattestation-clientdata" id="ref-for-dom-authenticationattestation-clientdata-2">clientData</a></code> and the above trust anchor.</p>
   </ol>
   <p>The Relying Party MAY take any of the below actions when verification of an attestation statement fails, according to its policy:</p>
   <ul>
    <li data-md="">
     <p>Reject the request, such as a registration request, associated with the attestation statement.</p>
    <li data-md="">
     <p>Accept the request associated with the attestation statement but treat the attested Scoped Credential as one with self
attestation (see <a href="#sctn-attestation-types">§5.3.2 Attestation Types</a>). If doing so, the Relying Party is asserting there is no cryptographic proof that the
Scoped Credential has been generated by a particular Authenticator model. See <a data-link-type="biblio" href="#biblio-fidosecref">[FIDOSecRef]</a> and <a data-link-type="biblio" href="#biblio-uafprotocol">[UAFProtocol]</a> for a more
detailed discussion.</p>
   </ul>
   <p>Verification of attestation statements requires that the Relying Party has a trusted method of determining the trust anchor in Step 8
above. Also, if certificates are being used, the Relying Party must have access to certificate status information for the intermediate
CA certificates. The Relying Party must also be able to build the attestation certificate chain if the client didn’t provide
this chain in the attestation information.</p>
   <h4 class="heading settled" data-level="5.3.5" id="sec-attestation-security-considerations"><span class="secno">5.3.5. </span><span class="content">Security Considerations</span><a class="self-link" href="#sec-attestation-security-considerations"></a></h4>
   <h5 class="heading settled" data-level="5.3.5.1" id="sec-attestation-privacy"><span class="secno">5.3.5.1. </span><span class="content">Privacy</span><a class="self-link" href="#sec-attestation-privacy"></a></h5>
   <p>Attestation keys may be used to track users or link various online identities of the same user together. This may be mitigated
in several ways, including:</p>
   <ul>
    <li data-md="">
     <p>A WebAuthn <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-21">Authenticator</a> manufacturer may choose to ship all of their devices with the same (or a fixed number of)
attestation key(s) (called <a data-link-type="dfn" href="#basic-attestation" id="ref-for-basic-attestation-1">Basic Attestation</a>). This will anonymize the user at the risk of not being able to revoke a
particular attestation key should its WebAuthn Authenticator be compromised.</p>
    <li data-md="">
     <p>A WebAuthn Authenticator may be capable of dynamically generating different attestation keys (and requesting related
certificates) per origin (following the <a data-link-type="dfn" href="#privacy-ca" id="ref-for-privacy-ca-1">Privacy CA</a> approach). For example, a WebAuthn Authenticator can ship with a
master attestation key (and certificate), and combined with a cloud operated privacy CA, can dynamically generate per origin
attestation keys and attestation certificates.</p>
    <li data-md="">
     <p>A WebAuthn Authenticator can implement <a data-link-type="dfn" href="#direct-anonymous-attestation" id="ref-for-direct-anonymous-attestation-1">direct anonymous attestation</a> (see <a data-link-type="biblio" href="#biblio-fidoecdaaalgorithm">[FIDOEcdaaAlgorithm]</a>).  Using this scheme,
the authenticator generates a blinded attestation signature.  This allows the Relying Party to verify the signature using the DAA
root key, but the attestation signature doesn’t serve as a global correlation handle.</p>
   </ul>
   <h5 class="heading settled" data-level="5.3.5.2" id="ca-compromise"><span class="secno">5.3.5.2. </span><span class="content">Attestation Certificate and Attestation Certificate CA Compromise</span><a class="self-link" href="#ca-compromise"></a></h5>
   <p>When an intermediate CA or a root CA used for issuing attestation certificates is compromised, WebAuthn <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-22">Authenticator</a> attestation keys are still safe although their certificates can no longer be trusted. A WebAuthn Authenticator manufacturer that
has recorded the public attestation keys for their devices can issue new attestation certificates for these keys from a new
intermediate CA or from a new root CA. If the root CA changes, the Relying Parties must update their trusted root certificates
accordingly.</p>
   <p>A WebAuthn Authenticator attestation certificate must be revoked by the issuing CA if its key has been compromised. A WebAuthn
Authenticator manufacturer may need to ship a firmware update and inject new attestation keys and certificates into already
manufactured WebAuthn Authenticators, if the exposure was due to a firmware flaw. (The process by which this happens is out of
scope for this specification.) If the WebAuthn Authenticator manufacturer does not have this capability, then it may not be
possible for Relying Parties to trust any further valid attestation statements from the affected WebAuthn Authenticators.</p>
   <p>If attestation certificate validation fails due to a revoked intermediate attestation CA certificate, and the Relying Party’s policy
requires rejecting the registration/authentication request in these situations, then it is recommended that the Relying Party also
un-registers (or marks with a trust level equivalent to "<a data-link-type="dfn" href="#self-attestation" id="ref-for-self-attestation-8">self attestation</a>") scoped credentials that were registered after
the CA compromise date using an attestation certificate chaining up to the same intermediate CA. It is thus recommended that
Relying Parties remember intermediate attestation CA certificates during Authenticator registration in order to un-register related Scoped
Credentials if the registration was performed after revocation of such certificates.</p>
   <p>If a DAA attestation key has been compromised, it can be added to the RogueList (i.e., the list of revoked authenticators)
maintained by the related DAA-Issuer. The Relying Party should verify whether an authenticator belongs to the RogueList when performing
DAA-Verify. For example, the FIDO Metadata Service <a data-link-type="biblio" href="#biblio-fidometadataservice">[FIDOMetadataService]</a> provides one way to access such information.</p>
   <h5 class="heading settled" data-level="5.3.5.3" id="cert-hierarchy"><span class="secno">5.3.5.3. </span><span class="content">Attestation Certificate Hierarchy</span><a class="self-link" href="#cert-hierarchy"></a></h5>
   <p>A 3-tier hierarchy for attestation certificates is recommended (i.e., Attestation Root, Attestation Issuing CA, Attestation
Certificate). It is also recommended that for each WebAuthn Authenticator device line (i.e., model), a separate issuing CA is
used to help facilitate isolating problems with a specific version of a device.</p>
   <p>If the attestation root certificate is not dedicated to a single WebAuthn Authenticator device line (i.e., AAGUID), the AAGUID
should be specified in the attestation certificate itself, so that it can be verified against the <a data-link-type="dfn" href="#authenticatordata" id="ref-for-authenticatordata-10">authenticatorData</a>.</p>
   <h2 class="heading settled" data-level="6" id="defined-attestation-formats"><span class="secno">6. </span><span class="content">Defined Attestation Formats</span><a class="self-link" href="#defined-attestation-formats"></a></h2>
   <p>WebAuthn supports pluggable attestation data formats. This section defines an initial set of such formats.</p>
   <h3 class="heading settled" data-level="6.1" id="sctn-attstn-fmt-ids"><span class="secno">6.1. </span><span class="content">Attestation Format Identifiers</span><a class="self-link" href="#sctn-attstn-fmt-ids"></a></h3>
   <p>Attestation formats are identified by a string, called a <dfn data-dfn-type="dfn" data-noexport="" id="attestation-format-identifier">attestation format identifier<a class="self-link" href="#attestation-format-identifier"></a></dfn>, chosen by the attestation
format author.</p>
   <p>Attestation format identifiers SHOULD be registered per <a data-link-type="biblio" href="#biblio-webauthn-registries">[WebAuthn-Registries]</a> "Registries for Web Authentication (WebAuthn)".
All registered attestation format identifiers are unique amongst themselves as a matter of course.</p>
   <p>Unregistered attestation format identifiers SHOULD use reverse domain-name naming, using a domain
name registered by the attestation type developer, in order to assure uniqueness of the identifier.
All attestation format identifiers MUST be a maximum of 32 octets in length and MUST
consist only of printable USASCII characters, i.e., VCHAR as defined in <a data-link-type="biblio" href="#biblio-rfc5234">[RFC5234]</a> (note: this means attestation format
identifiers based on domain names MUST incorporate only LDH Labels <a data-link-type="biblio" href="#biblio-rfc5890">[RFC5890]</a>).
Implementations MUST match WebAuthn attestation format identifiers in a case-insensitive fashion.</p>
   <p>Attestation formats that may exist in multiple versions SHOULD include a version in their identifier. In effect, different
versions are thus treated as different extensions, e.g., <code>packed2</code> as a new version of the <code>packed</code> attestation format.</p>
   <p>The following sections present a set of currently-defined and registered attestation formats and their identifiers. See the
WebAuthn Attestation Format Identifier Registry defined in <a data-link-type="biblio" href="#biblio-webauthn-registries">[WebAuthn-Registries]</a> for an up-to-date list of registered WebAuthn
Attestation Formats.</p>
   <h3 class="heading settled" data-level="6.2" id="packed-attestation"><span class="secno">6.2. </span><span class="content">Packed Attestation Format</span><a class="self-link" href="#packed-attestation"></a></h3>
   <p>Packed attestation is a WebAuthn optimized format of attestation data. It uses a very compact but still extensible encoding
method. Encoding this format can even be implemented by <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-23">authenticators</a> with very limited resources (e.g., secure
elements).</p>
   <dl>
    <dt data-md="">
     <p>Attestation format identifier</p>
    <dd data-md="">
     <p>packed</p>
    <dt data-md="">
     <p>Attestation types supported</p>
    <dd data-md="">
     <p>All</p>
    <dt data-md="">
     <p>Syntax</p>
    <dd data-md="">
     <p>A Packed Attestation statement has the following format:</p>
<pre class="idl highlight def"><span class="kt">interface</span> <dfn class="nv idl-code" data-dfn-type="interface" data-export="" id="packedattestation">PackedAttestation<a class="self-link" href="#packedattestation"></a></dfn> {
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>   <dfn class="nv dfn-paneled idl-code" data-dfn-for="PackedAttestation" data-dfn-type="attribute" data-export="" data-readonly="" data-type="ArrayBuffer" id="dom-packedattestation-x5c">x5c</dfn>;
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>   <dfn class="nv dfn-paneled idl-code" data-dfn-for="PackedAttestation" data-dfn-type="attribute" data-export="" data-readonly="" data-type="ArrayBuffer" id="dom-packedattestation-daakey">daaKey</dfn>;
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">DOMString</span>     <dfn class="nv dfn-paneled idl-code" data-dfn-for="PackedAttestation" data-dfn-type="attribute" data-export="" data-readonly="" data-type="DOMString" id="dom-packedattestation-alg">alg</dfn>;
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>   <dfn class="nv dfn-paneled idl-code" data-dfn-for="PackedAttestation" data-dfn-type="attribute" data-export="" data-readonly="" data-type="ArrayBuffer" id="dom-packedattestation-signature">signature</dfn>;
};
</pre>
     <div>
       The <dfn data-dfn-for="PackedAttestation" data-dfn-type="dfn" data-noexport="" id="packedattestation-x5c">x5c<a class="self-link" href="#packedattestation-x5c"></a></dfn> attribute contains the attestation certificate and its certificate chain as described in <a data-link-type="biblio" href="#biblio-rfc7515">[RFC7515]</a> section 4.1.6. 
      <p>The <dfn data-dfn-for="PackedAttestation" data-dfn-type="dfn" data-noexport="" id="packedattestation-alg">alg<a class="self-link" href="#packedattestation-alg"></a></dfn> element contains the name of the algorithm used to generate the attestation signature according to <a data-link-type="biblio" href="#biblio-rfc7518">[RFC7518]</a> section 3.1. The following algorithms are supported:</p>
      <ol>
       <li data-md="">
        <p>"ES256" <a data-link-type="biblio" href="#biblio-rfc7518">[RFC7518]</a></p>
       <li data-md="">
        <p>"RS256" <a data-link-type="biblio" href="#biblio-rfc7518">[RFC7518]</a></p>
       <li data-md="">
        <p>"PS256" <a data-link-type="biblio" href="#biblio-rfc7518">[RFC7518]</a></p>
       <li data-md="">
        <p>"ED256" <a data-link-type="biblio" href="#biblio-fidoecdaaalgorithm">[FIDOEcdaaAlgorithm]</a></p>
       <li data-md="">
        <p>"ED512" <a data-link-type="biblio" href="#biblio-fidoecdaaalgorithm">[FIDOEcdaaAlgorithm]</a></p>
      </ol>
      <p>The <dfn data-dfn-for="PackedAttestation" data-dfn-type="dfn" data-noexport="" id="packedattestation-signature">signature<a class="self-link" href="#packedattestation-signature"></a></dfn> element contains the attestation signature.</p>
     </div>
    <dt data-md="">
     <p>Signing procedure</p>
    <dd data-md="">
     <p>The authenticator signs the <a data-link-type="dfn" href="#atttobesigned" id="ref-for-atttobesigned-3">attToBeSigned</a> using the attestation private key.</p>
    <dt data-md="">
     <p>Verification procedure</p>
    <dd data-md="">
     <p>If <code class="idl"><a data-link-type="idl" href="#dom-packedattestation-x5c" id="ref-for-dom-packedattestation-x5c-1">x5c</a></code> is present, this indicates that the attestation type is not DAA. In this case:</p>
     <ul>
      <li data-md="">
       <p>Verify the <code class="idl"><a data-link-type="idl" href="#dom-packedattestation-signature" id="ref-for-dom-packedattestation-signature-1">signature</a></code> using the attestation public key in <code class="idl"><a data-link-type="idl" href="#dom-packedattestation-x5c" id="ref-for-dom-packedattestation-x5c-2">x5c</a></code> with the
algorithm specified in <code class="idl"><a data-link-type="idl" href="#dom-packedattestation-alg" id="ref-for-dom-packedattestation-alg-1">alg</a></code>.</p>
      <li data-md="">
       <p>Verify that <code class="idl"><a data-link-type="idl" href="#dom-packedattestation-x5c" id="ref-for-dom-packedattestation-x5c-3">x5c</a></code> correctly chains to the trust anchor provided.</p>
      <li data-md="">
       <p>Verify that <code class="idl"><a data-link-type="idl" href="#dom-packedattestation-x5c" id="ref-for-dom-packedattestation-x5c-4">x5c</a></code> meets the requirements in <a href="#packed-attestation-cert-requirements">§6.2.1 Packed attestation statement certificate requirements</a>.</p>
     </ul>
     <p>If <code class="idl"><a data-link-type="idl" href="#dom-packedattestation-daakey" id="ref-for-dom-packedattestation-daakey-1">daaKey</a></code> is present, then the attestation type is DAA. In this case:</p>
     <ul>
      <li data-md="">
       <p>Verify that <code class="idl"><a data-link-type="idl" href="#dom-packedattestation-alg" id="ref-for-dom-packedattestation-alg-2">alg</a></code> is "ED256" or "ED512".</p>
      <li data-md="">
       <p>Perform DAA-Verify on <code class="idl"><a data-link-type="idl" href="#dom-packedattestation-signature" id="ref-for-dom-packedattestation-signature-2">signature</a></code> (see <a data-link-type="biblio" href="#biblio-fidoecdaaalgorithm">[FIDOEcdaaAlgorithm]</a>).</p>
      <li data-md="">
       <p>If <code class="idl"><a data-link-type="idl" href="#dom-packedattestation-x5c" id="ref-for-dom-packedattestation-x5c-5">x5c</a></code> contains an extension with OID <code>1 3 6 1 4 1 45724 1 1 4</code> (id-fido-gen-ce-aaguid) verify that
the value of this extension matches the AAGUID in the <code class="idl"><a data-link-type="idl" href="#dom-authenticationattestation-authenticatordata" id="ref-for-dom-authenticationattestation-authenticatordata-3">authenticatorData</a></code>.</p>
     </ul>
     <p>If neither <code class="idl"><a data-link-type="idl" href="#dom-packedattestation-x5c" id="ref-for-dom-packedattestation-x5c-6">x5c</a></code> nor <code class="idl"><a data-link-type="idl" href="#dom-packedattestation-daakey" id="ref-for-dom-packedattestation-daakey-2">daaKey</a></code> is present, self attestation is in use.</p>
     <ul>
      <li data-md="">
       <p>Verify the signature using the <a data-link-type="dfn" href="#credential-public-key" id="ref-for-credential-public-key-11">credential public key</a>.</p>
      <li data-md="">
       <p>Validate that <code class="idl"><a data-link-type="idl" href="#dom-packedattestation-alg" id="ref-for-dom-packedattestation-alg-3">alg</a></code> matches the algorithm in <code class="idl"><a data-link-type="idl" href="#dom-authenticationattestation-authenticatordata" id="ref-for-dom-authenticationattestation-authenticatordata-4">authenticatorData</a></code>.</p>
     </ul>
   </dl>
   <h4 class="heading settled" data-level="6.2.1" id="packed-attestation-cert-requirements"><span class="secno">6.2.1. </span><span class="content">Packed attestation statement certificate requirements</span><a class="self-link" href="#packed-attestation-cert-requirements"></a></h4>
   <p>The attestation certificate MUST have the following fields/extensions:</p>
   <ul>
    <li data-md="">
     <p>Version must be set to 3.</p>
    <li data-md="">
     <p>Subject field MUST be set to:</p>
     <dl>
      <dt data-md="">
       <p>Subject-C</p>
      <dd data-md="">
       <p>Country where the Authenticator vendor is incorporated</p>
      <dt data-md="">
       <p>Subject-O</p>
      <dd data-md="">
       <p>Legal name of the Authenticator vendor</p>
      <dt data-md="">
       <p>Subject-OU</p>
      <dd data-md="">
       <p>Authenticator Attestation</p>
      <dt data-md="">
       <p>Subject-CN</p>
      <dd data-md="">
       <p>No stipulation.</p>
     </dl>
    <li data-md="">
     <p>If the related attestation root certificate is used for multiple authenticator models, the Extension OID <code>1 3 6 1 4 1 45724 1 1 4</code> (id-fido-gen-ce-aaguid) MUST be present, containing the AAGUID as value.</p>
    <li data-md="">
     <p>The Basic Constraints extension MUST have the CA component set to false</p>
    <li data-md="">
     <p>An Authority Information Access (AIA) extension with entry <code>id-ad-ocsp</code> and a CRL Distribution Point extension <a data-link-type="biblio" href="#biblio-rfc5280">[RFC5280]</a> are both optional as the status of many attestation certificates is available through authenticator metadata services.
See, for example, the FIDO Metadata Service <a data-link-type="biblio" href="#biblio-fidometadataservice">[FIDOMetadataService]</a>.</p>
   </ul>
   <h3 class="heading settled" data-level="6.3" id="tpm-attestation"><span class="secno">6.3. </span><span class="content">TPM Attestation Format</span><a class="self-link" href="#tpm-attestation"></a></h3>
   <p>This attestation format is generally used by authenticators that use a Trusted Platform Model as their cryptographic engine.</p>
   <dl>
    <dt data-md="">
     <p>Attestation format identifier</p>
    <dd data-md="">
     <p>tpm</p>
    <dt data-md="">
     <p>Attestation types supported</p>
    <dd data-md="">
     <p>Privacy CA, DAA</p>
    <dt data-md="">
     <p>Syntax</p>
    <dd data-md="">
     <p>A TPM Attestation statement has the following format:</p>
<pre class="idl highlight def"><span class="kt">interface</span> <dfn class="nv idl-code" data-dfn-type="interface" data-export="" id="tpmattestation">TpmAttestation<a class="self-link" href="#tpmattestation"></a></dfn> {
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">DOMString</span>     <dfn class="nv dfn-paneled idl-code" data-dfn-for="TpmAttestation" data-dfn-type="attribute" data-export="" data-readonly="" data-type="DOMString" id="dom-tpmattestation-tpmversion">tpmVersion</dfn>;
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>   <dfn class="nv dfn-paneled idl-code" data-dfn-for="TpmAttestation" data-dfn-type="attribute" data-export="" data-readonly="" data-type="ArrayBuffer" id="dom-tpmattestation-x5c">x5c</dfn>;
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>   <dfn class="nv dfn-paneled idl-code" data-dfn-for="TpmAttestation" data-dfn-type="attribute" data-export="" data-readonly="" data-type="ArrayBuffer" id="dom-tpmattestation-daakey">daaKey</dfn>;
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>   <dfn class="nv dfn-paneled idl-code" data-dfn-for="TpmAttestation" data-dfn-type="attribute" data-export="" data-readonly="" data-type="ArrayBuffer" id="dom-tpmattestation-certifyinfo">certifyInfo</dfn>;
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">DOMString</span>     <dfn class="nv dfn-paneled idl-code" data-dfn-for="TpmAttestation" data-dfn-type="attribute" data-export="" data-readonly="" data-type="DOMString" id="dom-tpmattestation-alg">alg</dfn>;
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>   <dfn class="nv dfn-paneled idl-code" data-dfn-for="TpmAttestation" data-dfn-type="attribute" data-export="" data-readonly="" data-type="ArrayBuffer" id="dom-tpmattestation-signature">signature</dfn>;
};
</pre>
     <div>
       The <dfn data-dfn-for="TpmAttestation" data-dfn-type="dfn" data-noexport="" id="tpmattestation-tpmversion">tpmVersion<a class="self-link" href="#tpmattestation-tpmversion"></a></dfn> field contains the version of the TPM specification to which the signature conforms. Currently
    supported versions are "1.2" and "2.0". 
      <p>The <dfn data-dfn-for="TpmAttestation" data-dfn-type="dfn" data-noexport="" id="tpmattestation-x5c">x5c<a class="self-link" href="#tpmattestation-x5c"></a></dfn> attribute contains the attestation certificate and its certificate chain as described in <a data-link-type="biblio" href="#biblio-rfc7515">[RFC7515]</a> section 4.1.6. This will be an AIK certificate.</p>
      <p>The <dfn data-dfn-for="TpmAttestation" data-dfn-type="dfn" data-noexport="" id="tpmattestation-alg">alg<a class="self-link" href="#tpmattestation-alg"></a></dfn> element contains the name of the algorithm used to generate the attestation signature according to <a data-link-type="biblio" href="#biblio-rfc7518">[RFC7518]</a> section 3.1. The following algorithms are supported:</p>
      <ol>
       <li data-md="">
        <p>"RSA1_5" <a data-link-type="biblio" href="#biblio-rfc7518">[RFC7518]</a> (TPM v1.2 only)</p>
       <li data-md="">
        <p>"ES256" <a data-link-type="biblio" href="#biblio-rfc7518">[RFC7518]</a> (TPM v2.0 only)</p>
       <li data-md="">
        <p>"RS256" <a data-link-type="biblio" href="#biblio-rfc7518">[RFC7518]</a> (TPM v2.0 only)</p>
       <li data-md="">
        <p>"PS256" <a data-link-type="biblio" href="#biblio-rfc7518">[RFC7518]</a> (TPM v2.0 only)</p>
       <li data-md="">
        <p>"ED256" <a data-link-type="biblio" href="#biblio-fidoecdaaalgorithm">[FIDOEcdaaAlgorithm]</a> (TPM v2.0 only)</p>
       <li data-md="">
        <p>"ED512" <a data-link-type="biblio" href="#biblio-fidoecdaaalgorithm">[FIDOEcdaaAlgorithm]</a> (TPM v2.0 only)</p>
      </ol>
      <p>The <dfn data-dfn-for="TpmAttestation" data-dfn-type="dfn" data-noexport="" id="tpmattestation-signature">signature<a class="self-link" href="#tpmattestation-signature"></a></dfn> element contains the attestation signature.</p>
     </div>
    <dt data-md="">
     <p>Signing procedure</p>
    <dd data-md="">
     <p>If using TPM version 1.2, generate a signature using the procedure specified in <a data-link-type="biblio" href="#biblio-tpmv1-2-part3">[TPMv1-2-Part3]</a> Section 13.8 or
Section 13.9, using the attestation private key and setting the <code>antiReplay</code> parameter to the SHA-1 hash of attToBeSigned.</p>
     <p>If using TPM version 2.0, generate a signature using the procedure specified in <a data-link-type="biblio" href="#biblio-tpmv2-part3">[TPMv2-Part3]</a> Section 18.2, using the
attestation private key and setting the <code>qualifyingData</code> parameter to attToBeSigned.</p>
     <p>In both the above cases, return the certifyInfo output parameter along with the signature.</p>
    <dt data-md="">
     <p>Verification procedure</p>
    <dd data-md="">
     <p>If <code class="idl"><a data-link-type="idl" href="#dom-tpmattestation-x5c" id="ref-for-dom-tpmattestation-x5c-1">x5c</a></code> is present, this indicates that the attestation type is not DAA. In this case:</p>
     <ul>
      <li data-md="">
       <p>Verify the <code class="idl"><a data-link-type="idl" href="#dom-tpmattestation-signature" id="ref-for-dom-tpmattestation-signature-1">signature</a></code> is over the <code class="idl"><a data-link-type="idl" href="#dom-tpmattestation-certifyinfo" id="ref-for-dom-tpmattestation-certifyinfo-1">certifyInfo</a></code> using the attestation public key in <code class="idl"><a data-link-type="idl" href="#dom-tpmattestation-x5c" id="ref-for-dom-tpmattestation-x5c-2">x5c</a></code> with the algorithm specified in <code class="idl"><a data-link-type="idl" href="#dom-tpmattestation-alg" id="ref-for-dom-tpmattestation-alg-1">alg</a></code>.</p>
      <li data-md="">
       <p>If <code class="idl"><a data-link-type="idl" href="#dom-tpmattestation-tpmversion" id="ref-for-dom-tpmattestation-tpmversion-1">tpmVersion</a></code> is "1.2", verify that the <code class="idl"><a data-link-type="idl" href="#dom-tpmattestation-certifyinfo" id="ref-for-dom-tpmattestation-certifyinfo-2">certifyInfo</a></code> contains a TPM_CERTIFY_INFO
or TPM_CERTIFY_INFO2 structure with the <code>data</code> field set to the SHA-1 hash of the concatenation of <code class="idl"><a data-link-type="idl" href="#dom-authenticationattestation-authenticatordata" id="ref-for-dom-authenticationattestation-authenticatordata-5">authenticatorData</a></code> and <code class="idl"><a data-link-type="idl" href="#dom-authenticationattestation-clientdata" id="ref-for-dom-authenticationattestation-clientdata-3">clientData</a></code>.</p>
      <li data-md="">
       <p>If <code class="idl"><a data-link-type="idl" href="#dom-tpmattestation-tpmversion" id="ref-for-dom-tpmattestation-tpmversion-2">tpmVersion</a></code> is "2.0", verify that <code class="idl"><a data-link-type="idl" href="#dom-tpmattestation-certifyinfo" id="ref-for-dom-tpmattestation-certifyinfo-3">certifyInfo</a></code> is a TPMS_ATTEST structure with the <code>extraData</code> field set to the concatenation of <code class="idl"><a data-link-type="idl" href="#dom-authenticationattestation-authenticatordata" id="ref-for-dom-authenticationattestation-authenticatordata-6">authenticatorData</a></code> and <code class="idl"><a data-link-type="idl" href="#dom-authenticationattestation-clientdata" id="ref-for-dom-authenticationattestation-clientdata-4">clientData</a></code>.</p>
      <li data-md="">
       <p>Verify that <code class="idl"><a data-link-type="idl" href="#dom-tpmattestation-x5c" id="ref-for-dom-tpmattestation-x5c-3">x5c</a></code> correctly chains to the trust anchor provided.</p>
      <li data-md="">
       <p>Verify that <code class="idl"><a data-link-type="idl" href="#dom-tpmattestation-x5c" id="ref-for-dom-tpmattestation-x5c-4">x5c</a></code> meets the requirements in <a href="#tpm-cert-requirements">§6.3.1 TPM attestation statement certificate requirements</a>.</p>
     </ul>
     <p>If <code class="idl"><a data-link-type="idl" href="#dom-tpmattestation-daakey" id="ref-for-dom-tpmattestation-daakey-1">daaKey</a></code> is present, then the attestation type is DAA.</p>
     <ul>
      <li data-md="">
       <p>Verify that <code class="idl"><a data-link-type="idl" href="#dom-tpmattestation-alg" id="ref-for-dom-tpmattestation-alg-2">alg</a></code> is "ED256" or "ED512".</p>
      <li data-md="">
       <p>Perform DAA-Verify on <code class="idl"><a data-link-type="idl" href="#dom-tpmattestation-signature" id="ref-for-dom-tpmattestation-signature-2">signature</a></code> to verify that it is over the <code class="idl"><a data-link-type="idl" href="#dom-tpmattestation-certifyinfo" id="ref-for-dom-tpmattestation-certifyinfo-4">certifyInfo</a></code> (see <a data-link-type="biblio" href="#biblio-fidoecdaaalgorithm">[FIDOEcdaaAlgorithm]</a>).</p>
      <li data-md="">
       <p>Verify that <code class="idl"><a data-link-type="idl" href="#dom-tpmattestation-certifyinfo" id="ref-for-dom-tpmattestation-certifyinfo-5">certifyInfo</a></code> is a TPMS_ATTEST structure with the <code>extraData</code> field set to the concatenation
of <code class="idl"><a data-link-type="idl" href="#dom-authenticationattestation-authenticatordata" id="ref-for-dom-authenticationattestation-authenticatordata-7">authenticatorData</a></code> and <code class="idl"><a data-link-type="idl" href="#dom-authenticationattestation-clientdata" id="ref-for-dom-authenticationattestation-clientdata-5">clientData</a></code>.</p>
      <li data-md="">
       <p>If <code class="idl"><a data-link-type="idl" href="#dom-tpmattestation-x5c" id="ref-for-dom-tpmattestation-x5c-5">x5c</a></code> contains an extension with OID <code>1 3 6 1 4 1 45724 1 1 4</code> (id-fido-gen-ce-aaguid) verify that the
value of this extension matches the AAGUID in the <code class="idl"><a data-link-type="idl" href="#dom-authenticationattestation-authenticatordata" id="ref-for-dom-authenticationattestation-authenticatordata-8">authenticatorData</a></code>.</p>
     </ul>
   </dl>
   <h4 class="heading settled" data-level="6.3.1" id="tpm-cert-requirements"><span class="secno">6.3.1. </span><span class="content">TPM attestation statement certificate requirements</span><a class="self-link" href="#tpm-cert-requirements"></a></h4>
   <p>TPM <a data-link-type="dfn" href="#attestation-certificate" id="ref-for-attestation-certificate-3">attestation certificate</a> MUST have the following fields/extensions:</p>
   <ul>
    <li data-md="">
     <p>Version must be set to 3.</p>
    <li data-md="">
     <p>Subject field MUST be set to empty.</p>
    <li data-md="">
     <p>The Subject Alternative Name extension must be set as defined in <a data-link-type="biblio" href="#biblio-tpmv2-ek-profile">[TPMv2-EK-Profile]</a> section 3.2.9 if "version" equals 2 and <a data-link-type="biblio" href="#biblio-tpmv1-2-credential-profiles">[TPMv1-2-Credential-Profiles]</a> section 3.2.9 if "version" equals 1.</p>
    <li data-md="">
     <p>The Extended Key Usage extension MUST contain the
"joint-iso-itu-t(2) internationalorganizations(23) 133 tcg-kp(8) tcg-kp-AIKCertificate(3)" OID.</p>
    <li data-md="">
     <p>The Basic Constraints extension MUST have the CA component set to false</p>
    <li data-md="">
     <p>An Authority Information Access (AIA) extension with entry <code>id-ad-ocsp</code> and a CRL Distribution Point extension <a data-link-type="biblio" href="#biblio-rfc5280">[RFC5280]</a> are
both optional as the status of many attestation certificates is available through metadata services.
See, for example, the FIDO Metadata Service <a data-link-type="biblio" href="#biblio-fidometadataservice">[FIDOMetadataService]</a>.</p>
   </ul>
   <h3 class="heading settled" data-level="6.4" id="android-key-attestation"><span class="secno">6.4. </span><span class="content">Android Key Attestation Format</span><a class="self-link" href="#android-key-attestation"></a></h3>
   <p>When the <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-24">Authenticator</a> in question is a platform-provided Authenticator on the Android "N" or later platform, the
attestation statement is based on the <a href="https://developer.android.com/preview/api-overview.html#key_attestation">Android key attestation</a>. In these cases, the
attestation statement is produced by a component running in a secure operating environment, but the <a data-link-type="dfn" href="#authenticatordata" id="ref-for-authenticatordata-11">authenticatorData</a> is produced outside this environment. The Relying Party is expected to check that the contents of <a data-link-type="dfn" href="#authenticatordata" id="ref-for-authenticatordata-12">authenticatorData</a> are consistent
with the fields of the attestation certificate’s extension data.</p>
   <dl>
    <dt data-md="">
     <p>Attestation format identifier</p>
    <dd data-md="">
     <p>android-key</p>
    <dt data-md="">
     <p>Attestation types supported</p>
    <dd data-md="">
     <p>Basic</p>
    <dt data-md="">
     <p>Syntax</p>
    <dd data-md="">
     <p>An Android key Attestation statement has the following format:</p>
<pre class="idl highlight def">[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext">SecureContext</a>]
<span class="kt">interface</span> <dfn class="nv idl-code" data-dfn-type="interface" data-export="" id="androidkeyattestation">AndroidKeyAttestation<a class="self-link" href="#androidkeyattestation"></a></dfn> {
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>   <dfn class="nv dfn-paneled idl-code" data-dfn-for="AndroidKeyAttestation" data-dfn-type="attribute" data-export="" data-readonly="" data-type="ArrayBuffer" id="dom-androidkeyattestation-signature">signature</dfn>;
};
</pre>
     <div> The <dfn data-dfn-for="AndroidKeyAttestation" data-dfn-type="dfn" data-noexport="" id="androidkeyattestation-signature">signature<a class="self-link" href="#androidkeyattestation-signature"></a></dfn> field contains the Android attestation statement, which is a series of DER encoded X.509 certificates. See <a href="https://developer.android.com/training/articles/security-key-attestation.html">the Android developer documentation</a>. </div>
    <dt data-md="">
     <p>Signing procedure</p>
    <dd data-md="">
     <p>Request a Android Key Attestation (i.e., by calling "keyStore.getCertificateChain(myKeyUUID)") providing <a data-link-type="dfn" href="#atttobesigned" id="ref-for-atttobesigned-4">attToBeSigned</a> as the challenge value (e.g., by using
"[setAttestationChallenge]
(https://developer.android.com/reference/android/security/keystore/KeyGenParameterSpec.Builder.html#setAttestationChallenge(byte[]))" ), and set <code class="idl"><a data-link-type="idl" href="#dom-androidkeyattestation-signature" id="ref-for-dom-androidkeyattestation-signature-1">signature</a></code> to the returned value.</p>
    <dt data-md="">
     <p>Verification procedure</p>
    <dd data-md="">
     <p>Verification is performed as follows:</p>
     <ul>
      <li data-md="">
       <p>Verify that <code class="idl"><a data-link-type="idl" href="#dom-androidkeyattestation-signature" id="ref-for-dom-androidkeyattestation-signature-2">signature</a></code> is a valid certificate chain, consisting of a time-valid X.509 certificate
chaining up to a trusted attestation root key.</p>
      <li data-md="">
       <p>Verify that the public key in the first certificate, in the series of certificates represented by <code class="idl"><a data-link-type="idl" href="#dom-androidkeyattestation-signature" id="ref-for-dom-androidkeyattestation-signature-3">signature</a></code> matches the <a data-link-type="dfn" href="#credential-public-key" id="ref-for-credential-public-key-12">credential public key</a> in the attestation data field of the given <a data-link-type="dfn" href="#authenticatordata" id="ref-for-authenticatordata-13">authenticatorData</a>.</p>
      <li data-md="">
       <p>Verify that in the attestation certificate extension data:</p>
       <ul>
        <li data-md="">
         <p>The value of the <code>attestationChallenge</code> field is identical to <a data-link-type="dfn" href="#atttobesigned" id="ref-for-atttobesigned-5">attToBeSigned</a>.</p>
        <li data-md="">
         <p>The <code>AuthorizationList.allApplications</code> field is <em>not</em> present, since ScopedCredentials must be bound to the
RP ID.</p>
        <li data-md="">
         <p>The value in the <code>AuthorizationList.origin</code> field is equal to <code>KM_TAG_GENERATED</code>.</p>
        <li data-md="">
         <p>The value in the <code>AuthorizationList.purpose</code> field is equal to <code>KM_PURPOSE_SIGN</code>.</p>
       </ul>
     </ul>
   </dl>
   <h3 class="heading settled" data-level="6.5" id="android-safetynet-attestation"><span class="secno">6.5. </span><span class="content">Android SafetyNet Attestation Format</span><a class="self-link" href="#android-safetynet-attestation"></a></h3>
   <p>When the <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-25">Authenticator</a> in question is a platform-provided Authenticator on certain Android platforms, the attestation
statement is based on the <a href="https://developer.android.com/training/safetynet/index.html#compat-check-response">SafetyNet API</a>. In
this case the authenticator data is completely controlled by the caller of the SafetyNet API (typically an application running
on the Android platform) and the attestation statement only provides some statements about the health of the platform and thehref
identity of the calling application.</p>
   <dl>
    <dt data-md="">
     <p>Attestation format identifier</p>
    <dd data-md="">
     <p>android-safetynet</p>
    <dt data-md="">
     <p>Attestation types supported</p>
    <dd data-md="">
     <p>Basic</p>
    <dt data-md="">
     <p>Syntax</p>
    <dd data-md="">
     <p>An Android Attestation statement has the following format:</p>
<pre class="idl highlight def"><span class="kt">interface</span> <dfn class="nv idl-code" data-dfn-type="interface" data-export="" id="androidsafetynetattestation">AndroidSafetyNetAttestation<a class="self-link" href="#androidsafetynetattestation"></a></dfn> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">unsigned</span> <span class="kt">long</span> <dfn class="nv dfn-paneled idl-code" data-dfn-for="AndroidSafetyNetAttestation" data-dfn-type="attribute" data-export="" data-readonly="" data-type="unsigned long" id="dom-androidsafetynetattestation-version">version</dfn>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">DOMString</span>     <dfn class="nv dfn-paneled idl-code" data-dfn-for="AndroidSafetyNetAttestation" data-dfn-type="attribute" data-export="" data-readonly="" data-type="DOMString" id="dom-androidsafetynetattestation-safetynetresponse">safetyNetResponse</dfn>;
};
</pre>
     <div>
       The <dfn data-dfn-for="AndroidSafetyNetAttestation" data-dfn-type="dfn" data-noexport="" id="androidsafetynetattestation-version">version<a class="self-link" href="#androidsafetynetattestation-version"></a></dfn> element is set to the version number of Google Play Services responsible for providing the SafetyNet
    API. 
      <p>The <dfn data-dfn-for="AndroidSafetyNetAttestation" data-dfn-type="dfn" data-noexport="" id="androidsafetynetattestation-safetynetresponse">safetyNetResponse<a class="self-link" href="#androidsafetynetattestation-safetynetresponse"></a></dfn> element contains the value returned by the above SafetyNet API. This value is a JWS <a data-link-type="biblio" href="#biblio-rfc7515">[RFC7515]</a> object (see <a href="https://developer.android.com/training/safetynet/index.html#compat-check-response">SafetyNet online documentation</a>)
    in Compact Serialization.</p>
     </div>
    <dt data-md="">
     <p>Signing procedure</p>
    <dd data-md="">
     <p>Request a SafetyNet attestation, providing attToBeSigned as the nonce value.</p>
    <dt data-md="">
     <p>Verification procedure</p>
    <dd data-md="">
     <p>Verification is performed as follows:</p>
     <ul>
      <li data-md="">
       <p>Verify that <code class="idl"><a data-link-type="idl" href="#dom-androidsafetynetattestation-safetynetresponse" id="ref-for-dom-androidsafetynetattestation-safetynetresponse-1">safetyNetResponse</a></code> is a valid SafetyNet response of version <code class="idl"><a data-link-type="idl" href="#dom-androidsafetynetattestation-version" id="ref-for-dom-androidsafetynetattestation-version-1">version</a></code>.</p>
      <li data-md="">
       <p>Verify that the nonce in the <code class="idl"><a data-link-type="idl" href="#dom-androidsafetynetattestation-safetynetresponse" id="ref-for-dom-androidsafetynetattestation-safetynetresponse-2">safetyNetResponse</a></code> is identical to <a data-link-type="dfn" href="#atttobesigned" id="ref-for-atttobesigned-6">attToBeSigned</a>.</p>
      <li data-md="">
       <p>Verify that the attestation certificate is issued to the hostname "attest.android.com" (see <a href="https://developer.android.com/training/safetynet/index.html#compat-check-response">SafetyNet online documentation</a>).</p>
      <li data-md="">
       <p>Verify that the <code>ctsProfileMatch</code> attribute in the payload of the <code class="idl"><a data-link-type="idl" href="#dom-androidsafetynetattestation-safetynetresponse" id="ref-for-dom-androidsafetynetattestation-safetynetresponse-3">safetyNetResponse</a></code> is
true.</p>
     </ul>
   </dl>
   <h2 class="heading settled" data-level="7" id="extensions"><span class="secno">7. </span><span class="content">WebAuthn Extensions</span><a class="self-link" href="#extensions"></a></h2>
   <p>The mechanism for generating scoped credentials, as well as requesting and generating WebAuthn assertions, as defined in <a href="#api">§4 Web Authentication API</a>, can be extended to suit particular use cases. Each case is addressed by defining a registration extension and/or
an authentication extension. Extensions can define additions to the following steps and data:</p>
   <ul>
    <li data-md="">
     <p><code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential" id="ref-for-dom-webauthentication-makecredential-5">makeCredential()</a></code> request parameters for registration extension.</p>
    <li data-md="">
     <p><code class="idl"><a data-link-type="idl" href="#dom-webauthentication-getassertion" id="ref-for-dom-webauthentication-getassertion-8">getAssertion()</a></code> request parameters for authentication extensions.</p>
    <li data-md="">
     <p>Client processing, and the <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-19">ClientData</a></code> structure, for registration extensions and authentication extensions.</p>
    <li data-md="">
     <p>Authenticator processing, and the <a data-link-type="dfn" href="#authenticatordata" id="ref-for-authenticatordata-14">authenticatorData</a> structure, for registration extensions and authentication
extensions.</p>
   </ul>
   <p>When requesting an assertion for a scoped credential, a Relying Party can list a set of extensions to be used, if they are supported by
the client and/or the authenticator. It sends the client arguments for each extension in the <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-getassertion" id="ref-for-dom-webauthentication-getassertion-9">getAssertion()</a></code> call (for
authentication extensions) or <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential" id="ref-for-dom-webauthentication-makecredential-6">makeCredential()</a></code> call (for registration extensions) to the client platform. The client
platform performs additional processing for each extension that it supports, and augments <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-20">ClientData</a></code> as required by the
extension. In addition, the client collects the authenticator arguments for the above extensions, and passes them to the
authenticator in the <a data-link-type="dfn" href="#authenticatormakecredential" id="ref-for-authenticatormakecredential-6">authenticatorMakeCredential</a> call (for registration extensions) or <a data-link-type="dfn" href="#authenticatorgetassertion" id="ref-for-authenticatorgetassertion-7">authenticatorGetAssertion</a> call (for authentication extensions). These authenticator arguments are passed as name-value pairs, with the extension
identifier as the name, and the corresponding authenticator argument as the value. The authenticator, in turn, performs
additional processing for the extensions that it supports, and augments <a data-link-type="dfn" href="#authenticatordata" id="ref-for-authenticatordata-15">authenticatorData</a> as specified by the extension.</p>
   <p>All WebAuthn extensions are optional for both clients and authenticators. Thus, any extensions requested by a Relying Party may be
ignored by the client browser or OS and not passed to the authenticator at all, or they may be ignored by the authenticator.
Ignoring an extension is never considered a failure in WebAuthn API processing, so when Relying Parties include extensions with any API
calls, they must be prepared to handle cases where some or all of those extensions are ignored.</p>
   <p>Clients wishing to support the widest possible range of extensions may choose to pass through any extensions that they do not
recognize to authenticators, generating the authenticator argument by simply encoding the client argument in CBOR. All
WebAuthn extensions MUST be defined in such a way that this implementation choice does not endanger the user’s security or
privacy. For instance, if an extension requires client processing, it could be defined in a manner that ensures such a naïve
pass-through will produce a semantically invalid authenticator argument, resulting in the extension being ignored by the
authenticator. Since all extensions are optional, this will not cause a functional failure in the API operation.</p>
   <h3 class="heading settled" data-level="7.1" id="extension-id"><span class="secno">7.1. </span><span class="content">Extension Identifiers</span><a class="self-link" href="#extension-id"></a></h3>
   <p>Extensions are identified by a string, called an <dfn data-dfn-type="dfn" data-noexport="" id="extension-identifier">extension identifier<a class="self-link" href="#extension-identifier"></a></dfn>, chosen by the extension author.</p>
   <p>Extension identifiers SHOULD be registered per <a data-link-type="biblio" href="#biblio-webauthn-registries">[WebAuthn-Registries]</a> "Registries for Web Authentication (WebAuthn)".
All registered extension identifiers are unique amongst themselves as a matter of course.</p>
   <p>Unregistered extension identifiers should aim to be globally unique, e.g., by including the defining entity such as <code>myCompany_extension</code>.</p>
   <p>All extension identifiers MUST be a maximum of 32 octets in length and MUST
consist only of printable USASCII characters, i.e., VCHAR as defined in <a data-link-type="biblio" href="#biblio-rfc5234">[RFC5234]</a>.
Implementations MUST match WebAuthn extension identifiers in a case-insensitive fashion.</p>
   <p>Extensions that may exist in multiple versions should take care to include a version in their identifier. In effect, different
versions are thus treated as different extensions, e.g., <code>myCompany_extension_01</code></p>
   <p>Extensions defined in this specification use a fixed prefix of <code>webauthn</code> for the extension identifiers. This prefix should not
be used for extensions not defined by the W3C.</p>
   <p><a href="#extension-predef">§8 Pre-defined extensions</a> defines an initial set of currently-defined and registered extensions their identifiers. See the WebAuthn
Extension Identifiers Registry defined in <a data-link-type="biblio" href="#biblio-webauthn-registries">[WebAuthn-Registries]</a> for an up-to-date list of registered WebAuthn Extension
Identifiers.</p>
   <h3 class="heading settled" data-level="7.2" id="extension-specification"><span class="secno">7.2. </span><span class="content">Defining extensions</span><a class="self-link" href="#extension-specification"></a></h3>
   <p>A definition of an extension must specify, at minimum, an extension identifier and an extension client argument sent via the <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-getassertion" id="ref-for-dom-webauthentication-getassertion-10">getAssertion()</a></code> or <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential" id="ref-for-dom-webauthentication-makecredential-7">makeCredential()</a></code> call. Additionally, extensions may specify additional values in <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-21">ClientData</a></code>, <a data-link-type="dfn" href="#authenticatordata" id="ref-for-authenticatordata-16">authenticatorData</a> (in the case of authentication extensions), or both. Finally, if the extension requires any
authenticator processing, it must also specify an authenticator argument to be sent via the <a data-link-type="dfn" href="#authenticatorgetassertion" id="ref-for-authenticatorgetassertion-8">authenticatorGetAssertion</a> or <a data-link-type="dfn" href="#authenticatormakecredential" id="ref-for-authenticatormakecredential-7">authenticatorMakeCredential</a> call.</p>
   <p>Any extension that requires client processing MUST specify a method of augmenting <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-22">ClientData</a></code> that unambiguously lets the
Relying Party know that the extension was honored by the client. Similarly, any extension that requires authenticator processing MUST
specify a method of augmenting <a data-link-type="dfn" href="#authenticatordata" id="ref-for-authenticatordata-17">authenticatorData</a> to let the Relying Party know that the extension was honored by the
authenticator.</p>
   <h3 class="heading settled" data-level="7.3" id="extension-request-parameters"><span class="secno">7.3. </span><span class="content">Extending request parameters</span><a class="self-link" href="#extension-request-parameters"></a></h3>
   <p>An extension defines up to two request arguments. The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="client-argument">client argument</dfn> is passed from the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-21">Relying Party</a> to the client
in the <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-getassertion" id="ref-for-dom-webauthentication-getassertion-11">getAssertion()</a></code> or <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential" id="ref-for-dom-webauthentication-makecredential-8">makeCredential()</a></code> call, while the <dfn data-dfn-type="dfn" data-noexport="" id="authenticator-argument">authenticator argument<a class="self-link" href="#authenticator-argument"></a></dfn> is passed from the client
to the authenticator during the processing of these calls.</p>
   <p>A Relying Party simultaneously requests the use of an extension and sets its client argument by including an entry in the <code class="idl"><a data-link-type="idl" href="#dom-scopedcredentialoptions-extensions" id="ref-for-dom-scopedcredentialoptions-extensions-2">extensions</a></code> option to the <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential" id="ref-for-dom-webauthentication-makecredential-9">makeCredential()</a></code> or <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-getassertion" id="ref-for-dom-webauthentication-getassertion-12">getAssertion()</a></code> call. The entry key MUST be the
extension identifier, and the value MUST be the <a data-link-type="dfn" href="#client-argument" id="ref-for-client-argument-1">client argument</a>.</p>
<pre class="example highlight" id="example-5d06d72b"><a class="self-link" href="#example-5d06d72b"></a>var assertionPromise = credentials.getAssertion(..., /* extensions */ {
    "webauthnExample_foobar": 42
});
</pre>
   <p>Extension definitions MUST specify the valid values for their client argument. Clients SHOULD ignore extensions with an invalid
client argument. If an extension does not require any parameters from the Relying Party, it SHOULD be defined as taking a Boolean client
argument, set to <code>true</code> to signify that the extension is requested by the Relying Party.</p>
   <p>Extensions that only affect client processing need not specify an authenticator argument. Extensions that affect authenticator
processing MUST specify a method of computing the authenticator argument from the client argument. For extensions that do not
require additional parameters, and are defined as taking a Boolean client argument set to <code>true</code>, this method SHOULD consist of
passing an authenticator argument of <code>true</code> (CBOR major type 7, value 21).</p>
   <p class="note" role="note">Note: Extensions should aim to define authenticator arguments that are as small as possible. Some authenticators communicate
    over low-bandwidth links such as Bluetooth Low-Energy or NFC.</p>
   <h3 class="heading settled" data-level="7.4" id="extension-client-processing"><span class="secno">7.4. </span><span class="content">Extending client processing</span><a class="self-link" href="#extension-client-processing"></a></h3>
   <p>Extensions may define additional processing requirements on the client platform during the creation of credentials or the
generation of an assertion. In order for the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-22">Relying Party</a> to verify the processing took place, or if the processing has a result
value that the Relying Party needs to be aware of, the extension should specify a client data value to be included in the <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-23">ClientData</a></code> structure.</p>
   <p>The client data value may be any value that can be encoded using JSON. If any extension processed by a client defines such a
value, the client SHOULD include a dictionary in <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-24">ClientData</a></code> with the key <code class="idl"><a data-link-type="idl" href="#dom-clientdata-extensions" id="ref-for-dom-clientdata-extensions-3">extensions</a></code>. For each such
extension, the client SHOULD add an entry to this dictionary with the extension identifier as the key, and the extension’s
client data value.</p>
   <p>Extensions that require authenticator processing MUST define the process by which the client argument can be used to determine
the authenticator argument.</p>
   <h3 class="heading settled" data-level="7.5" id="extension-authenticator-processing"><span class="secno">7.5. </span><span class="content">Extending authenticator processing</span><a class="self-link" href="#extension-authenticator-processing"></a></h3>
   <p>Extensions that define additional authenticator processing may similarly define an authenticator data value. The value may be
any data that can be encoded in CBOR. An authenticator that processes an authentication extension that defines such a value must
include it in the <a data-link-type="dfn" href="#authenticatordata" id="ref-for-authenticatordata-18">authenticatorData</a>.</p>
   <p>As specified in <a href="#sec-authenticator-data">§5.2.1 Authenticator data</a>, the authenticator data value of each processed extension is included in the
extended data part of the <a data-link-type="dfn" href="#authenticatordata" id="ref-for-authenticatordata-19">authenticatorData</a>. This part is a CBOR map, with extension identifiers as keys, and the
authenticator data value of each extension as the value.</p>
   <h3 class="heading settled" data-level="7.6" id="sample-extensions"><span class="secno">7.6. </span><span class="content">Example extension</span><a class="self-link" href="#sample-extensions"></a></h3>
   <p><em>This section is not normative.</em></p>
   <p>To illustrate the requirements above, consider a hypothetical extension "Geo". This extension, if supported, lets both clients
and authenticators embed their geolocation in assertions.</p>
   <p>The extension identifier is chosen as <code>webauthnExample_geo</code>. The client argument is the constant value <code>true</code>, since the
extension does not require the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-23">Relying Party</a> to pass any particular information to the client, other than that it requests the use
of the extension. The Relying Party sets this value in its request for an assertion:</p>
<pre class="highlight">var assertionPromise =
    credentials.getAssertion("SGFuIFNvbG8gc2hvdCBmaXJzdC4",
        {}, /* Empty filter */
        { 'webauthnExample_geo': true });
</pre>
   <p>The extension defines the additional client data to be the client’s location, if known, as a GeoJSON <a data-link-type="biblio" href="#biblio-geojson">[GeoJSON]</a> point. The
client constructs the following client data:</p>
<pre class="highlight">{
    ...,
    'extensions': {
        'webauthnExample_geo': {
            'type': 'Point',
            'coordinates': [65.059962, -13.993041]
        }
    }
}
</pre>
   <p>The extension also requires the client to set the authenticator parameter to the fixed value <code>true</code>.</p>
   <p>Finally, the extension requires the authenticator to specify its geolocation in the authenticator data, if known. The extension
e.g. specifies that the location shall be encoded as a two-element array of floating point numbers, encoded with CBOR. An
authenticator does this by including it in the <a data-link-type="dfn" href="#authenticatordata" id="ref-for-authenticatordata-20">authenticatorData</a>. As an example, authenticator data may be as follows
(notation taken from <a data-link-type="biblio" href="#biblio-rfc7049">[RFC7049]</a>):</p>
<pre class="highlight">81 (hex)                                    -- Flags, ED and TUP both set.
20 05 58 1F                                 -- Signature counter
A1                                          -- CBOR map of one element
    73                                      -- Key 1: CBOR text string of 19 bytes
        77 65 62 61 75 74 68 6E 45 78 61
        6D 70 6C 65 5F 67 65 6F             -- "webauthnExample_geo" <a data-link-type="dfn">UTF-8 encoded</a> string
    82                                      -- Value 1: CBOR array of two elements
        FA 42 82 1E B3                      -- Element 1: Latitude as CBOR encoded float
        FA C1 5F E3 7F                      -- Element 2: Longitude as CBOR encoded float
</pre>
   <h2 class="heading settled" data-level="8" id="extension-predef"><span class="secno">8. </span><span class="content">Pre-defined extensions</span><a class="self-link" href="#extension-predef"></a></h2>
   <p>This section defines an initial set of extensions. These are recommended for implementation by user agents targeting broad
interoperability.</p>
   <h3 class="heading settled" data-level="8.1" id="extension-appid"><span class="secno">8.1. </span><span class="content">FIDO AppId</span><a class="self-link" href="#extension-appid"></a></h3>
   <p>This authentication extension allows Relying Parties who have previously registered a
credential using the legacy FIDO JavaScript APIs to request an assertion.
Specifically, this extension allows Relying Parties to specify an <var>appId</var> <a data-link-type="biblio" href="#biblio-fido-appid">[FIDO-APPID]</a> to overwrite the otherwise computed <var>rpId</var>.  This extension is only valid if
used during the <a data-link-type="functionish" href="#dom-webauthentication-getassertion" id="ref-for-dom-webauthentication-getassertion-13">getAssertion()</a> call; other usage will result in client
error.</p>
   <dl>
    <dt data-md="">
     <p>Extension identifier</p>
    <dd data-md="">
     <p><code>fido_appid</code></p>
    <dt data-md="">
     <p>Client argument</p>
    <dd data-md="">
     <p>A single <a data-link-type="dfn">UTF-8 encoded</a> string specifying a FIDO <var>appId</var>.</p>
    <dt data-md="">
     <p>Client processing</p>
    <dd data-md="">
     <p>If <code class="idl"><a data-link-type="idl" href="#dom-assertionoptions-rpid" id="ref-for-dom-assertionoptions-rpid-4">rpId</a></code> is present, reject promise with a DOMException
whose name is "NotAllowedError", and terminate this algorithm.
Replace the calculation of <var>rpId</var> in Step 3 of <a href="#getAssertion">§4.1.2 Use an existing credential (getAssertion() method)</a> with the
following procedure:  The client uses the value of <var>fido_appid</var> to perform
the AppId validation procedure (as defined by <a data-link-type="biblio" href="#biblio-fido-appid">[FIDO-APPID]</a>).  If valid,
the value of <var>rpId</var> for all client processing should be replaced by the
value of <var>fido_appid</var>.</p>
    <dt data-md="">
     <p>Authenticator argument</p>
    <dd data-md="">
     <p>none</p>
    <dt data-md="">
     <p>Authenticator processing</p>
    <dd data-md="">
     <p>none</p>
    <dt data-md="">
     <p>Authenticator data</p>
    <dd data-md="">
     <p>none</p>
   </dl>
   <h3 class="heading settled" data-level="8.2" id="extension-txauth"><span class="secno">8.2. </span><span class="content">Transaction authorization</span><a class="self-link" href="#extension-txauth"></a></h3>
   <p>This authentication extension allows for a simple form of transaction authorization. A Relying Party can specify a prompt string,
intended for display on a trusted device on the authenticator.</p>
   <dl>
    <dt data-md="">
     <p>Extension identifier</p>
    <dd data-md="">
     <p><code>webauthn_txAuthSimple</code></p>
    <dt data-md="">
     <p>Client argument</p>
    <dd data-md="">
     <p>A single <a data-link-type="dfn">UTF-8 encoded</a> string prompt.</p>
    <dt data-md="">
     <p>Client processing</p>
    <dd data-md="">
     <p>None, except default forwarding of client argument to authenticator argument.</p>
    <dt data-md="">
     <p>Authenticator argument</p>
    <dd data-md="">
     <p>The client argument encoded as a CBOR text string (major type 3).</p>
    <dt data-md="">
     <p>Authenticator processing</p>
    <dd data-md="">
     <p>The authenticator MUST display the prompt to the user before performing the user verification / test of user presence. The
authenticator may insert line breaks if needed.</p>
    <dt data-md="">
     <p>Authenticator data</p>
    <dd data-md="">
     <p>A single <a data-link-type="dfn">UTF-8 encoded</a> string, representing the prompt as displayed (including any eventual line breaks).</p>
   </dl>
   <p>The generic version of this extension allows images to be used as prompts as well.  This allows authenticators without a font
rendering engine to be used and also supports a richer visual appearance.</p>
   <dl>
    <dt data-md="">
     <p>Extension identifier</p>
    <dd data-md="">
     <p><code>webauthn_txAuthGeneric</code></p>
    <dt data-md="">
     <p>Client argument</p>
    <dd data-md="">
     <p>A CBOR map with one pair of data items (CBOR tagged as 0xa1). The pair of data items consists of</p>
     <ol>
      <li data-md="">
       <p>one <a data-link-type="dfn">UTF-8 encoded</a> string <dfn data-dfn-type="dfn" data-noexport="" id="contenttype">contentType<a class="self-link" href="#contenttype"></a></dfn>, containing the MIME-Type of the content, e.g. "image/png"</p>
      <li data-md="">
       <p>and the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="content">content</dfn> itself, encoded as CBOR byte array.</p>
     </ol>
    <dt data-md="">
     <p>Client processing</p>
    <dd data-md="">
     <p>None, except default forwarding of client argument to authenticator argument.</p>
    <dt data-md="">
     <p>Authenticator argument</p>
    <dd data-md="">
     <p>The client argument encoded as a CBOR map.</p>
    <dt data-md="">
     <p>Authenticator processing</p>
    <dd data-md="">
     <p>The authenticator MUST display the <a data-link-type="dfn" href="#content" id="ref-for-content-1">content</a> to the user before performing the user verification / test of user
presence. The authenticator may add other information below the <a data-link-type="dfn" href="#content" id="ref-for-content-2">content</a>. No changes are allowed to the <a data-link-type="dfn" href="#content" id="ref-for-content-3">content</a> itself, i.e., inside <a data-link-type="dfn" href="#content" id="ref-for-content-4">content</a> boundary box.</p>
    <dt data-md="">
     <p>Authenticator data</p>
    <dd data-md="">
     <p>The hash value of the <a data-link-type="dfn" href="#content" id="ref-for-content-5">content</a> which was displayed. The authenticator MUST use the same hash algorithm as it uses for
the signature itself.</p>
   </dl>
   <h3 class="heading settled" data-level="8.3" id="extension-authenticator-selection"><span class="secno">8.3. </span><span class="content">Authenticator Selection Extension</span><a class="self-link" href="#extension-authenticator-selection"></a></h3>
   <p>This registration extension allows a Relying Party to guide the selection of the authenticator that will be leveraged when creating the
credential. It is intended primarily for Relying Parties that wish to tightly control the experience around credential creation.</p>
   <dl>
    <dt data-md="">
     <p>Extension identifier</p>
    <dd data-md="">
     <p><code>webauthn_authnSel</code></p>
    <dt data-md="">
     <p>Client argument</p>
    <dd data-md="">
     <p>A sequence of AAGUIDs:</p>
<pre class="idl highlight def"><span class="kt">typedef</span> <span class="kt">sequence</span> &lt; <a class="n" data-link-type="idl-name" href="#typedefdef-aaguid" id="ref-for-typedefdef-aaguid-1">AAGUID</a> > <dfn class="nv idl-code" data-dfn-type="typedef" data-export="" id="typedefdef-authenticatorselectionlist">AuthenticatorSelectionList<a class="self-link" href="#typedefdef-authenticatorselectionlist"></a></dfn>;
</pre>
     <p>Each AAGUID corresponds to an authenticator model that is acceptable to the Relying Party for this credential creation. The
list is ordered by decreasing preference.</p>
     <p>An AAGUID is defined as an array containing the globally unique identifier of the authenticator model being sought.</p>
<pre class="idl highlight def"><span class="kt">typedef</span> <a class="n" data-link-type="idl-name" href="https://heycam.github.io/webidl/#BufferSource">BufferSource</a> <dfn class="nv dfn-paneled idl-code" data-dfn-type="typedef" data-export="" id="typedefdef-aaguid">AAGUID</dfn>;
</pre>
    <dt data-md="">
     <p>Client processing</p>
    <dd data-md="">
     <p>This extension can only be used during <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential" id="ref-for-dom-webauthentication-makecredential-10">makeCredential()</a></code>. If the client supports the Authenticator Selection Extension, it
MUST use the first available authenticator whose AAGUID is present in the <dfn data-dfn-type="dfn" data-noexport="" id="authenticatorselectionlist">AuthenticatorSelectionList<a class="self-link" href="#authenticatorselectionlist"></a></dfn>. If none of
the available authenticators match a provided AAGUID, the client MUST select an authenticator from among the available
authenticators to generate the credential.</p>
    <dt data-md="">
     <p>Authenticator argument</p>
    <dd data-md="">
     <p>There is no authenticator argument.</p>
    <dt data-md="">
     <p>Authenticator processing</p>
    <dd data-md="">
     <p>None.</p>
   </dl>
   <h3 class="heading settled" data-level="8.4" id="supported-extensions-extension"><span class="secno">8.4. </span><span class="content">SupportedExtensions Extension</span><a class="self-link" href="#supported-extensions-extension"></a></h3>
   <dl>
    <dt data-md="">
     <p>Extension identifier</p>
    <dd data-md="">
     <p><code>webauthn_exts</code></p>
    <dt data-md="">
     <p>Client argument</p>
    <dd data-md="">
     <p>The Boolean value <code>true</code> to indicate that this extension is requested by the Relying Party.</p>
    <dt data-md="">
     <p>Client processing</p>
    <dd data-md="">
     <p>None, except default forwarding of client argument to authenticator argument.</p>
    <dt data-md="">
     <p>Authenticator argument</p>
    <dd data-md="">
     <p>The Boolean value <code>true</code>, encoded in CBOR (major type 7, value 21).</p>
    <dt data-md="">
     <p>Authenticator processing</p>
    <dd data-md="">
     <p>The <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-26">authenticator</a> augments the authenticator data with a list of extensions that the authenticator supports, as
defined below. This extension can be added to attestation statements.</p>
    <dt data-md="">
     <p>Authenticator data</p>
    <dd data-md="">
     <p>The SupportedExtensions extension is a list (CBOR array) of extension identifiers (<a data-link-type="dfn">UTF-8 encoded</a> strings).</p>
   </dl>
   <h3 class="heading settled" data-level="8.5" id="uvi-extension"><span class="secno">8.5. </span><span class="content">User Verification Index (UVI) Extension</span><a class="self-link" href="#uvi-extension"></a></h3>
   <dl>
    <dt data-md="">
     <p>Extension identifier</p>
    <dd data-md="">
     <p><code>webauthn_uvi</code></p>
    <dt data-md="">
     <p>Client argument</p>
    <dd data-md="">
     <p>The Boolean value <code>true</code> to indicate that this extension is requested by the Relying Party.</p>
    <dt data-md="">
     <p>Client processing</p>
    <dd data-md="">
     <p>None, except default forwarding of client argument to authenticator argument.</p>
    <dt data-md="">
     <p>Authenticator argument</p>
    <dd data-md="">
     <p>The Boolean value <code>true</code>, encoded in CBOR (major type 7, value 21).</p>
    <dt data-md="">
     <p>Authenticator processing</p>
    <dd data-md="">
     <p>The <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-27">authenticator</a> augments the authenticator data with a user verification index indicating the method used by the
user to authorize the operation, as defined below. This extension can be added to attestation statements and assertions.</p>
    <dt data-md="">
     <p>Authenticator data</p>
    <dd data-md="">
     <p>The user verification index (UVI) is a value uniquely identifying a user verification data record. The UVI is encoded as CBOR
byte string (type 0x58). Each UVI value MUST be specific to the related key (in order to provide unlinkability). It also
must contain sufficient entropy that makes guessing impractical. UVI values MUST NOT be reused by the Authenticator (for
other biometric data or users).</p>
     <p>The UVI data can be used by servers to understand whether an authentication was authorized by the exact same biometric data
as the initial key generation. This allows the detection and prevention of "friendly fraud".</p>
     <p>As an example, the UVI could be computed as SHA256(KeyID | SHA256(rawUVI)), where the rawUVI reflects (a) the biometric
reference data, (b) the related OS level user ID and (c) an identifier which changes whenever a factory reset is performed
for the device, e.g. rawUVI = biometricReferenceData | OSLevelUserID | FactoryResetCounter.</p>
     <p>Servers supporting UVI extensions MUST support a length of up to 32 bytes for the UVI value.</p>
     <p>Example for <a data-link-type="dfn" href="#authenticatordata" id="ref-for-authenticatordata-21">authenticatorData</a> containing one UVI extension</p>
<pre class="highlight">...                                         -- RP ID hash (32 bytes)
81                                          -- TUP and ED set
00 00 00 01                                 -- (initial) signature counter
...                                         -- all public key alg etc.
A1                                          -- extension: CBOR map of one element
    6C                                      -- Key 1: CBOR text string of 11 bytes
        77 65 62 61 75 74 68 6E 5F 75 76 69 -- "webauthn_uvi" <a data-link-type="dfn">UTF-8 encoded</a> string
    58 20                                   -- Value 1: CBOR byte string with 0x20 bytes
        00 43 B8 E3 BE 27 95 8C             -- the UVI value itself
        28 D5 74 BF 46 8A 85 CF
        46 9A 14 F0 E5 16 69 31
        DA 4B CF FF C1 BB 11 32
        82
</pre>
   </dl>
   <h3 class="heading settled" data-level="8.6" id="uvi-location"><span class="secno">8.6. </span><span class="content">Location Extension</span><a class="self-link" href="#uvi-location"></a></h3>
   <dl>
    <dt data-md="">
     <p>Extension identifier</p>
    <dd data-md="">
     <p><code>webauthn_loc</code></p>
    <dt data-md="">
     <p>Client argument</p>
    <dd data-md="">
     <p>The Boolean value <code>true</code> to indicate that this extension is requested by the Relying Party.</p>
    <dt data-md="">
     <p>Client processing</p>
    <dd data-md="">
     <p>None, except default forwarding of client argument to authenticator argument.</p>
    <dt data-md="">
     <p>Authenticator argument</p>
    <dd data-md="">
     <p>The Boolean value <code>true</code>, encoded in CBOR (major type 7, value 21).</p>
    <dt data-md="">
     <p>Authenticator processing</p>
    <dd data-md="">
     <p>If the <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-28">authenticator</a> does not support the extension, then the authenticator MUST ignore the extension request.
If the <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-29">authenticator</a> accepts the extension, then the authenticator SHOULD only add this extension data to a packed
attestation or assertion.</p>
    <dt data-md="">
     <p>Authenticator data</p>
    <dd data-md="">
     <p>If the <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-30">authenticator</a> accepts the extension request, then authenticator data SHOULD provide location data in the form of a
CBOR-encoded map, with the first value being the extension identifier and the second being an array of returned values.  The array
elements SHOULD be derived from (key,value) pairings for each location attribute that the <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-31">authenticator</a> supports. The following is
an example of <a data-link-type="dfn" href="#authenticatordata" id="ref-for-authenticatordata-22">authenticatorData</a> where the returned array is comprised of a {longitude, latitude, altitude} triplet, following the
coordinate representation defined in <a href="https://dev.w3.org/geo/api/spec-source.html#coordinates_interface">The W3C Geolocation API Specification</a>.</p>
<pre class="highlight">...                                         -- RP ID hash (32 bytes)
81                                          -- TUP and ED set
00 00 00 01                                 -- (initial) signature counter
...                                         -- all public key alg etc.
A1                                          -- extension: CBOR map of one element
    6C                                      -- Value 1: CBOR text string of 11 bytes
        77 65 62 61 75 74 68 6E 5F 6C 6F 63 -- "webauthn_loc" <a data-link-type="dfn">UTF-8 encoded</a> string
    86                                      -- Value 2: array of 6 elements
        68            -- Element 1:  CBOR text string of 8 bytes
           6C 61 74 69 74 75 64 65          -- “latitude” <a data-link-type="dfn">UTF-8 encoded</a> string
        FB ...            -- Element 2:  Latitude as CBOR encoded double-precision float
        69            -- Element 3:  CBOR text string of 9 bytes
           6C 6F 6E 67 69 74 75 64 65       -- “longitude” <a data-link-type="dfn">UTF-8 encoded</a> string
        FB ...            -- Element 4:  Longitude as CBOR encoded double-precision float
        68            -- Element 5:  CBOR text string of 8 bytes
          61 6C 74 69 74 75 64 65           -- “altitude” <a data-link-type="dfn">UTF-8 encoded</a> string
        FB ...            -- Element 6:  Altitude as CBOR encoded double-precision float
</pre>
   </dl>
   <h3 class="heading settled" data-level="8.7" id="uvm-extension"><span class="secno">8.7. </span><span class="content">User Verification Mode (UVM) Extension</span><a class="self-link" href="#uvm-extension"></a></h3>
   <dl>
    <dt data-md="">
     <p>Extension identifier</p>
    <dd data-md="">
     <p><code>webauthn_uvm</code></p>
    <dt data-md="">
     <p>Client argument</p>
    <dd data-md="">
     <p>The Boolean value true to indicate that this extension is requested by the WebAuthn Relying Party.</p>
    <dt data-md="">
     <p>Client processing</p>
    <dd data-md="">
     <p>None, except default forwarding of client argument to authenticator argument.</p>
    <dt data-md="">
     <p>Authenticator argument</p>
    <dd data-md="">
     <p>The Boolean value <code>true</code>, encoded in CBOR (major type 7, value 21).</p>
    <dt data-md="">
     <p>Authenticator processing</p>
    <dd data-md="">
     <p>The <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-32">authenticator</a> augments the authenticator data with a user verification index indicating the method used by the
user to authorize the operation, as defined below. This extension can be added to attestation statements and assertions.</p>
    <dt data-md="">
     <p>Authenticator data</p>
    <dd data-md="">
     <p>Authenticators can report up to 3 different user verification methods (factors) used in a single authentication instance.
To accommodate this possibility the UVM is encoded as CBOR array (major type 4) with a maximum allowed length of 3 -</p>
     <ul>
      <li data-md="">
       <p>Type 0x81 – only 1 factor was used for authentication.</p>
      <li data-md="">
       <p>Type 0x82 – 2 factors were used.</p>
      <li data-md="">
       <p>Type 0x83 – 3 or more factors were used.</p>
     </ul>
     <p>Each data item is in turn a CBOR array of length 3 (type 0x83) with the following data items:</p>
     <ul>
      <li data-md="">
       <p>Data Item 1 – User Verification Method. This is the authentication method/factor used by the authenticator to verify
            the user. Available values are defined in <a data-link-type="biblio" href="#biblio-fidoreg">[FIDOReg]</a>, "User Verification Methods" section. It is
            encoded as a CBOR unsigned integer (Major type 0).</p>
      <li data-md="">
       <p>Data Item 2 – Key Protection Type. This is the method used by the authenticator to protect the FIDO registration
            private key material. Available values are defined in <a data-link-type="biblio" href="#biblio-fidoreg">[FIDOReg]</a>, "Key Protection Types" section.
            It is encoded as a CBOR 2 byte unsigned short (Major type 0).</p>
      <li data-md="">
       <p>Data Item 3 – Matcher Protection Type. This is the method used by the authenticator to protect the matcher that
            performs user verification. Available values are defined in <a data-link-type="biblio" href="#biblio-fidoreg">[FIDOReg]</a>, "Matcher Protection Types"
            section. It is encoded as a CBOR 2 byte unsigned short (Major type 0).</p>
     </ul>
     <p>This is repeated for each factor used in the authentication instance.</p>
     <p>If >3 factors can be used in an authentication instance the authenticator vendor must select the 3 factors it believes
will be most relevant to the Server to include in the UVM.</p>
     <p>Servers supporting the UVM extension MUST support a length up to 36 bytes for a 3 factor maximum UVM value.</p>
     <p>Example for <a data-link-type="dfn" href="#authenticatordata" id="ref-for-authenticatordata-23">authenticatorData</a> containing one UVM extension for a multi-factor authentication instance where 2 factors were used:</p>
<pre class="highlight">...                    -- RP ID hash (32 bytes)
81                     -- TUP and ED set
00 00 00 01            -- (initial) signature counter
...                    -- all public key alg etc.
A1                     -- extension: CBOR map of one element
    6C                 -- Key 1: CBOR text string of 12 bytes
        77 65 62 61 75 74 68 6E 2E 75 76 6d -- "webauthn_uvm" <a data-link-type="dfn">UTF-8 encoded</a> string
    82                 -- Value 1: CBOR array of length 2 indicating two factor usage
        83              -- Item 1: CBOR array of length 3
            02           -- Subitem 1: CBOR integer for User Verification Method Fingerprint
            04           -- Subitem 2: CBOR short for Key Protection Type TEE
            02           -- Subitem 3: CBOR short for Matcher Protection Type TEE
        83              -- Item 2: CBOR array of length 3
            04           -- Subitem 1: CBOR integer for User Verification Method Passcode
            01           -- Subitem 2: CBOR short for Key Protection Type Software
            01           -- Subitem 3: CBOR short for Matcher Protection Type Software
</pre>
   </dl>
   <h2 class="heading settled" data-level="9" id="iana-considerations"><span class="secno">9. </span><span class="content">IANA Considerations</span><a class="self-link" href="#iana-considerations"></a></h2>
   <p>This specification registers the algorithm names "S256", "S384", "S512", and "SM3" with the IANA JSON Web Algorithms registry as
defined in section "Cryptographic Algorithms for Digital Signatures and MACs" in <a data-link-type="biblio" href="#biblio-rfc7518">[RFC7518]</a>.</p>
   <p>These names follow the naming strategy in <a href="https://tools.ietf.org/html/draft-ietf-oauth-spop-15">draft-ietf-oauth-spop-15</a>.</p>
   <table class="def">
    <tbody>
     <tr>
      <td>Algorithm Name
      <td>"S256"
     <tr>
      <td>Algorithm Description
      <td>The SHA256 hash algorithm.
     <tr>
      <td>Algorithm Usage Location(s)
      <td>"alg", i.e., used with JWS.
     <tr>
      <td>JOSE Implementation Requirements
      <td>Optional+
     <tr>
      <td>Change Controller
      <td><a href="https://fidoalliance.org/contact/">FIDO Alliance</a>
     <tr>
      <td>Specification Documents
      <td><a data-link-type="biblio" href="#biblio-fips-180-4">[FIPS-180-4]</a> 
     <tr>
      <td>Algorithm Analysis Document(s)
      <td><a data-link-type="biblio" href="#biblio-sp800-107r1">[SP800-107r1]</a>
   </table>
   <table class="def">
    <tbody>
     <tr>
      <td>Algorithm Name
      <td>"S384"
     <tr>
      <td>Algorithm Description
      <td>The SHA384 hash algorithm.
     <tr>
      <td>Algorithm Usage Location(s)
      <td>"alg", i.e., used with JWS.
     <tr>
      <td>JOSE Implementation Requirements
      <td>Optional
     <tr>
      <td>Change Controller
      <td><a href="https://fidoalliance.org/contact/">FIDO Alliance</a>
     <tr>
      <td>Specification Documents
      <td><a data-link-type="biblio" href="#biblio-fips-180-4">[FIPS-180-4]</a> 
     <tr>
      <td>Algorithm Analysis Document(s)
      <td><a data-link-type="biblio" href="#biblio-sp800-107r1">[SP800-107r1]</a>
   </table>
   <table class="def">
    <tbody>
     <tr>
      <td>Algorithm Name
      <td>"S512"
     <tr>
      <td>Algorithm Description
      <td>The SHA512 hash algorithm.
     <tr>
      <td>Algorithm Usage Location(s)
      <td>"alg", i.e., used with JWS.
     <tr>
      <td>JOSE Implementation Requirements
      <td>Optional+
     <tr>
      <td>Change Controller
      <td><a href="https://fidoalliance.org/contact/">FIDO Alliance</a>
     <tr>
      <td>Specification Documents
      <td><a data-link-type="biblio" href="#biblio-fips-180-4">[FIPS-180-4]</a> 
     <tr>
      <td>Algorithm Analysis Document(s)
      <td><a data-link-type="biblio" href="#biblio-sp800-107r1">[SP800-107r1]</a>
   </table>
   <table class="def">
    <tbody>
     <tr>
      <td>Algorithm Name
      <td>"SM3"
     <tr>
      <td>Algorithm Description
      <td>The SM3 hash algorithm.
     <tr>
      <td>Algorithm Usage Location(s)
      <td>"alg", i.e., used with JWS.
     <tr>
      <td>JOSE Implementation Requirements
      <td>Optional
     <tr>
      <td>Change Controller
      <td><a href="https://fidoalliance.org/contact/">FIDO Alliance</a>
     <tr>
      <td>Specification Documents
      <td><a data-link-type="biblio" href="#biblio-oscca-sm3">[OSCCA-SM3]</a> 
     <tr>
      <td>Algorithm Analysis Document(s)
      <td>N/A
   </table>
   <h2 class="heading settled" data-level="10" id="sample-scenarios"><span class="secno">10. </span><span class="content">Sample scenarios</span><a class="self-link" href="#sample-scenarios"></a></h2>
   <p><em>This section is not normative.</em></p>
   <p>In this section, we walk through some events in the lifecycle of a scoped credential, along with the corresponding sample code
for using this API. Note that this is an example flow, and does not limit the scope of how the API can be used.</p>
   <p>As was the case in earlier sections, this flow focuses on a use case involving an external first-factor <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-33">authenticator</a> with its own display. One example of such an authenticator would be a smart phone. Other authenticator types are also supported
by this API, subject to implementation by the platform. For instance, this flow also works without modification for the case of
an authenticator that is embedded in the client platform. The flow also works for the case of an authenticator without
its own display (similar to a smart card) subject to specific implementation considerations. Specifically, the client platform
needs to display any prompts that would otherwise be shown by the authenticator, and the authenticator needs to allow the client
platform to enumerate all the authenticator’s credentials so that the client can have information to show appropriate prompts.</p>
   <h3 class="heading settled" data-level="10.1" id="sample-registration"><span class="secno">10.1. </span><span class="content">Registration</span><a class="self-link" href="#sample-registration"></a></h3>
   <p>This is the first-time flow, in which a new credential is created and registered with the server.</p>
   <ol>
    <li data-md="">
     <p>The user visits example.com, which serves up a script. At this point, the user must already be logged in using a legacy
username and password, or additional authenticator, or other means acceptable to the Relying Party.</p>
    <li data-md="">
     <p>The Relying Party script runs the code snippet below.</p>
    <li data-md="">
     <p>The client platform searches for and locates the authenticator.</p>
    <li data-md="">
     <p>The client platform connects to the authenticator, performing any pairing actions if necessary.</p>
    <li data-md="">
     <p>The authenticator shows appropriate UI for the user to select the authenticator on which the new credential will be
created, and obtains a biometric or other authorization gesture from the user.</p>
    <li data-md="">
     <p>The authenticator returns a response to the client platform, which in turn returns a response to the Relying Party script. If
the user declined to select an authenticator or provide authorization, an appropriate error is returned.</p>
    <li data-md="">
     <p>If a new credential was created,</p>
     <ul>
      <li data-md="">
       <p>The Relying Party script sends the newly generated <a data-link-type="dfn" href="#credential-public-key" id="ref-for-credential-public-key-13">credential public key</a> to the server, along with additional information
such as attestation regarding the provenance and characteristics of the authenticator.</p>
      <li data-md="">
       <p>The server stores the <a data-link-type="dfn" href="#credential-public-key" id="ref-for-credential-public-key-14">credential public key</a> in its database and associates it with the user as well as with the
characteristics of authentication indicated by attestation, also storing a friendly name for later use.</p>
      <li data-md="">
       <p>The script may store data such as the credential ID in local storage, to improve future UX by narrowing the choice of
credential for the user.</p>
     </ul>
   </ol>
   <p>The sample code for generating and registering a new key follows:</p>
<pre class="example highlight" id="example-e4bb31ae"><a class="self-link" href="#example-e4bb31ae"></a>var webauthnAPI = navigator.authentication;

if (!webauthnAPI) { /* Platform not capable. Handle error. */ }

var userAccountInformation = {
    rpDisplayName: "Acme",
    displayName: "John P. Smith",
    name: "johnpsmith@example.com",
    id: "1098237235409872",
    imageURL: "https://pics.acme.com/00/p/aBjjjpqPb.png"
};

// This Relying Party will accept either an ES256 or RS256 credential, but
// prefers an ES256 credential.
var cryptoParams = [
    {
        type: "ScopedCred",
        algorithm: "ES256"
    },
    {
        type: "ScopedCred",
        algorithm: "RS256"
    }
];
var challenge = "Y2xpbWIgYSBtb3VudGFpbg";
var options = { timeoutSeconds: 300,  // 5 minutes
                excludeList: [],      // No excludeList
                extensions: {"webauthn.location": true}  // Include location information
                                               // in attestation
};

// Note: The following call will cause the authenticator to display UI.
webauthnAPI.makeCredential(userAccountInformation, cryptoParams, challenge, options)
    .then(function (newCredentialInfo) {
    // Send new credential info to server for verification and registration.
}).catch(function (err) {
    // No acceptable authenticator or user refused consent. Handle appropriately.
});
</pre>
   <h3 class="heading settled" data-level="10.2" id="sample-authentication"><span class="secno">10.2. </span><span class="content">Authentication</span><a class="self-link" href="#sample-authentication"></a></h3>
   <p>This is the flow when a user with an already registered credential visits a website and wants to authenticate using the
credential.</p>
   <ol>
    <li data-md="">
     <p>The user visits example.com, which serves up a script.</p>
    <li data-md="">
     <p>The script asks the client platform for a WebAuthn identity assertion, providing as much information as possible to narrow
the choice of acceptable credentials for the user. This may be obtained from the data that was stored locally after
registration, or by other means such as prompting the user for a username.</p>
    <li data-md="">
     <p>The <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-24">Relying Party</a> script runs one of the code snippets below.</p>
    <li data-md="">
     <p>The client platform searches for and locates the authenticator.</p>
    <li data-md="">
     <p>The client platform connects to the authenticator, performing any pairing actions if necessary.</p>
    <li data-md="">
     <p>The authenticator presents the user with a notification that their attention is required. On opening the
notification, the user is shown a friendly selection menu of acceptable credentials using the account information provided
when creating the credentials, along with some information on the origin that is requesting these keys.</p>
    <li data-md="">
     <p>The authenticator obtains a biometric or other authorization gesture from the user.</p>
    <li data-md="">
     <p>The authenticator returns a response to the client platform, which in turn returns a response to the Relying Party script.
If the user declined to select a credential or provide an authorization, an appropriate error is returned.</p>
    <li data-md="">
     <p>If an assertion was successfully generated and returned,</p>
     <ul>
      <li data-md="">
       <p>The script sends the assertion to the server.</p>
      <li data-md="">
       <p>The server examines the assertion, extracts the credential ID, looks up the registered
credential public key it is database, and verifies the assertion’s authentication signature.
If valid, it looks up the identity associated with the assertion’s credential ID; that
identity is now authenticated. If the credential ID is not recognized by the server (e.g.,
it has been deregistered due to inactivity) then the authentication has failed; each Relying Party
will handle this in its own way.</p>
      <li data-md="">
       <p>The server now does whatever it would otherwise do upon successful authentication -- return a success page, set
authentication cookies, etc.</p>
     </ul>
   </ol>
   <p>If the Relying Party script does not have any hints available (e.g., from locally stored data) to help it narrow the list of credentials,
then the sample code for performing such an authentication might look like this:</p>
<pre class="example highlight" id="example-48d2825e"><a class="self-link" href="#example-48d2825e"></a>var webauthnAPI = navigator.authentication;

if (!webauthnAPI) { /* Platform not capable. Handle error. */ }

var challenge = "Y2xpbWIgYSBtb3VudGFpbg";
var options = {
                timeoutSeconds = 300,  // 5 minutes
                allowList: [{ type: "ScopedCred" }]
              };

webauthnAPI.getAssertion(challenge, options)
    .then(function (assertion) {
    // Send assertion to server for verification
}).catch(function (err) {
    // No acceptable credential or user refused consent. Handle appropriately.
});
</pre>
   <p>On the other hand, if the Relying Party script has some hints to help it narrow the list of credentials, then the sample code for
performing such an authentication might look like the following. Note that this sample also demonstrates how to use the
extension for transaction authorization.</p>
<pre class="example highlight" id="example-e1bea6d9"><a class="self-link" href="#example-e1bea6d9"></a>var webauthnAPI = navigator.authentication;

if (!webauthnAPI) { /* Platform not capable. Handle error. */ }

var challenge = "Y2xpbWIgYSBtb3VudGFpbg";
var acceptableCredential1 = {
    type: "ScopedCred",
    id: "ISEhISEhIWhpIHRoZXJlISEhISEhIQo="
};
var acceptableCredential2 = {
    type: "ScopedCred",
    id: "cm9zZXMgYXJlIHJlZCwgdmlvbGV0cyBhcmUgYmx1ZQo="
};

var options = {
                timeoutSeconds: 300,  // 5 minutes
                allowList: [acceptableCredential1, acceptableCredential2];
                extensions: { 'webauthn.txauth.simple':
                   "Wave your hands in the air like you just don’t care" };
              };

webauthnAPI.getAssertion(challenge, options)
    .then(function (assertion) {
    // Send assertion to server for verification
}).catch(function (err) {
    // No acceptable credential or user refused consent. Handle appropriately.
});
</pre>
   <h3 class="heading settled" data-level="10.3" id="sample-decommissioning"><span class="secno">10.3. </span><span class="content">Decommissioning</span><a class="self-link" href="#sample-decommissioning"></a></h3>
   <p>The following are possible situations in which decommissioning a credential might be desired. Note that all of these are
handled on the server side and do not need support from the API specified here.</p>
   <ul>
    <li data-md="">
     <p>Possibility #1 -- user reports the credential as lost.</p>
     <ul>
      <li data-md="">
       <p>User goes to server.example.net, authenticates and follows a link to report a lost/stolen device.</p>
      <li data-md="">
       <p>Server returns a page showing the list of registered credentials with friendly names as configured during registration.</p>
      <li data-md="">
       <p>User selects a credential and the server deletes it from its database.</p>
      <li data-md="">
       <p>In future, the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-25">Relying Party</a> script does not specify this credential in any list of acceptable credentials, and assertions
signed by this credential are rejected.</p>
     </ul>
    <li data-md="">
     <p>Possibility #2 -- server deregisters the credential due to inactivity.</p>
     <ul>
      <li data-md="">
       <p>Server deletes credential from its database during maintenance activity.</p>
      <li data-md="">
       <p>In the future, the Relying Party script does not specify this credential in any list of acceptable credentials, and assertions
signed by this credential are rejected.</p>
     </ul>
    <li data-md="">
     <p>Possibility #3 -- user deletes the credential from the device.</p>
     <ul>
      <li data-md="">
       <p>User employs a device-specific method (e.g., device settings UI) to delete a credential from their device.</p>
      <li data-md="">
       <p>From this point on, this credential will not appear in any selection prompts, and no assertions can be generated with it.</p>
      <li data-md="">
       <p>Sometime later, the server deregisters this credential due to inactivity.</p>
     </ul>
   </ul>
   <h2 class="heading settled" data-level="11" id="acknowledgements"><span class="secno">11. </span><span class="content">Acknowledgements</span><a class="self-link" href="#acknowledgements"></a></h2>
    We thank the following for their contributions to, and thorough review of, this specification: Domenic Denicola, Rahul Ghosh,
Brad Hill, Jing Jin, Anne van Kesteren, Giridhar Mandyam, Axel Nennker, Yaron Sheffer, Mike West, Boris Zbarsky. 
  </main>
<script src="https://www.w3.org/scripts/TR/2016/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#typedefdef-aaguid">AAGUID</a><span>, in §8.3</span>
   <li><a href="#dictdef-account">Account</a><span>, in §4.3</span>
   <li><a href="#accountinformation">accountInformation</a><span>, in §4.1.1</span>
   <li>
    alg
    <ul>
     <li><a href="#dom-packedattestation-alg">attribute for PackedAttestation</a><span>, in §6.2</span>
     <li><a href="#packedattestation-alg">dfn for PackedAttestation</a><span>, in §6.2</span>
     <li><a href="#dom-tpmattestation-alg">attribute for TpmAttestation</a><span>, in §6.3</span>
     <li><a href="#tpmattestation-alg">dfn for TpmAttestation</a><span>, in §6.3</span>
    </ul>
   <li>
    algorithm
    <ul>
     <li><a href="#dom-scopedcredentialparameters-algorithm">dict-member for ScopedCredentialParameters</a><span>, in §4.4</span>
     <li><a href="#scopedcredentialparameters-algorithm">dfn for ScopedCredentialParameters</a><span>, in §4.4</span>
    </ul>
   <li><a href="#dictdef-algorithmidentifier">AlgorithmIdentifier</a><span>, in §2.1</span>
   <li>
    allowList
    <ul>
     <li><a href="#dom-assertionoptions-allowlist">dict-member for AssertionOptions</a><span>, in §4.7</span>
     <li><a href="#assertionoptions-allowlist">dfn for AssertionOptions</a><span>, in §4.7</span>
    </ul>
   <li><a href="#androidkeyattestation">AndroidKeyAttestation</a><span>, in §6.4</span>
   <li><a href="#androidsafetynetattestation">AndroidSafetyNetAttestation</a><span>, in §6.5</span>
   <li><a href="#ascii-case-insensitive-match">ASCII case-insensitive match</a><span>, in §3</span>
   <li><a href="#assertion">Assertion</a><span>, in §3</span>
   <li><a href="#assertionchallenge">assertionChallenge</a><span>, in §4.1.2</span>
   <li><a href="#dictdef-assertionoptions">AssertionOptions</a><span>, in §4.7</span>
   <li><a href="#enumdef-attachment">Attachment</a><span>, in §4.5.1</span>
   <li>
    attachment
    <ul>
     <li><a href="#dom-scopedcredentialoptions-attachment">dict-member for ScopedCredentialOptions</a><span>, in §4.5</span>
     <li><a href="#scopedcredentialoptions-attachment">dfn for ScopedCredentialOptions</a><span>, in §4.5</span>
    </ul>
   <li><a href="#attestation">Attestation</a><span>, in §3</span>
   <li>
    attestation
    <ul>
     <li><a href="#dom-scopedcredentialinfo-attestation">attribute for ScopedCredentialInfo</a><span>, in §4.2</span>
     <li><a href="#scopedcredentialinfo-attestation">dfn for ScopedCredentialInfo</a><span>, in §4.2</span>
     <li><a href="#dom-authenticationattestation-attestation">attribute for AuthenticationAttestation</a><span>, in §4.9</span>
     <li><a href="#authenticationattestation-attestation">dfn for AuthenticationAttestation</a><span>, in §4.9</span>
    </ul>
   <li><a href="#attestation-certificate">Attestation Certificate</a><span>, in §3</span>
   <li><a href="#attestationchallenge">attestationChallenge</a><span>, in §4.1.1</span>
   <li><a href="#attestation-format">attestation format</a><span>, in §5.3</span>
   <li><a href="#attestation-format-identifier">attestation format identifier</a><span>, in §6.1</span>
   <li><a href="#attestation-information">Attestation information</a><span>, in §3</span>
   <li><a href="#attestation-key-pair">attestation key pair</a><span>, in §3</span>
   <li><a href="#attestation-private-key">attestation private key</a><span>, in §3</span>
   <li><a href="#attestation-public-key">attestation public key</a><span>, in §3</span>
   <li><a href="#authenticationattestation-attestation-statement">attestation statement</a><span>, in §4.9</span>
   <li><a href="#attestation-type">attestation type</a><span>, in §5.3</span>
   <li><a href="#atttobesigned">attToBeSigned</a><span>, in §5.3.3</span>
   <li><a href="#authentication">Authentication</a><span>, in §3</span>
   <li><a href="#dom-navigator-authentication">authentication</a><span>, in §4</span>
   <li><a href="#authentication-assertion">Authentication Assertion</a><span>, in §3</span>
   <li><a href="#authenticationassertion">AuthenticationAssertion</a><span>, in §4.6</span>
   <li><a href="#authenticationattestation">AuthenticationAttestation</a><span>, in §4.9</span>
   <li><a href="#dictdef-authenticationextensions">AuthenticationExtensions</a><span>, in §4.8</span>
   <li><a href="#authenticator">Authenticator</a><span>, in §3</span>
   <li><a href="#authenticator-argument">authenticator argument</a><span>, in §7.3</span>
   <li><a href="#authenticatorcancel">authenticatorCancel</a><span>, in §5.1.3</span>
   <li><a href="#authenticator-data">authenticator data</a><span>, in §5.2.1</span>
   <li>
    authenticatorData
    <ul>
     <li><a href="#dom-authenticationassertion-authenticatordata">attribute for AuthenticationAssertion</a><span>, in §4.6</span>
     <li><a href="#dom-authenticationattestation-authenticatordata">attribute for AuthenticationAttestation</a><span>, in §4.9</span>
     <li><a href="#authenticatordata">definition of</a><span>, in §5.2.1</span>
    </ul>
   <li><a href="#authenticatorgetassertion">authenticatorGetAssertion</a><span>, in §5.1.2</span>
   <li><a href="#authenticatormakecredential">authenticatorMakeCredential</a><span>, in §5.1.1</span>
   <li>
    AuthenticatorSelectionList
    <ul>
     <li><a href="#typedefdef-authenticatorselectionlist">(typedef)</a><span>, in §8.3</span>
     <li><a href="#authenticatorselectionlist">definition of</a><span>, in §8.3</span>
    </ul>
   <li><a href="#authorization-gesture">Authorization Gesture</a><span>, in §3</span>
   <li><a href="#base64url-encoding">Base64url Encoding</a><span>, in §2.1</span>
   <li><a href="#basic-attestation">Basic Attestation</a><span>, in §5.3.2</span>
   <li><a href="#dom-transport-ble">"ble"</a><span>, in §4.10.5</span>
   <li>
    ble
    <ul>
     <li><a href="#dom-transport-ble">enum-value for Transport</a><span>, in §4.10.5</span>
     <li><a href="#transport-ble">dfn for Transport</a><span>, in §4.10.5</span>
    </ul>
   <li><a href="#ceremony">Ceremony</a><span>, in §3</span>
   <li><a href="#dom-tpmattestation-certifyinfo">certifyInfo</a><span>, in §6.3</span>
   <li>
    challenge
    <ul>
     <li><a href="#dom-clientdata-challenge">dict-member for ClientData</a><span>, in §4.10.1</span>
     <li><a href="#clientdata-challenge">dfn for ClientData</a><span>, in §4.10.1</span>
    </ul>
   <li><a href="#client">Client</a><span>, in §3</span>
   <li><a href="#client-argument">client argument</a><span>, in §7.3</span>
   <li>
    clientData
    <ul>
     <li><a href="#dom-authenticationassertion-clientdata">attribute for AuthenticationAssertion</a><span>, in §4.6</span>
     <li><a href="#authenticationassertion-clientdata">dfn for AuthenticationAssertion</a><span>, in §4.6</span>
     <li><a href="#dom-authenticationattestation-clientdata">attribute for AuthenticationAttestation</a><span>, in §4.9</span>
     <li><a href="#authenticationattestation-clientdata">dfn for AuthenticationAttestation</a><span>, in §4.9</span>
    </ul>
   <li><a href="#dictdef-clientdata">ClientData</a><span>, in §4.10.1</span>
   <li><a href="#clientdatahash">clientDataHash</a><span>, in §4.10.1</span>
   <li><a href="#clientdatajson">clientDataJSON</a><span>, in §4.10.1</span>
   <li><a href="#conforming-user-agent">Conforming User Agent</a><span>, in §3</span>
   <li><a href="#content">content</a><span>, in §8.2</span>
   <li><a href="#contenttype">contentType</a><span>, in §8.2</span>
   <li>
    credential
    <ul>
     <li><a href="#dom-scopedcredentialinfo-credential">attribute for ScopedCredentialInfo</a><span>, in §4.2</span>
     <li><a href="#scopedcredentialinfo-credential">dfn for ScopedCredentialInfo</a><span>, in §4.2</span>
     <li><a href="#dom-authenticationassertion-credential">attribute for AuthenticationAssertion</a><span>, in §4.6</span>
     <li><a href="#authenticationassertion-credential">dfn for AuthenticationAssertion</a><span>, in §4.6</span>
    </ul>
   <li><a href="#credential-key-pair">credential key pair</a><span>, in §3</span>
   <li><a href="#credential-private-key">credential private key</a><span>, in §3</span>
   <li><a href="#credential-public-key">Credential Public Key</a><span>, in §3</span>
   <li><a href="#dom-attachment-cross-platform">cross-platform</a><span>, in §4.5.1</span>
   <li><a href="#dom-attachment-cross-platform">"cross-platform"</a><span>, in §4.5.1</span>
   <li><a href="#attachment-cross-platform-attached">cross-platform attached</a><span>, in §4.5.1</span>
   <li><a href="#attachment-cross-platform-attached">cross-platform attachment</a><span>, in §4.5.1</span>
   <li><a href="#cryptoparameters">cryptoParameters</a><span>, in §4.1.1</span>
   <li>
    daaKey
    <ul>
     <li><a href="#dom-packedattestation-daakey">attribute for PackedAttestation</a><span>, in §6.2</span>
     <li><a href="#dom-tpmattestation-daakey">attribute for TpmAttestation</a><span>, in §6.3</span>
    </ul>
   <li><a href="#direct-anonymous-attestation">Direct Anonymous Attestation</a><span>, in §5.3.2</span>
   <li>
    displayName
    <ul>
     <li><a href="#dom-account-displayname">dict-member for Account</a><span>, in §4.3</span>
     <li><a href="#account-displayname">dfn for Account</a><span>, in §4.3</span>
    </ul>
   <li><a href="#domexception">DOMException</a><span>, in §2.1</span>
   <li>
    excludeList
    <ul>
     <li><a href="#dom-scopedcredentialoptions-excludelist">dict-member for ScopedCredentialOptions</a><span>, in §4.5</span>
     <li><a href="#scopedcredentialoptions-excludelist">dfn for ScopedCredentialOptions</a><span>, in §4.5</span>
    </ul>
   <li><a href="#extension-identifier">extension identifier</a><span>, in §7.1</span>
   <li>
    extensions
    <ul>
     <li><a href="#dom-scopedcredentialoptions-extensions">dict-member for ScopedCredentialOptions</a><span>, in §4.5</span>
     <li><a href="#scopedcredentialoptions-extensions">dfn for ScopedCredentialOptions</a><span>, in §4.5</span>
     <li><a href="#dom-assertionoptions-extensions">dict-member for AssertionOptions</a><span>, in §4.7</span>
     <li><a href="#assertionoptions-extensions">dfn for AssertionOptions</a><span>, in §4.7</span>
     <li><a href="#dom-clientdata-extensions">dict-member for ClientData</a><span>, in §4.10.1</span>
     <li><a href="#clientdata-extensions">dfn for ClientData</a><span>, in §4.10.1</span>
    </ul>
   <li><a href="#enumdef-externaltransport">ExternalTransport</a><span>, in §4.10.5</span>
   <li>
    format
    <ul>
     <li><a href="#dom-authenticationattestation-format">attribute for AuthenticationAttestation</a><span>, in §4.9</span>
     <li><a href="#authenticationattestation-format">dfn for AuthenticationAttestation</a><span>, in §4.9</span>
    </ul>
   <li><a href="#dom-webauthentication-getassertion">getAssertion(assertionChallenge)</a><span>, in §4.1.2</span>
   <li><a href="#dom-webauthentication-getassertion">getAssertion(assertionChallenge, options)</a><span>, in §4.1.2</span>
   <li>
    hashAlg
    <ul>
     <li><a href="#dom-clientdata-hashalg">dict-member for ClientData</a><span>, in §4.10.1</span>
     <li><a href="#clientdata-hashalg">dfn for ClientData</a><span>, in §4.10.1</span>
    </ul>
   <li>
    id
    <ul>
     <li><a href="#dom-account-id">dict-member for Account</a><span>, in §4.3</span>
     <li><a href="#account-id">dfn for Account</a><span>, in §4.3</span>
     <li><a href="#dom-scopedcredential-id">attribute for ScopedCredential</a><span>, in §4.10.3</span>
     <li><a href="#scopedcredential-id">dfn for ScopedCredential</a><span>, in §4.10.3</span>
     <li><a href="#dom-scopedcredentialdescriptor-id">dict-member for ScopedCredentialDescriptor</a><span>, in §4.10.4</span>
     <li><a href="#scopedcredentialdescriptor-id">dfn for ScopedCredentialDescriptor</a><span>, in §4.10.4</span>
    </ul>
   <li>
    imageURL
    <ul>
     <li><a href="#dom-account-imageurl">dict-member for Account</a><span>, in §4.3</span>
     <li><a href="#account-imageurl">dfn for Account</a><span>, in §4.3</span>
    </ul>
   <li><a href="#dom-webauthentication-makecredential">makeCredential(accountInformation, cryptoParameters, attestationChallenge)</a><span>, in §4.1.1</span>
   <li><a href="#dom-webauthentication-makecredential">makeCredential(accountInformation, cryptoParameters, attestationChallenge, options)</a><span>, in §4.1.1</span>
   <li>
    name
    <ul>
     <li><a href="#dom-account-name">dict-member for Account</a><span>, in §4.3</span>
     <li><a href="#account-name">dfn for Account</a><span>, in §4.3</span>
    </ul>
   <li>
    nfc
    <ul>
     <li><a href="#dom-transport-nfc">enum-value for Transport</a><span>, in §4.10.5</span>
     <li><a href="#transport-nfc">dfn for Transport</a><span>, in §4.10.5</span>
    </ul>
   <li><a href="#dom-transport-nfc">"nfc"</a><span>, in §4.10.5</span>
   <li>
    options
    <ul>
     <li><a href="#makecredential-options">dfn for makeCredential()</a><span>, in §4.1.1</span>
     <li><a href="#getassertion-options">dfn for getAssertion()</a><span>, in §4.1.2</span>
    </ul>
   <li>
    origin
    <ul>
     <li><a href="#dom-clientdata-origin">dict-member for ClientData</a><span>, in §4.10.1</span>
     <li><a href="#clientdata-origin">dfn for ClientData</a><span>, in §4.10.1</span>
    </ul>
   <li><a href="#packedattestation">PackedAttestation</a><span>, in §6.2</span>
   <li><a href="#dom-attachment-platform">platform</a><span>, in §4.5.1</span>
   <li><a href="#dom-attachment-platform">"platform"</a><span>, in §4.5.1</span>
   <li><a href="#attachment-platform-attachment">platform attachment</a><span>, in §4.5.1</span>
   <li><a href="#attachment-platform-authenticators">platform authenticators</a><span>, in §4.5.1</span>
   <li><a href="#privacy-ca">Privacy CA</a><span>, in §5.3.2</span>
   <li><a href="#promises">Promises</a><span>, in §2.1</span>
   <li><a href="#registration">Registration</a><span>, in §3</span>
   <li><a href="#relying-party">Relying Party</a><span>, in §3</span>
   <li><a href="#relying-party-identifier">Relying Party Identifier</a><span>, in §3</span>
   <li><a href="#attachment-roaming-authenticators">roaming authenticators</a><span>, in §4.5.1</span>
   <li>
    rpDisplayName
    <ul>
     <li><a href="#dom-account-rpdisplayname">dict-member for Account</a><span>, in §4.3</span>
     <li><a href="#account-rpdisplayname">dfn for Account</a><span>, in §4.3</span>
    </ul>
   <li>
    rpId
    <ul>
     <li><a href="#dom-scopedcredentialoptions-rpid">dict-member for ScopedCredentialOptions</a><span>, in §4.5</span>
     <li><a href="#scopedcredentialoptions-rpid">dfn for ScopedCredentialOptions</a><span>, in §4.5</span>
     <li><a href="#dom-assertionoptions-rpid">dict-member for AssertionOptions</a><span>, in §4.7</span>
     <li><a href="#assertionoptions-rpid">dfn for AssertionOptions</a><span>, in §4.7</span>
    </ul>
   <li><a href="#rp-id">RP ID</a><span>, in §3</span>
   <li>
    safetyNetResponse
    <ul>
     <li><a href="#dom-androidsafetynetattestation-safetynetresponse">attribute for AndroidSafetyNetAttestation</a><span>, in §6.5</span>
     <li><a href="#androidsafetynetattestation-safetynetresponse">dfn for AndroidSafetyNetAttestation</a><span>, in §6.5</span>
    </ul>
   <li>
    ScopedCred
    <ul>
     <li><a href="#dom-scopedcredentialtype-scopedcred">enum-value for ScopedCredentialType</a><span>, in §4.10.2</span>
     <li><a href="#scopedcredentialtype-scopedcred">dfn for ScopedCredentialType</a><span>, in §4.10.2</span>
    </ul>
   <li><a href="#dom-scopedcredentialtype-scopedcred">"ScopedCred"</a><span>, in §4.10.2</span>
   <li><a href="#scoped-credential">Scoped Credential</a><span>, in §3</span>
   <li><a href="#scopedcredential">ScopedCredential</a><span>, in §4.10.3</span>
   <li><a href="#dictdef-scopedcredentialdescriptor">ScopedCredentialDescriptor</a><span>, in §4.10.4</span>
   <li><a href="#scopedcredentialinfo">ScopedCredentialInfo</a><span>, in §4.2</span>
   <li><a href="#dictdef-scopedcredentialoptions">ScopedCredentialOptions</a><span>, in §4.5</span>
   <li><a href="#dictdef-scopedcredentialparameters">ScopedCredentialParameters</a><span>, in §4.4</span>
   <li><a href="#enumdef-scopedcredentialtype">ScopedCredentialType</a><span>, in §4.10.2</span>
   <li><a href="#secure-contexts">secure contexts</a><span>, in §4</span>
   <li><a href="#self-attestation">Self Attestation</a><span>, in §5.3.2</span>
   <li>
    signature
    <ul>
     <li><a href="#dom-authenticationassertion-signature">attribute for AuthenticationAssertion</a><span>, in §4.6</span>
     <li><a href="#authenticationassertion-signature">dfn for AuthenticationAssertion</a><span>, in §4.6</span>
     <li><a href="#dom-packedattestation-signature">attribute for PackedAttestation</a><span>, in §6.2</span>
     <li><a href="#packedattestation-signature">dfn for PackedAttestation</a><span>, in §6.2</span>
     <li><a href="#dom-tpmattestation-signature">attribute for TpmAttestation</a><span>, in §6.3</span>
     <li><a href="#tpmattestation-signature">dfn for TpmAttestation</a><span>, in §6.3</span>
     <li><a href="#dom-androidkeyattestation-signature">attribute for AndroidKeyAttestation</a><span>, in §6.4</span>
     <li><a href="#androidkeyattestation-signature">dfn for AndroidKeyAttestation</a><span>, in §6.4</span>
    </ul>
   <li>
    timeoutSeconds
    <ul>
     <li><a href="#dom-scopedcredentialoptions-timeoutseconds">dict-member for ScopedCredentialOptions</a><span>, in §4.5</span>
     <li><a href="#scopedcredentialoptions-timeoutseconds">dfn for ScopedCredentialOptions</a><span>, in §4.5</span>
     <li><a href="#dom-assertionoptions-timeoutseconds">dict-member for AssertionOptions</a><span>, in §4.7</span>
     <li><a href="#assertionoptions-timeoutseconds">dfn for AssertionOptions</a><span>, in §4.7</span>
    </ul>
   <li>
    tokenBinding
    <ul>
     <li><a href="#dom-clientdata-tokenbinding">dict-member for ClientData</a><span>, in §4.10.1</span>
     <li><a href="#clientdata-tokenbinding">dfn for ClientData</a><span>, in §4.10.1</span>
    </ul>
   <li><a href="#tpmattestation">TpmAttestation</a><span>, in §6.3</span>
   <li>
    tpmVersion
    <ul>
     <li><a href="#dom-tpmattestation-tpmversion">attribute for TpmAttestation</a><span>, in §6.3</span>
     <li><a href="#tpmattestation-tpmversion">dfn for TpmAttestation</a><span>, in §6.3</span>
    </ul>
   <li><a href="#enumdef-transport">Transport</a><span>, in §4.10.5</span>
   <li><a href="#dom-scopedcredentialdescriptor-transports">transports</a><span>, in §4.10.4</span>
   <li>
    type
    <ul>
     <li><a href="#dom-scopedcredentialparameters-type">dict-member for ScopedCredentialParameters</a><span>, in §4.4</span>
     <li><a href="#scopedcredentialparameters-type">dfn for ScopedCredentialParameters</a><span>, in §4.4</span>
     <li><a href="#dom-scopedcredential-type">attribute for ScopedCredential</a><span>, in §4.10.3</span>
     <li><a href="#scopedcredential-type">dfn for ScopedCredential</a><span>, in §4.10.3</span>
     <li><a href="#dom-scopedcredentialdescriptor-type">dict-member for ScopedCredentialDescriptor</a><span>, in §4.10.4</span>
     <li><a href="#scopedcredentialdescriptor-type">dfn for ScopedCredentialDescriptor</a><span>, in §4.10.4</span>
    </ul>
   <li><a href="#dom-transport-usb">"usb"</a><span>, in §4.10.5</span>
   <li>
    usb
    <ul>
     <li><a href="#dom-transport-usb">enum-value for Transport</a><span>, in §4.10.5</span>
     <li><a href="#transport-usb">dfn for Transport</a><span>, in §4.10.5</span>
    </ul>
   <li><a href="#user-consent">User Consent</a><span>, in §3</span>
   <li><a href="#user-verification">User Verification</a><span>, in §3</span>
   <li>
    version
    <ul>
     <li><a href="#dom-androidsafetynetattestation-version">attribute for AndroidSafetyNetAttestation</a><span>, in §6.5</span>
     <li><a href="#androidsafetynetattestation-version">dfn for AndroidSafetyNetAttestation</a><span>, in §6.5</span>
    </ul>
   <li><a href="#webauthentication">WebAuthentication</a><span>, in §4.1</span>
   <li><a href="#web-authentication-api">Web Authentication API</a><span>, in §4</span>
   <li><a href="#webauthn-client">WebAuthn Client</a><span>, in §3</span>
   <li>
    x5c
    <ul>
     <li><a href="#dom-packedattestation-x5c">attribute for PackedAttestation</a><span>, in §6.2</span>
     <li><a href="#packedattestation-x5c">dfn for PackedAttestation</a><span>, in §6.2</span>
     <li><a href="#dom-tpmattestation-x5c">attribute for TpmAttestation</a><span>, in §6.3</span>
     <li><a href="#tpmattestation-x5c">dfn for TpmAttestation</a><span>, in §6.3</span>
    </ul>
  </ul>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[WHATWG-ENCODING]</a> defines the following terms:
    <ul>
     <li><a href="https://encoding.spec.whatwg.org/#utf-8-encode">utf-8 encode</a>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><a href="https://html.spec.whatwg.org/multipage/webappapis.html#navigator">Navigator</a>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML51]</a> defines the following terms:
    <ul>
     <li><a href="https://www.w3.org/TR/html51/webappapis.html#current-settings-object">current settings object</a>
     <li><a href="https://www.w3.org/TR/html51/webappapis.html#the-navigator-object">navigator</a>
     <li><a href="https://www.w3.org/TR/html51/browsers.html#opaque-origin">opaque origin</a>
     <li><a href="https://www.w3.org/TR/html51/browsers.html#concept-cross-origin">origin</a>
     <li><a href="https://www.w3.org/TR/html51/browsers.html#relaxing-the-same-origin-restriction">relaxing the same-origin restriction</a>
    </ul>
   <li>
    <a data-link-type="biblio">[WebCryptoAPI]</a> defines the following terms:
    <ul>
     <li><a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-normalize-an-algorithm">normalizing an algorithm</a>
    </ul>
   <li>
    <a data-link-type="biblio">[WebIDL-1]</a> defines the following terms:
    <ul>
     <li><a href="https://heycam.github.io/webidl/#BufferSource">BufferSource</a>
     <li><a href="https://heycam.github.io/webidl/#SecureContext">SecureContext</a>
     <li><a href="https://heycam.github.io/webidl/#dfn-present">present</a>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-dom4">[DOM4]
   <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/">DOM Standard</a>. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-fidoecdaaalgorithm">[FIDOEcdaaAlgorithm]
   <dd>R. Lindemann; A. Edgington; R. Urian. FIDO ECDAA Algorithm. FIDO Alliance Proposed Standard (To Be Published). 
   <dt id="biblio-fidoreg">[FIDOReg]
   <dd>R. Lindemann; D. Baghdasaryan; B. Hill. <a href="https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-uaf-reg-v1.0-ps-20141208.html">FIDO UAF Registry of Predefined Values</a>. FIDO Alliance Proposed Standard. URL: <a href="https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-uaf-reg-v1.0-ps-20141208.html">https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-uaf-reg-v1.0-ps-20141208.html</a>
   <dt id="biblio-fips-180-4">[FIPS-180-4]
   <dd><a href="http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">FIPS PUB 180-4 Secure Hash Standard</a>. URL: <a href="http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf</a>
   <dt id="biblio-html">[HTML]
   <dd>Ian Hickson. <a href="https://html.spec.whatwg.org/multipage/">HTML Standard</a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-html51">[HTML51]
   <dd>Steve Faulkner; et al. <a href="https://w3c.github.io/html/">HTML 5.1</a>. URL: <a href="https://w3c.github.io/html/">https://w3c.github.io/html/</a>
   <dt id="biblio-oscca-sm3">[OSCCA-SM3]
   <dd><a href="http://www.oscca.gov.cn/UpFile/20101222141857786.pdf">SM3 Cryptographic Hash Algorithm</a>. December 2010. URL: <a href="http://www.oscca.gov.cn/UpFile/20101222141857786.pdf">http://www.oscca.gov.cn/UpFile/20101222141857786.pdf</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
   <dt id="biblio-rfc4648">[RFC4648]
   <dd>S. Josefsson. <a href="https://tools.ietf.org/html/rfc4648">The Base16, Base32, and Base64 Data Encodings</a>. October 2006. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc4648">https://tools.ietf.org/html/rfc4648</a>
   <dt id="biblio-rfc5234">[RFC5234]
   <dd>D. Crocker, Ed.; P. Overell. <a href="https://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>. January 2008. Internet Standard. URL: <a href="https://tools.ietf.org/html/rfc5234">https://tools.ietf.org/html/rfc5234</a>
   <dt id="biblio-rfc5890">[RFC5890]
   <dd>J. Klensin. <a href="https://tools.ietf.org/html/rfc5890">Internationalized Domain Names for Applications (IDNA): Definitions and Document Framework</a>. August 2010. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc5890">https://tools.ietf.org/html/rfc5890</a>
   <dt id="biblio-rfc7515">[RFC7515]
   <dd>M. Jones; J. Bradley; N. Sakimura. <a href="https://tools.ietf.org/html/rfc7515">JSON Web Signature (JWS)</a>. May 2015. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc7515">https://tools.ietf.org/html/rfc7515</a>
   <dt id="biblio-rfc7518">[RFC7518]
   <dd>M. Jones. <a href="https://tools.ietf.org/html/rfc7518">JSON Web Algorithms (JWA)</a>. May 2015. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc7518">https://tools.ietf.org/html/rfc7518</a>
   <dt id="biblio-sec1">[SEC1]
   <dd><a href="http://www.secg.org/sec1-v2.pdf">SEC1: Elliptic Curve Cryptography, Version 2.0</a>. URL: <a href="http://www.secg.org/sec1-v2.pdf">http://www.secg.org/sec1-v2.pdf</a>
   <dt id="biblio-webcryptoapi">[WebCryptoAPI]
   <dd>Ryan Sleevi; Mark Watson. <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html">Web Cryptography API</a>. URL: <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html">https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html</a>
   <dt id="biblio-webidl-1">[WebIDL-1]
   <dd>Cameron McCormack; Boris Zbarsky. <a href="https://heycam.github.io/webidl/">WebIDL Level 1</a>. URL: <a href="https://heycam.github.io/webidl/">https://heycam.github.io/webidl/</a>
   <dt id="biblio-whatwg-encoding">[WHATWG-ENCODING]
   <dd>Anne van Kesteren. <a href="https://encoding.spec.whatwg.org/">Encoding Standard</a>. Living Standard. URL: <a href="https://encoding.spec.whatwg.org/">https://encoding.spec.whatwg.org/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-ceremony">[Ceremony]
   <dd>Carl Ellison. <a href="https://eprint.iacr.org/2007/399.pdf">Ceremony Design and Analysis</a>. 2007. URL: <a href="https://eprint.iacr.org/2007/399.pdf">https://eprint.iacr.org/2007/399.pdf</a>
   <dt id="biblio-fido-appid">[FIDO-APPID]
   <dd><a href="https://fidoalliance.org/specs/fido-appid-and-facets-ps-20150514.pdf">FIDO AppID and Facet Specification</a>. 14 May 2015. URL: <a href="https://fidoalliance.org/specs/fido-appid-and-facets-ps-20150514.pdf">https://fidoalliance.org/specs/fido-appid-and-facets-ps-20150514.pdf</a>
   <dt id="biblio-fidometadataservice">[FIDOMetadataService]
   <dd>R. Lindemann; B. Hill; D. Baghdasaryan. <a href="https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-uaf-metadata-service-v1.0-ps-20141208.html">FIDO Metadata Service v1.0</a>. FIDO Alliance Proposed Standard. URL: <a href="https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-uaf-metadata-service-v1.0-ps-20141208.html">https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-uaf-metadata-service-v1.0-ps-20141208.html</a>
   <dt id="biblio-fidosecref">[FIDOSecRef]
   <dd>R. Lindemann; D. Baghdasaryan; B. Hill. <a href="https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-security-ref-v1.0-ps-20141208.html">FIDO Security Reference</a>. FIDO Alliance Proposed Standard. URL: <a href="https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-security-ref-v1.0-ps-20141208.html">https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-security-ref-v1.0-ps-20141208.html</a>
   <dt id="biblio-geojson">[GeoJSON]
   <dd><a href="http://geojson.org/geojson-spec.html">The GeoJSON Format Specification</a>. URL: <a href="http://geojson.org/geojson-spec.html">http://geojson.org/geojson-spec.html</a>
   <dt id="biblio-rfc3447">[RFC3447]
   <dd>J. Jonsson; B. Kaliski. <a href="https://tools.ietf.org/html/rfc3447">Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1</a>. February 2003. Informational. URL: <a href="https://tools.ietf.org/html/rfc3447">https://tools.ietf.org/html/rfc3447</a>
   <dt id="biblio-rfc4055">[RFC4055]
   <dd>J. Schaad; B. Kaliski; R. Housley. <a href="https://tools.ietf.org/html/rfc4055">Additional Algorithms and Identifiers for RSA Cryptography for use in the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>. June 2005. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc4055">https://tools.ietf.org/html/rfc4055</a>
   <dt id="biblio-rfc4949">[RFC4949]
   <dd>R. Shirey. <a href="https://tools.ietf.org/html/rfc4949">Internet Security Glossary, Version 2</a>. August 2007. Informational. URL: <a href="https://tools.ietf.org/html/rfc4949">https://tools.ietf.org/html/rfc4949</a>
   <dt id="biblio-rfc5280">[RFC5280]
   <dd>D. Cooper; et al. <a href="https://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>. May 2008. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc5280">https://tools.ietf.org/html/rfc5280</a>
   <dt id="biblio-rfc6454">[RFC6454]
   <dd>A. Barth. <a href="https://tools.ietf.org/html/rfc6454">The Web Origin Concept</a>. December 2011. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc6454">https://tools.ietf.org/html/rfc6454</a>
   <dt id="biblio-rfc7049">[RFC7049]
   <dd>C. Bormann; P. Hoffman. <a href="https://tools.ietf.org/html/rfc7049">Concise Binary Object Representation (CBOR)</a>. October 2013. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc7049">https://tools.ietf.org/html/rfc7049</a>
   <dt id="biblio-rfc7159">[RFC7159]
   <dd>T. Bray, Ed.. <a href="https://tools.ietf.org/html/rfc7159">The JavaScript Object Notation (JSON) Data Interchange Format</a>. March 2014. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc7159">https://tools.ietf.org/html/rfc7159</a>
   <dt id="biblio-secure-contexts">[SECURE-CONTEXTS]
   <dd>Mike West. <a href="https://w3c.github.io/webappsec-secure-contexts/">Secure Contexts</a>. URL: <a href="https://w3c.github.io/webappsec-secure-contexts/">https://w3c.github.io/webappsec-secure-contexts/</a>
   <dt id="biblio-sp800-107r1">[SP800-107r1]
   <dd>Quynh Dang. <a href="http://csrc.nist.gov/publications/nistpubs/800-107-rev1/sp800-107-rev1.pdf">NIST Special Publication 800-107: Recommendation for Applications Using Approved Hash Algorithms</a>. August 2012. URL: <a href="http://csrc.nist.gov/publications/nistpubs/800-107-rev1/sp800-107-rev1.pdf">http://csrc.nist.gov/publications/nistpubs/800-107-rev1/sp800-107-rev1.pdf</a>
   <dt id="biblio-tpmv1-2-credential-profiles">[TPMv1-2-Credential-Profiles]
   <dd><a href="http://www.trustedcomputinggroup.org/wp-content/uploads/Credential_Profiles_V1.2_Level2_Revision8.pdf">TCG Credential Profiles for TPM Family 1.2</a>. URL: <a href="http://www.trustedcomputinggroup.org/wp-content/uploads/Credential_Profiles_V1.2_Level2_Revision8.pdf">http://www.trustedcomputinggroup.org/wp-content/uploads/Credential_Profiles_V1.2_Level2_Revision8.pdf</a>
   <dt id="biblio-tpmv1-2-part3">[TPMv1-2-Part3]
   <dd><a href="http://www.trustedcomputinggroup.org/wp-content/uploads/TPM-Main-Part-3-TPM-Commands_v1.2_rev116_01032011.pdf">TPM Main Part 3: TPM Commands</a>. URL: <a href="http://www.trustedcomputinggroup.org/wp-content/uploads/TPM-Main-Part-3-TPM-Commands_v1.2_rev116_01032011.pdf">http://www.trustedcomputinggroup.org/wp-content/uploads/TPM-Main-Part-3-TPM-Commands_v1.2_rev116_01032011.pdf</a>
   <dt id="biblio-tpmv2-ek-profile">[TPMv2-EK-Profile]
   <dd><a href="http://www.trustedcomputinggroup.org/wp-content/uploads/Credential_Profile_EK_V2.0_R14_published.pdf">TCG EK Credential Profile for TPM Family 2.0</a>. URL: <a href="http://www.trustedcomputinggroup.org/wp-content/uploads/Credential_Profile_EK_V2.0_R14_published.pdf">http://www.trustedcomputinggroup.org/wp-content/uploads/Credential_Profile_EK_V2.0_R14_published.pdf</a>
   <dt id="biblio-tpmv2-part3">[TPMv2-Part3]
   <dd><a href="http://www.trustedcomputinggroup.org/wp-content/uploads/TPM-Rev-2.0-Part-3-Commands-01.16-1.pdf">Trusted Platform Module Library, Part 3: Commands</a>. URL: <a href="http://www.trustedcomputinggroup.org/wp-content/uploads/TPM-Rev-2.0-Part-3-Commands-01.16-1.pdf">http://www.trustedcomputinggroup.org/wp-content/uploads/TPM-Rev-2.0-Part-3-Commands-01.16-1.pdf</a>
   <dt id="biblio-uafprotocol">[UAFProtocol]
   <dd>R. Lindemann; et al. <a href="https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-uaf-protocol-v1.0-ps-20141208.html">FIDO UAF Protocol Specification v1.0</a>. FIDO Alliance Proposed Standard. URL: <a href="https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-uaf-protocol-v1.0-ps-20141208.html">https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-uaf-protocol-v1.0-ps-20141208.html</a>
   <dt id="biblio-webauthn-registries">[WebAuthn-Registries]
   <dd>Jeff Hodges. <a href="https://xml2rfc.tools.ietf.org/cgi-bin/xml2rfc.cgi?modeAsFormat=html/ascii&amp;url=https://raw.githubusercontent.com/w3c/webauthn/master/draft-hodges-webauthn-registries.xml#46923110554855074732">Registries for Web Authentication (WebAuthn)</a>. June 2016. Active Internet-Draft. URL: <a href="https://xml2rfc.tools.ietf.org/cgi-bin/xml2rfc.cgi?modeAsFormat=html/ascii&amp;url=https://raw.githubusercontent.com/w3c/webauthn/master/draft-hodges-webauthn-registries.xml#46923110554855074732">https://xml2rfc.tools.ietf.org/cgi-bin/xml2rfc.cgi?modeAsFormat=html/ascii&amp;url=https://raw.githubusercontent.com/w3c/webauthn/master/draft-hodges-webauthn-registries.xml#46923110554855074732</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl def"><span class="kt">partial</span> <span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/webappapis.html#navigator">Navigator</a> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#webauthentication">WebAuthentication</a> <a class="nv" data-readonly="" data-type="WebAuthentication" href="#dom-navigator-authentication">authentication</a>;
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext">SecureContext</a>]
<span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="#webauthentication">WebAuthentication</a> {
    <span class="kt">Promise</span> &lt; <a class="n" data-link-type="idl-name" href="#scopedcredentialinfo">ScopedCredentialInfo</a> > <a class="nv idl-code" data-link-type="method" href="#dom-webauthentication-makecredential">makeCredential</a> (
        <a class="n" data-link-type="idl-name" href="#dictdef-account">Account</a>                                 <a class="nv" href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-accountinformation">accountInformation</a>,
        <span class="kt">sequence</span> &lt; <a class="n" data-link-type="idl-name" href="#dictdef-scopedcredentialparameters">ScopedCredentialParameters</a> > <a class="nv" href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-cryptoparameters">cryptoParameters</a>,
        <a class="n" data-link-type="idl-name" href="https://heycam.github.io/webidl/#BufferSource">BufferSource</a>                            <a class="nv" href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-attestationchallenge">attestationChallenge</a>,
        <span class="kt">optional</span> <a class="n" data-link-type="idl-name" href="#dictdef-scopedcredentialoptions">ScopedCredentialOptions</a>        <a class="nv" href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options">options</a>
    );

    <span class="kt">Promise</span> &lt; <a class="n" data-link-type="idl-name" href="#authenticationassertion">AuthenticationAssertion</a> > <a class="nv idl-code" data-link-type="method" href="#dom-webauthentication-getassertion">getAssertion</a> (
        <a class="n" data-link-type="idl-name" href="https://heycam.github.io/webidl/#BufferSource">BufferSource</a>                    <a class="nv" href="#dom-webauthentication-getassertion-assertionchallenge-options-assertionchallenge">assertionChallenge</a>,
        <span class="kt">optional</span> <a class="n" data-link-type="idl-name" href="#dictdef-assertionoptions">AssertionOptions</a>       <a class="nv" href="#dom-webauthentication-getassertion-assertionchallenge-options-options">options</a>
    );
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext">SecureContext</a>]
<span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="#scopedcredentialinfo">ScopedCredentialInfo</a> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#scopedcredential">ScopedCredential</a>           <a class="nv" data-readonly="" data-type="ScopedCredential" href="#dom-scopedcredentialinfo-credential">credential</a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#authenticationattestation">AuthenticationAttestation</a>  <a class="nv" data-readonly="" data-type="AuthenticationAttestation" href="#dom-scopedcredentialinfo-attestation">attestation</a>;
};

<span class="kt">dictionary</span> <a class="nv idl-code" data-link-type="dictionary" href="#dictdef-account">Account</a> {
    <span class="kt">required</span> <span class="kt">DOMString</span> <a class="nv" data-type="DOMString " href="#dom-account-rpdisplayname">rpDisplayName</a>;
    <span class="kt">required</span> <span class="kt">DOMString</span> <a class="nv" data-type="DOMString " href="#dom-account-displayname">displayName</a>;
    <span class="kt">required</span> <span class="kt">DOMString</span> <a class="nv" data-type="DOMString " href="#dom-account-id">id</a>;
    <span class="kt">DOMString</span>          <a class="nv" data-type="DOMString          " href="#dom-account-name">name</a>;
    <span class="kt">DOMString</span>          <a class="nv" data-type="DOMString          " href="#dom-account-imageurl">imageURL</a>;
};

<span class="kt">dictionary</span> <a class="nv idl-code" data-link-type="dictionary" href="#dictdef-scopedcredentialparameters">ScopedCredentialParameters</a> {
    <span class="kt">required</span> <a class="n" data-link-type="idl-name" href="#enumdef-scopedcredentialtype">ScopedCredentialType</a>  <a class="nv" data-type="ScopedCredentialType  " href="#dom-scopedcredentialparameters-type">type</a>;
    <span class="kt">required</span> <a class="n" data-link-type="idl-name" href="#dictdef-algorithmidentifier">AlgorithmIdentifier</a>   <a class="nv" data-type="AlgorithmIdentifier   " href="#dom-scopedcredentialparameters-algorithm">algorithm</a>;
};

<span class="kt">dictionary</span> <a class="nv idl-code" data-link-type="dictionary" href="#dictdef-scopedcredentialoptions">ScopedCredentialOptions</a> {
    <span class="kt">unsigned</span> <span class="kt">long</span>                           <a class="nv" data-type="unsigned long                           " href="#dom-scopedcredentialoptions-timeoutseconds">timeoutSeconds</a>;
    <span class="kt">USVString</span>                               <a class="nv" data-type="USVString                               " href="#dom-scopedcredentialoptions-rpid">rpId</a>;
    <span class="kt">sequence</span> &lt; <a class="n" data-link-type="idl-name" href="#dictdef-scopedcredentialdescriptor">ScopedCredentialDescriptor</a> > <a class="nv" data-default="None" data-type="sequence < ScopedCredentialDescriptor > " href="#dom-scopedcredentialoptions-excludelist">excludeList</a> = [];
    <a class="n" data-link-type="idl-name" href="#enumdef-attachment">Attachment</a>                              <a class="nv" data-type="Attachment                              " href="#dom-scopedcredentialoptions-attachment">attachment</a>;
    <a class="n" data-link-type="idl-name" href="#dictdef-authenticationextensions">AuthenticationExtensions</a>                <a class="nv" data-type="AuthenticationExtensions                " href="#dom-scopedcredentialoptions-extensions">extensions</a>;
};

<span class="kt">enum</span> <a class="nv idl-code" data-link-type="enum" href="#enumdef-attachment">Attachment</a> {
    <a class="s" href="#dom-attachment-platform">"platform"</a>,
    <a class="s" href="#dom-attachment-cross-platform">"cross-platform"</a>
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext">SecureContext</a>]
<span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="#authenticationassertion">AuthenticationAssertion</a> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#scopedcredential">ScopedCredential</a>  <a class="nv" data-readonly="" data-type="ScopedCredential" href="#dom-authenticationassertion-credential">credential</a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>       <a class="nv" data-readonly="" data-type="ArrayBuffer" href="#dom-authenticationassertion-clientdata">clientData</a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>       <a class="nv" data-readonly="" data-type="ArrayBuffer" href="#dom-authenticationassertion-authenticatordata">authenticatorData</a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>       <a class="nv" data-readonly="" data-type="ArrayBuffer" href="#dom-authenticationassertion-signature">signature</a>;
};

<span class="kt">dictionary</span> <a class="nv idl-code" data-link-type="dictionary" href="#dictdef-assertionoptions">AssertionOptions</a> {
    <span class="kt">unsigned</span> <span class="kt">long</span>                           <a class="nv" data-type="unsigned long                           " href="#dom-assertionoptions-timeoutseconds">timeoutSeconds</a>;
    <span class="kt">USVString</span>                               <a class="nv" data-type="USVString                               " href="#dom-assertionoptions-rpid">rpId</a>;
    <span class="kt">sequence</span> &lt; <a class="n" data-link-type="idl-name" href="#dictdef-scopedcredentialdescriptor">ScopedCredentialDescriptor</a> > <a class="nv" data-default="None" data-type="sequence < ScopedCredentialDescriptor > " href="#dom-assertionoptions-allowlist">allowList</a> = [];
    <a class="n" data-link-type="idl-name" href="#dictdef-authenticationextensions">AuthenticationExtensions</a>                <a class="nv" data-type="AuthenticationExtensions                " href="#dom-assertionoptions-extensions">extensions</a>;
};

<span class="kt">dictionary</span> <a class="nv idl-code" data-link-type="dictionary" href="#dictdef-authenticationextensions">AuthenticationExtensions</a> {
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext">SecureContext</a>]
<span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="#authenticationattestation">AuthenticationAttestation</a> {
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">USVString</span>     <a class="nv" data-readonly="" data-type="USVString" href="#dom-authenticationattestation-format">format</a>;
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>   <a class="nv" data-readonly="" data-type="ArrayBuffer" href="#dom-authenticationattestation-clientdata">clientData</a>;
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>   <a class="nv" data-readonly="" data-type="ArrayBuffer" href="#dom-authenticationattestation-authenticatordata">authenticatorData</a>;
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">any</span>           <a class="nv" data-readonly="" data-type="any" href="#dom-authenticationattestation-attestation">attestation</a>;
};

<span class="kt">dictionary</span> <a class="nv idl-code" data-link-type="dictionary" href="#dictdef-clientdata">ClientData</a> {
    <span class="kt">required</span> <span class="kt">DOMString</span>           <a class="nv" data-type="DOMString           " href="#dom-clientdata-challenge">challenge</a>;
    <span class="kt">required</span> <span class="kt">DOMString</span>           <a class="nv" data-type="DOMString           " href="#dom-clientdata-origin">origin</a>;
    <span class="kt">required</span> <a class="n" data-link-type="idl-name" href="#dictdef-algorithmidentifier">AlgorithmIdentifier</a> <a class="nv" data-type="AlgorithmIdentifier " href="#dom-clientdata-hashalg">hashAlg</a>;
    <span class="kt">DOMString</span>                    <a class="nv" data-type="DOMString                    " href="#dom-clientdata-tokenbinding">tokenBinding</a>;
    <a class="n" data-link-type="idl-name" href="#dictdef-authenticationextensions">AuthenticationExtensions</a>     <a class="nv" data-type="AuthenticationExtensions     " href="#dom-clientdata-extensions">extensions</a>;
};

<span class="kt">enum</span> <a class="nv idl-code" data-link-type="enum" href="#enumdef-scopedcredentialtype">ScopedCredentialType</a> {
    <a class="s" href="#dom-scopedcredentialtype-scopedcred">"ScopedCred"</a>
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext">SecureContext</a>]
<span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="#scopedcredential">ScopedCredential</a> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#enumdef-scopedcredentialtype">ScopedCredentialType</a> <a class="nv" data-readonly="" data-type="ScopedCredentialType" href="#dom-scopedcredential-type">type</a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>          <a class="nv" data-readonly="" data-type="ArrayBuffer" href="#dom-scopedcredential-id">id</a>;
};

<span class="kt">dictionary</span> <a class="nv idl-code" data-link-type="dictionary" href="#dictdef-scopedcredentialdescriptor">ScopedCredentialDescriptor</a> {
    <span class="kt">required</span> <a class="n" data-link-type="idl-name" href="#enumdef-scopedcredentialtype">ScopedCredentialType</a> <a class="nv" data-type="ScopedCredentialType " href="#dom-scopedcredentialdescriptor-type">type</a>;
    <span class="kt">required</span> <a class="n" data-link-type="idl-name" href="https://heycam.github.io/webidl/#BufferSource">BufferSource</a>   <a class="nv" data-type="BufferSource   " href="#dom-scopedcredentialdescriptor-id">id</a>;
    <span class="kt">sequence</span> &lt; <a class="n" data-link-type="idl-name" href="#enumdef-transport">Transport</a> >  <a class="nv" data-type="sequence < Transport >  " href="#dom-scopedcredentialdescriptor-transports">transports</a>;
};

<span class="kt">enum</span> <a class="nv" href="#enumdef-transport">Transport</a> {
    <a class="s" href="#dom-transport-usb">"usb"</a>,
    <a class="s" href="#dom-transport-nfc">"nfc"</a>,
    <a class="s" href="#dom-transport-ble">"ble"</a>
};

<span class="kt">interface</span> <a class="nv" href="#packedattestation">PackedAttestation</a> {
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>   <a class="nv" data-readonly="" data-type="ArrayBuffer" href="#dom-packedattestation-x5c">x5c</a>;
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>   <a class="nv" data-readonly="" data-type="ArrayBuffer" href="#dom-packedattestation-daakey">daaKey</a>;
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">DOMString</span>     <a class="nv" data-readonly="" data-type="DOMString" href="#dom-packedattestation-alg">alg</a>;
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>   <a class="nv" data-readonly="" data-type="ArrayBuffer" href="#dom-packedattestation-signature">signature</a>;
};

<span class="kt">interface</span> <a class="nv" href="#tpmattestation">TpmAttestation</a> {
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">DOMString</span>     <a class="nv" data-readonly="" data-type="DOMString" href="#dom-tpmattestation-tpmversion">tpmVersion</a>;
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>   <a class="nv" data-readonly="" data-type="ArrayBuffer" href="#dom-tpmattestation-x5c">x5c</a>;
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>   <a class="nv" data-readonly="" data-type="ArrayBuffer" href="#dom-tpmattestation-daakey">daaKey</a>;
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>   <a class="nv" data-readonly="" data-type="ArrayBuffer" href="#dom-tpmattestation-certifyinfo">certifyInfo</a>;
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">DOMString</span>     <a class="nv" data-readonly="" data-type="DOMString" href="#dom-tpmattestation-alg">alg</a>;
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>   <a class="nv" data-readonly="" data-type="ArrayBuffer" href="#dom-tpmattestation-signature">signature</a>;
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext">SecureContext</a>]
<span class="kt">interface</span> <a class="nv" href="#androidkeyattestation">AndroidKeyAttestation</a> {
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>   <a class="nv" data-readonly="" data-type="ArrayBuffer" href="#dom-androidkeyattestation-signature">signature</a>;
};

<span class="kt">interface</span> <a class="nv" href="#androidsafetynetattestation">AndroidSafetyNetAttestation</a> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">unsigned</span> <span class="kt">long</span> <a class="nv" data-readonly="" data-type="unsigned long" href="#dom-androidsafetynetattestation-version">version</a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">DOMString</span>     <a class="nv" data-readonly="" data-type="DOMString" href="#dom-androidsafetynetattestation-safetynetresponse">safetyNetResponse</a>;
};

<span class="kt">typedef</span> <span class="kt">sequence</span> &lt; <a class="n" data-link-type="idl-name" href="#typedefdef-aaguid">AAGUID</a> > <a class="nv" href="#typedefdef-authenticatorselectionlist">AuthenticatorSelectionList</a>;

<span class="kt">typedef</span> <a class="n" data-link-type="idl-name" href="https://heycam.github.io/webidl/#BufferSource">BufferSource</a> <a class="nv" href="#typedefdef-aaguid">AAGUID</a>;

</pre>
  <aside class="dfn-panel" data-for="promises">
   <b><a href="#promises">#promises</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-promises-1">4.1.1. Create a new credential (makeCredential() method)</a>
    <li><a href="#ref-for-promises-2">4.1.2. Use an existing credential (getAssertion() method)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="domexception">
   <b><a href="#domexception">#domexception</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-domexception-1">4.1.1. Create a new credential (makeCredential() method)</a> <a href="#ref-for-domexception-2">(2)</a> <a href="#ref-for-domexception-3">(3)</a>
    <li><a href="#ref-for-domexception-4">4.1.2. Use an existing credential (getAssertion() method)</a> <a href="#ref-for-domexception-5">(2)</a> <a href="#ref-for-domexception-6">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-algorithmidentifier">
   <b><a href="#dictdef-algorithmidentifier">#dictdef-algorithmidentifier</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-algorithmidentifier-1">4.4. Parameters for Credential Generation (dictionary ScopedCredentialParameters)</a>
    <li><a href="#ref-for-dictdef-algorithmidentifier-2">4.10.1. Client data used in WebAuthn signatures (dictionary ClientData)</a>
    <li><a href="#ref-for-dictdef-algorithmidentifier-3">4.10.6. Cryptographic Algorithm Identifier (type AlgorithmIdentifier)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="ascii-case-insensitive-match">
   <b><a href="#ascii-case-insensitive-match">#ascii-case-insensitive-match</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ascii-case-insensitive-match-1">5.3.1. Attestation Formats</a>
    <li><a href="#ref-for-ascii-case-insensitive-match-2">5.3.4. Verifying an Attestation Statement</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attestation-certificate">
   <b><a href="#attestation-certificate">#attestation-certificate</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attestation-certificate-1">3. Terminology</a> <a href="#ref-for-attestation-certificate-2">(2)</a>
    <li><a href="#ref-for-attestation-certificate-3">6.3.1. TPM attestation statement certificate requirements</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attestation-key-pair">
   <b><a href="#attestation-key-pair">#attestation-key-pair</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attestation-key-pair-1">3. Terminology</a> <a href="#ref-for-attestation-key-pair-2">(2)</a>
    <li><a href="#ref-for-attestation-key-pair-3">4.9. Credential Attestation Structure (interface AuthenticationAttestation)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attestation-public-key">
   <b><a href="#attestation-public-key">#attestation-public-key</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attestation-public-key-1">4.9. Credential Attestation Structure (interface AuthenticationAttestation)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="authentication">
   <b><a href="#authentication">#authentication</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-authentication-1">1. Introduction</a> <a href="#ref-for-authentication-2">(2)</a>
    <li><a href="#ref-for-authentication-3">3. Terminology</a> <a href="#ref-for-authentication-4">(2)</a> <a href="#ref-for-authentication-5">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="authenticator">
   <b><a href="#authenticator">#authenticator</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-authenticator-1">1. Introduction</a> <a href="#ref-for-authenticator-2">(2)</a> <a href="#ref-for-authenticator-3">(3)</a> <a href="#ref-for-authenticator-4">(4)</a>
    <li><a href="#ref-for-authenticator-5">1.1. Use Cases</a>
    <li><a href="#ref-for-authenticator-6">2. Conformance</a>
    <li><a href="#ref-for-authenticator-7">3. Terminology</a> <a href="#ref-for-authenticator-8">(2)</a> <a href="#ref-for-authenticator-9">(3)</a> <a href="#ref-for-authenticator-10">(4)</a> <a href="#ref-for-authenticator-11">(5)</a> <a href="#ref-for-authenticator-12">(6)</a> <a href="#ref-for-authenticator-13">(7)</a> <a href="#ref-for-authenticator-14">(8)</a> <a href="#ref-for-authenticator-15">(9)</a>
    <li><a href="#ref-for-authenticator-16">5. WebAuthn Authenticator model</a>
    <li><a href="#ref-for-authenticator-17">5.2. Signature Format</a>
    <li><a href="#ref-for-authenticator-18">5.2.1. Authenticator data</a>
    <li><a href="#ref-for-authenticator-19">5.2.2. Generating a signature</a>
    <li><a href="#ref-for-authenticator-20">5.3. Credential Attestation Statements</a>
    <li><a href="#ref-for-authenticator-21">5.3.5.1. Privacy</a>
    <li><a href="#ref-for-authenticator-22">5.3.5.2. Attestation Certificate and Attestation Certificate CA Compromise</a>
    <li><a href="#ref-for-authenticator-23">6.2. Packed Attestation Format</a>
    <li><a href="#ref-for-authenticator-24">6.4. Android Key Attestation Format</a>
    <li><a href="#ref-for-authenticator-25">6.5. Android SafetyNet Attestation Format</a>
    <li><a href="#ref-for-authenticator-26">8.4. SupportedExtensions Extension</a>
    <li><a href="#ref-for-authenticator-27">8.5. User Verification Index (UVI) Extension</a>
    <li><a href="#ref-for-authenticator-28">8.6. Location Extension</a> <a href="#ref-for-authenticator-29">(2)</a> <a href="#ref-for-authenticator-30">(3)</a> <a href="#ref-for-authenticator-31">(4)</a>
    <li><a href="#ref-for-authenticator-32">8.7. User Verification Mode (UVM) Extension</a>
    <li><a href="#ref-for-authenticator-33">10. Sample scenarios</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="authorization-gesture">
   <b><a href="#authorization-gesture">#authorization-gesture</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-authorization-gesture-1">1.1.1. Registration</a>
    <li><a href="#ref-for-authorization-gesture-2">1.1.2. Authentication</a>
    <li><a href="#ref-for-authorization-gesture-3">1.1.3. Other use cases and configurations</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="ceremony">
   <b><a href="#ceremony">#ceremony</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ceremony-1">1. Introduction</a>
    <li><a href="#ref-for-ceremony-2">3. Terminology</a> <a href="#ref-for-ceremony-3">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="conforming-user-agent">
   <b><a href="#conforming-user-agent">#conforming-user-agent</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-conforming-user-agent-1">1. Introduction</a>
    <li><a href="#ref-for-conforming-user-agent-2">2. Conformance</a> <a href="#ref-for-conforming-user-agent-3">(2)</a> <a href="#ref-for-conforming-user-agent-4">(3)</a>
    <li><a href="#ref-for-conforming-user-agent-5">3. Terminology</a> <a href="#ref-for-conforming-user-agent-6">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="credential-public-key">
   <b><a href="#credential-public-key">#credential-public-key</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-credential-public-key-1">3. Terminology</a>
    <li><a href="#ref-for-credential-public-key-2">4.2. Information about Scoped Credential (interface ScopedCredentialInfo)</a>
    <li><a href="#ref-for-credential-public-key-3">4.9. Credential Attestation Structure (interface AuthenticationAttestation)</a> <a href="#ref-for-credential-public-key-4">(2)</a> <a href="#ref-for-credential-public-key-5">(3)</a>
    <li><a href="#ref-for-credential-public-key-6">5.1.1. The authenticatorMakeCredential operation</a>
    <li><a href="#ref-for-credential-public-key-7">5.2.1. Authenticator data</a>
    <li><a href="#ref-for-credential-public-key-8">5.3.1. Attestation Formats</a>
    <li><a href="#ref-for-credential-public-key-9">5.3.3. Generating an Attestation Statement</a> <a href="#ref-for-credential-public-key-10">(2)</a>
    <li><a href="#ref-for-credential-public-key-11">6.2. Packed Attestation Format</a>
    <li><a href="#ref-for-credential-public-key-12">6.4. Android Key Attestation Format</a>
    <li><a href="#ref-for-credential-public-key-13">10.1. Registration</a> <a href="#ref-for-credential-public-key-14">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="credential-key-pair">
   <b><a href="#credential-key-pair">#credential-key-pair</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-credential-key-pair-1">3. Terminology</a> <a href="#ref-for-credential-key-pair-2">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="credential-private-key">
   <b><a href="#credential-private-key">#credential-private-key</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-credential-private-key-1">4.9. Credential Attestation Structure (interface AuthenticationAttestation)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="registration">
   <b><a href="#registration">#registration</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-registration-1">1. Introduction</a> <a href="#ref-for-registration-2">(2)</a>
    <li><a href="#ref-for-registration-3">3. Terminology</a> <a href="#ref-for-registration-4">(2)</a> <a href="#ref-for-registration-5">(3)</a> <a href="#ref-for-registration-6">(4)</a> <a href="#ref-for-registration-7">(5)</a> <a href="#ref-for-registration-8">(6)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="relying-party">
   <b><a href="#relying-party">#relying-party</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-relying-party-1">1. Introduction</a> <a href="#ref-for-relying-party-2">(2)</a> <a href="#ref-for-relying-party-3">(3)</a> <a href="#ref-for-relying-party-4">(4)</a>
    <li><a href="#ref-for-relying-party-5">3. Terminology</a> <a href="#ref-for-relying-party-6">(2)</a> <a href="#ref-for-relying-party-7">(3)</a> <a href="#ref-for-relying-party-8">(4)</a> <a href="#ref-for-relying-party-9">(5)</a> <a href="#ref-for-relying-party-10">(6)</a> <a href="#ref-for-relying-party-11">(7)</a> <a href="#ref-for-relying-party-12">(8)</a>
    <li><a href="#ref-for-relying-party-13">4.2. Information about Scoped Credential (interface ScopedCredentialInfo)</a>
    <li><a href="#ref-for-relying-party-14">4.3. User Account Information (dictionary Account)</a>
    <li><a href="#ref-for-relying-party-15">4.5. Additional options for Credential Generation (dictionary ScopedCredentialOptions)</a>
    <li><a href="#ref-for-relying-party-16">4.9. Credential Attestation Structure (interface AuthenticationAttestation)</a> <a href="#ref-for-relying-party-17">(2)</a>
    <li><a href="#ref-for-relying-party-18">5. WebAuthn Authenticator model</a>
    <li><a href="#ref-for-relying-party-19">5.2. Signature Format</a>
    <li><a href="#ref-for-relying-party-20">5.3. Credential Attestation Statements</a>
    <li><a href="#ref-for-relying-party-21">7.3. Extending request parameters</a>
    <li><a href="#ref-for-relying-party-22">7.4. Extending client processing</a>
    <li><a href="#ref-for-relying-party-23">7.6. Example extension</a>
    <li><a href="#ref-for-relying-party-24">10.2. Authentication</a>
    <li><a href="#ref-for-relying-party-25">10.3. Decommissioning</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="relying-party-identifier">
   <b><a href="#relying-party-identifier">#relying-party-identifier</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-relying-party-identifier-1">5. WebAuthn Authenticator model</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="rp-id">
   <b><a href="#rp-id">#rp-id</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-rp-id-1">3. Terminology</a> <a href="#ref-for-rp-id-2">(2)</a>
    <li><a href="#ref-for-rp-id-3">5. WebAuthn Authenticator model</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="scoped-credential">
   <b><a href="#scoped-credential">#scoped-credential</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-scoped-credential-1">1. Introduction</a> <a href="#ref-for-scoped-credential-2">(2)</a> <a href="#ref-for-scoped-credential-3">(3)</a> <a href="#ref-for-scoped-credential-4">(4)</a> <a href="#ref-for-scoped-credential-5">(5)</a>
    <li><a href="#ref-for-scoped-credential-6">3. Terminology</a> <a href="#ref-for-scoped-credential-7">(2)</a> <a href="#ref-for-scoped-credential-8">(3)</a> <a href="#ref-for-scoped-credential-9">(4)</a> <a href="#ref-for-scoped-credential-10">(5)</a> <a href="#ref-for-scoped-credential-11">(6)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="user-consent">
   <b><a href="#user-consent">#user-consent</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-user-consent-1">1. Introduction</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="user-verification">
   <b><a href="#user-verification">#user-verification</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-user-verification-1">1. Introduction</a>
    <li><a href="#ref-for-user-verification-2">3. Terminology</a> <a href="#ref-for-user-verification-3">(2)</a> <a href="#ref-for-user-verification-4">(3)</a> <a href="#ref-for-user-verification-5">(4)</a> <a href="#ref-for-user-verification-6">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="authentication-assertion">
   <b><a href="#authentication-assertion">#authentication-assertion</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-authentication-assertion-1">1. Introduction</a>
    <li><a href="#ref-for-authentication-assertion-2">3. Terminology</a> <a href="#ref-for-authentication-assertion-3">(2)</a> <a href="#ref-for-authentication-assertion-4">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="webauthn-client">
   <b><a href="#webauthn-client">#webauthn-client</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-webauthn-client-1">3. Terminology</a> <a href="#ref-for-webauthn-client-2">(2)</a>
    <li><a href="#ref-for-webauthn-client-3">5.2. Signature Format</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="web-authentication-api">
   <b><a href="#web-authentication-api">#web-authentication-api</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-web-authentication-api-1">1. Introduction</a> <a href="#ref-for-web-authentication-api-2">(2)</a> <a href="#ref-for-web-authentication-api-3">(3)</a>
    <li><a href="#ref-for-web-authentication-api-4">3. Terminology</a> <a href="#ref-for-web-authentication-api-5">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="webauthentication">
   <b><a href="#webauthentication">#webauthentication</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-webauthentication-1">4. Web Authentication API</a>
    <li><a href="#ref-for-webauthentication-2">4.1. WebAuthentication Interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-accountinformation">
   <b><a href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-accountinformation">#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-accountinformation</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-accountinformation-1">4.1.1. Create a new credential (makeCredential() method)</a> <a href="#ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-accountinformation-2">(2)</a> <a href="#ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-accountinformation-3">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-cryptoparameters">
   <b><a href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-cryptoparameters">#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-cryptoparameters</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-cryptoparameters-1">4.1.1. Create a new credential (makeCredential() method)</a> <a href="#ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-cryptoparameters-2">(2)</a> <a href="#ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-cryptoparameters-3">(3)</a> <a href="#ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-cryptoparameters-4">(4)</a> <a href="#ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-cryptoparameters-5">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-attestationchallenge">
   <b><a href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-attestationchallenge">#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-attestationchallenge</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-attestationchallenge-1">4.1.1. Create a new credential (makeCredential() method)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options">
   <b><a href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options">#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options-1">4.1.1. Create a new credential (makeCredential() method)</a> <a href="#ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options-2">(2)</a> <a href="#ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options-3">(3)</a> <a href="#ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options-4">(4)</a> <a href="#ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options-5">(5)</a> <a href="#ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options-6">(6)</a> <a href="#ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options-7">(7)</a>
    <li><a href="#ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options-8">4.1.2. Use an existing credential (getAssertion() method)</a> <a href="#ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options-9">(2)</a> <a href="#ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options-10">(3)</a> <a href="#ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options-11">(4)</a> <a href="#ref-for-dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options-12">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-webauthentication-getassertion-assertionchallenge-options-assertionchallenge">
   <b><a href="#dom-webauthentication-getassertion-assertionchallenge-options-assertionchallenge">#dom-webauthentication-getassertion-assertionchallenge-options-assertionchallenge</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-webauthentication-getassertion-assertionchallenge-options-assertionchallenge-1">4.1.2. Use an existing credential (getAssertion() method)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-webauthentication-makecredential">
   <b><a href="#dom-webauthentication-makecredential">#dom-webauthentication-makecredential</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-webauthentication-makecredential-1">1. Introduction</a>
    <li><a href="#ref-for-dom-webauthentication-makecredential-2">4.1. WebAuthentication Interface</a>
    <li><a href="#ref-for-dom-webauthentication-makecredential-3">4.10.4. Credential Descriptor (dictionary ScopedCredentialDescriptor)</a>
    <li><a href="#ref-for-dom-webauthentication-makecredential-4">5.2.3. Verifying a signature</a>
    <li><a href="#ref-for-dom-webauthentication-makecredential-5">7. WebAuthn Extensions</a> <a href="#ref-for-dom-webauthentication-makecredential-6">(2)</a>
    <li><a href="#ref-for-dom-webauthentication-makecredential-7">7.2. Defining extensions</a>
    <li><a href="#ref-for-dom-webauthentication-makecredential-8">7.3. Extending request parameters</a> <a href="#ref-for-dom-webauthentication-makecredential-9">(2)</a>
    <li><a href="#ref-for-dom-webauthentication-makecredential-10">8.3. Authenticator Selection Extension</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-webauthentication-getassertion">
   <b><a href="#dom-webauthentication-getassertion">#dom-webauthentication-getassertion</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-webauthentication-getassertion-1">1. Introduction</a>
    <li><a href="#ref-for-dom-webauthentication-getassertion-2">3. Terminology</a>
    <li><a href="#ref-for-dom-webauthentication-getassertion-3">4.1. WebAuthentication Interface</a>
    <li><a href="#ref-for-dom-webauthentication-getassertion-4">4.1.1. Create a new credential (makeCredential() method)</a> <a href="#ref-for-dom-webauthentication-getassertion-5">(2)</a>
    <li><a href="#ref-for-dom-webauthentication-getassertion-6">4.8. Authentication Assertion Extensions (dictionary AuthenticationExtensions)</a>
    <li><a href="#ref-for-dom-webauthentication-getassertion-7">4.10.4. Credential Descriptor (dictionary ScopedCredentialDescriptor)</a>
    <li><a href="#ref-for-dom-webauthentication-getassertion-8">7. WebAuthn Extensions</a> <a href="#ref-for-dom-webauthentication-getassertion-9">(2)</a>
    <li><a href="#ref-for-dom-webauthentication-getassertion-10">7.2. Defining extensions</a>
    <li><a href="#ref-for-dom-webauthentication-getassertion-11">7.3. Extending request parameters</a> <a href="#ref-for-dom-webauthentication-getassertion-12">(2)</a>
    <li><a href="#ref-for-dom-webauthentication-getassertion-13">8.1. FIDO AppId</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="scopedcredentialinfo">
   <b><a href="#scopedcredentialinfo">#scopedcredentialinfo</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-scopedcredentialinfo-1">4.1. WebAuthentication Interface</a>
    <li><a href="#ref-for-scopedcredentialinfo-2">4.1.1. Create a new credential (makeCredential() method)</a> <a href="#ref-for-scopedcredentialinfo-3">(2)</a>
    <li><a href="#ref-for-scopedcredentialinfo-4">4.2. Information about Scoped Credential (interface ScopedCredentialInfo)</a> <a href="#ref-for-scopedcredentialinfo-5">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-account">
   <b><a href="#dictdef-account">#dictdef-account</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-account-1">4.1. WebAuthentication Interface</a>
    <li><a href="#ref-for-dictdef-account-2">4.3. User Account Information (dictionary Account)</a>
    <li><a href="#ref-for-dictdef-account-3">5.1.1. The authenticatorMakeCredential operation</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-account-id">
   <b><a href="#dom-account-id">#dom-account-id</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-account-id-1">4.1.1. Create a new credential (makeCredential() method)</a>
    <li><a href="#ref-for-dom-account-id-2">4.3. User Account Information (dictionary Account)</a>
    <li><a href="#ref-for-dom-account-id-3">5.1.1. The authenticatorMakeCredential operation</a> <a href="#ref-for-dom-account-id-4">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-scopedcredentialparameters">
   <b><a href="#dictdef-scopedcredentialparameters">#dictdef-scopedcredentialparameters</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-scopedcredentialparameters-1">4.1. WebAuthentication Interface</a>
    <li><a href="#ref-for-dictdef-scopedcredentialparameters-2">4.1.1. Create a new credential (makeCredential() method)</a>
    <li><a href="#ref-for-dictdef-scopedcredentialparameters-3">4.4. Parameters for Credential Generation (dictionary ScopedCredentialParameters)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-scopedcredentialoptions">
   <b><a href="#dictdef-scopedcredentialoptions">#dictdef-scopedcredentialoptions</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-scopedcredentialoptions-1">4.1. WebAuthentication Interface</a>
    <li><a href="#ref-for-dictdef-scopedcredentialoptions-2">4.5. Additional options for Credential Generation (dictionary ScopedCredentialOptions)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-scopedcredentialoptions-timeoutseconds">
   <b><a href="#dom-scopedcredentialoptions-timeoutseconds">#dom-scopedcredentialoptions-timeoutseconds</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-scopedcredentialoptions-timeoutseconds-1">4.1.1. Create a new credential (makeCredential() method)</a> <a href="#ref-for-dom-scopedcredentialoptions-timeoutseconds-2">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-scopedcredentialoptions-rpid">
   <b><a href="#dom-scopedcredentialoptions-rpid">#dom-scopedcredentialoptions-rpid</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-scopedcredentialoptions-rpid-1">4.1.1. Create a new credential (makeCredential() method)</a> <a href="#ref-for-dom-scopedcredentialoptions-rpid-2">(2)</a> <a href="#ref-for-dom-scopedcredentialoptions-rpid-3">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-scopedcredentialoptions-excludelist">
   <b><a href="#dom-scopedcredentialoptions-excludelist">#dom-scopedcredentialoptions-excludelist</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-scopedcredentialoptions-excludelist-1">4.1.1. Create a new credential (makeCredential() method)</a> <a href="#ref-for-dom-scopedcredentialoptions-excludelist-2">(2)</a> <a href="#ref-for-dom-scopedcredentialoptions-excludelist-3">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-scopedcredentialoptions-attachment">
   <b><a href="#dom-scopedcredentialoptions-attachment">#dom-scopedcredentialoptions-attachment</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-scopedcredentialoptions-attachment-1">4.1.1. Create a new credential (makeCredential() method)</a> <a href="#ref-for-dom-scopedcredentialoptions-attachment-2">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-scopedcredentialoptions-extensions">
   <b><a href="#dom-scopedcredentialoptions-extensions">#dom-scopedcredentialoptions-extensions</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-scopedcredentialoptions-extensions-1">4.1.1. Create a new credential (makeCredential() method)</a>
    <li><a href="#ref-for-dom-scopedcredentialoptions-extensions-2">7.3. Extending request parameters</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="enumdef-attachment">
   <b><a href="#enumdef-attachment">#enumdef-attachment</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-enumdef-attachment-1">4.5. Additional options for Credential Generation (dictionary ScopedCredentialOptions)</a>
    <li><a href="#ref-for-enumdef-attachment-2">4.5.1. Credential Attachment enumeration (enum Attachment)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attachment-platform-authenticators">
   <b><a href="#attachment-platform-authenticators">#attachment-platform-authenticators</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attachment-platform-authenticators-1">4.5.1. Credential Attachment enumeration (enum Attachment)</a> <a href="#ref-for-attachment-platform-authenticators-2">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attachment-roaming-authenticators">
   <b><a href="#attachment-roaming-authenticators">#attachment-roaming-authenticators</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attachment-roaming-authenticators-1">1.1.3. Other use cases and configurations</a>
    <li><a href="#ref-for-attachment-roaming-authenticators-2">4.5.1. Credential Attachment enumeration (enum Attachment)</a> <a href="#ref-for-attachment-roaming-authenticators-3">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attachment-platform-attachment">
   <b><a href="#attachment-platform-attachment">#attachment-platform-attachment</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attachment-platform-attachment-1">4.5.1. Credential Attachment enumeration (enum Attachment)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attachment-cross-platform-attached">
   <b><a href="#attachment-cross-platform-attached">#attachment-cross-platform-attached</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attachment-cross-platform-attached-1">4.5.1. Credential Attachment enumeration (enum Attachment)</a> <a href="#ref-for-attachment-cross-platform-attached-2">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="authenticationassertion">
   <b><a href="#authenticationassertion">#authenticationassertion</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-authenticationassertion-1">3. Terminology</a>
    <li><a href="#ref-for-authenticationassertion-2">4.1. WebAuthentication Interface</a>
    <li><a href="#ref-for-authenticationassertion-3">4.1.2. Use an existing credential (getAssertion() method)</a>
    <li><a href="#ref-for-authenticationassertion-4">4.6. Web Authentication Assertion (interface AuthenticationAssertion)</a>
    <li><a href="#ref-for-authenticationassertion-5">5.2.2. Generating a signature</a>
    <li><a href="#ref-for-authenticationassertion-6">5.2.3. Verifying a signature</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-authenticationassertion-clientdata">
   <b><a href="#dom-authenticationassertion-clientdata">#dom-authenticationassertion-clientdata</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-authenticationassertion-clientdata-1">5.2.3. Verifying a signature</a> <a href="#ref-for-dom-authenticationassertion-clientdata-2">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-authenticationassertion-authenticatordata">
   <b><a href="#dom-authenticationassertion-authenticatordata">#dom-authenticationassertion-authenticatordata</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-authenticationassertion-authenticatordata-1">5.2.3. Verifying a signature</a> <a href="#ref-for-dom-authenticationassertion-authenticatordata-2">(2)</a>
    <li><a href="#ref-for-dom-authenticationassertion-authenticatordata-3">5.3.4. Verifying an Attestation Statement</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-authenticationassertion-signature">
   <b><a href="#dom-authenticationassertion-signature">#dom-authenticationassertion-signature</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-authenticationassertion-signature-1">5.2.3. Verifying a signature</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-assertionoptions">
   <b><a href="#dictdef-assertionoptions">#dictdef-assertionoptions</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-assertionoptions-1">4.1. WebAuthentication Interface</a>
    <li><a href="#ref-for-dictdef-assertionoptions-2">4.7. Additional options for Assertion Generation (dictionary AssertionOptions)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-assertionoptions-timeoutseconds">
   <b><a href="#dom-assertionoptions-timeoutseconds">#dom-assertionoptions-timeoutseconds</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-assertionoptions-timeoutseconds-1">4.1.2. Use an existing credential (getAssertion() method)</a> <a href="#ref-for-dom-assertionoptions-timeoutseconds-2">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-assertionoptions-rpid">
   <b><a href="#dom-assertionoptions-rpid">#dom-assertionoptions-rpid</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-assertionoptions-rpid-1">4.1.2. Use an existing credential (getAssertion() method)</a> <a href="#ref-for-dom-assertionoptions-rpid-2">(2)</a> <a href="#ref-for-dom-assertionoptions-rpid-3">(3)</a>
    <li><a href="#ref-for-dom-assertionoptions-rpid-4">8.1. FIDO AppId</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-assertionoptions-allowlist">
   <b><a href="#dom-assertionoptions-allowlist">#dom-assertionoptions-allowlist</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-assertionoptions-allowlist-1">4.1.1. Create a new credential (makeCredential() method)</a> <a href="#ref-for-dom-assertionoptions-allowlist-2">(2)</a>
    <li><a href="#ref-for-dom-assertionoptions-allowlist-3">4.1.2. Use an existing credential (getAssertion() method)</a> <a href="#ref-for-dom-assertionoptions-allowlist-4">(2)</a> <a href="#ref-for-dom-assertionoptions-allowlist-5">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-assertionoptions-extensions">
   <b><a href="#dom-assertionoptions-extensions">#dom-assertionoptions-extensions</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-assertionoptions-extensions-1">4.1.2. Use an existing credential (getAssertion() method)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-authenticationextensions">
   <b><a href="#dictdef-authenticationextensions">#dictdef-authenticationextensions</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-authenticationextensions-1">4.5. Additional options for Credential Generation (dictionary ScopedCredentialOptions)</a>
    <li><a href="#ref-for-dictdef-authenticationextensions-2">4.7. Additional options for Assertion Generation (dictionary AssertionOptions)</a>
    <li><a href="#ref-for-dictdef-authenticationextensions-3">4.8. Authentication Assertion Extensions (dictionary AuthenticationExtensions)</a>
    <li><a href="#ref-for-dictdef-authenticationextensions-4">4.10.1. Client data used in WebAuthn signatures (dictionary ClientData)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="authenticationattestation">
   <b><a href="#authenticationattestation">#authenticationattestation</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-authenticationattestation-1">4.2. Information about Scoped Credential (interface ScopedCredentialInfo)</a>
    <li><a href="#ref-for-authenticationattestation-2">4.9. Credential Attestation Structure (interface AuthenticationAttestation)</a>
    <li><a href="#ref-for-authenticationattestation-3">5.1.1. The authenticatorMakeCredential operation</a>
    <li><a href="#ref-for-authenticationattestation-4">5.2.2. Generating a signature</a>
    <li><a href="#ref-for-authenticationattestation-5">5.3.1. Attestation Formats</a>
    <li><a href="#ref-for-authenticationattestation-6">5.3.4. Verifying an Attestation Statement</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-authenticationattestation-format">
   <b><a href="#dom-authenticationattestation-format">#dom-authenticationattestation-format</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-authenticationattestation-format-1">5.3.4. Verifying an Attestation Statement</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-authenticationattestation-clientdata">
   <b><a href="#dom-authenticationattestation-clientdata">#dom-authenticationattestation-clientdata</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-authenticationattestation-clientdata-1">5.3.4. Verifying an Attestation Statement</a> <a href="#ref-for-dom-authenticationattestation-clientdata-2">(2)</a>
    <li><a href="#ref-for-dom-authenticationattestation-clientdata-3">6.3. TPM Attestation Format</a> <a href="#ref-for-dom-authenticationattestation-clientdata-4">(2)</a> <a href="#ref-for-dom-authenticationattestation-clientdata-5">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-authenticationattestation-authenticatordata">
   <b><a href="#dom-authenticationattestation-authenticatordata">#dom-authenticationattestation-authenticatordata</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-authenticationattestation-authenticatordata-1">5.3.4. Verifying an Attestation Statement</a> <a href="#ref-for-dom-authenticationattestation-authenticatordata-2">(2)</a>
    <li><a href="#ref-for-dom-authenticationattestation-authenticatordata-3">6.2. Packed Attestation Format</a> <a href="#ref-for-dom-authenticationattestation-authenticatordata-4">(2)</a>
    <li><a href="#ref-for-dom-authenticationattestation-authenticatordata-5">6.3. TPM Attestation Format</a> <a href="#ref-for-dom-authenticationattestation-authenticatordata-6">(2)</a> <a href="#ref-for-dom-authenticationattestation-authenticatordata-7">(3)</a> <a href="#ref-for-dom-authenticationattestation-authenticatordata-8">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-authenticationattestation-attestation">
   <b><a href="#dom-authenticationattestation-attestation">#dom-authenticationattestation-attestation</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-authenticationattestation-attestation-1">5.3.4. Verifying an Attestation Statement</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="authenticationattestation-attestation-statement">
   <b><a href="#authenticationattestation-attestation-statement">#authenticationattestation-attestation-statement</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-authenticationattestation-attestation-statement-1">3. Terminology</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-clientdata">
   <b><a href="#dictdef-clientdata">#dictdef-clientdata</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-clientdata-1">4.1.1. Create a new credential (makeCredential() method)</a>
    <li><a href="#ref-for-dictdef-clientdata-2">4.1.2. Use an existing credential (getAssertion() method)</a>
    <li><a href="#ref-for-dictdef-clientdata-3">4.10.1. Client data used in WebAuthn signatures (dictionary ClientData)</a> <a href="#ref-for-dictdef-clientdata-4">(2)</a>
    <li><a href="#ref-for-dictdef-clientdata-5">5.1.1. The authenticatorMakeCredential operation</a>
    <li><a href="#ref-for-dictdef-clientdata-6">5.1.2. The authenticatorGetAssertion operation</a>
    <li><a href="#ref-for-dictdef-clientdata-7">5.2. Signature Format</a>
    <li><a href="#ref-for-dictdef-clientdata-8">5.2.1. Authenticator data</a>
    <li><a href="#ref-for-dictdef-clientdata-9">5.2.3. Verifying a signature</a> <a href="#ref-for-dictdef-clientdata-10">(2)</a> <a href="#ref-for-dictdef-clientdata-11">(3)</a> <a href="#ref-for-dictdef-clientdata-12">(4)</a> <a href="#ref-for-dictdef-clientdata-13">(5)</a>
    <li><a href="#ref-for-dictdef-clientdata-14">5.3.4. Verifying an Attestation Statement</a> <a href="#ref-for-dictdef-clientdata-15">(2)</a> <a href="#ref-for-dictdef-clientdata-16">(3)</a> <a href="#ref-for-dictdef-clientdata-17">(4)</a> <a href="#ref-for-dictdef-clientdata-18">(5)</a>
    <li><a href="#ref-for-dictdef-clientdata-19">7. WebAuthn Extensions</a> <a href="#ref-for-dictdef-clientdata-20">(2)</a>
    <li><a href="#ref-for-dictdef-clientdata-21">7.2. Defining extensions</a> <a href="#ref-for-dictdef-clientdata-22">(2)</a>
    <li><a href="#ref-for-dictdef-clientdata-23">7.4. Extending client processing</a> <a href="#ref-for-dictdef-clientdata-24">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-clientdata-challenge">
   <b><a href="#dom-clientdata-challenge">#dom-clientdata-challenge</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-clientdata-challenge-1">5.2.3. Verifying a signature</a>
    <li><a href="#ref-for-dom-clientdata-challenge-2">5.3.4. Verifying an Attestation Statement</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-clientdata-origin">
   <b><a href="#dom-clientdata-origin">#dom-clientdata-origin</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-clientdata-origin-1">5.2.3. Verifying a signature</a>
    <li><a href="#ref-for-dom-clientdata-origin-2">5.3.4. Verifying an Attestation Statement</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-clientdata-hashalg">
   <b><a href="#dom-clientdata-hashalg">#dom-clientdata-hashalg</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-clientdata-hashalg-1">4.1.1. Create a new credential (makeCredential() method)</a>
    <li><a href="#ref-for-dom-clientdata-hashalg-2">4.1.2. Use an existing credential (getAssertion() method)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-clientdata-tokenbinding">
   <b><a href="#dom-clientdata-tokenbinding">#dom-clientdata-tokenbinding</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-clientdata-tokenbinding-1">5.2.3. Verifying a signature</a>
    <li><a href="#ref-for-dom-clientdata-tokenbinding-2">5.3.4. Verifying an Attestation Statement</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-clientdata-extensions">
   <b><a href="#dom-clientdata-extensions">#dom-clientdata-extensions</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-clientdata-extensions-1">5.2.3. Verifying a signature</a>
    <li><a href="#ref-for-dom-clientdata-extensions-2">5.3.4. Verifying an Attestation Statement</a>
    <li><a href="#ref-for-dom-clientdata-extensions-3">7.4. Extending client processing</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="clientdata-hashalg">
   <b><a href="#clientdata-hashalg">#clientdata-hashalg</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-clientdata-hashalg-1">4.10.1. Client data used in WebAuthn signatures (dictionary ClientData)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="clientdatajson">
   <b><a href="#clientdatajson">#clientdatajson</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-clientdatajson-1">4.1.1. Create a new credential (makeCredential() method)</a> <a href="#ref-for-clientdatajson-2">(2)</a>
    <li><a href="#ref-for-clientdatajson-3">4.1.2. Use an existing credential (getAssertion() method)</a> <a href="#ref-for-clientdatajson-4">(2)</a>
    <li><a href="#ref-for-clientdatajson-5">4.9. Credential Attestation Structure (interface AuthenticationAttestation)</a>
    <li><a href="#ref-for-clientdatajson-6">4.10.1. Client data used in WebAuthn signatures (dictionary ClientData)</a>
    <li><a href="#ref-for-clientdatajson-7">5.2.2. Generating a signature</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="clientdatahash">
   <b><a href="#clientdatahash">#clientdatahash</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-clientdatahash-1">4.1.1. Create a new credential (makeCredential() method)</a> <a href="#ref-for-clientdatahash-2">(2)</a>
    <li><a href="#ref-for-clientdatahash-3">4.1.2. Use an existing credential (getAssertion() method)</a> <a href="#ref-for-clientdatahash-4">(2)</a>
    <li><a href="#ref-for-clientdatahash-5">4.9. Credential Attestation Structure (interface AuthenticationAttestation)</a>
    <li><a href="#ref-for-clientdatahash-6">4.10.1. Client data used in WebAuthn signatures (dictionary ClientData)</a>
    <li><a href="#ref-for-clientdatahash-7">5.1.1. The authenticatorMakeCredential operation</a>
    <li><a href="#ref-for-clientdatahash-8">5.1.2. The authenticatorGetAssertion operation</a>
    <li><a href="#ref-for-clientdatahash-9">5.2. Signature Format</a>
    <li><a href="#ref-for-clientdatahash-10">5.2.1. Authenticator data</a>
    <li><a href="#ref-for-clientdatahash-11">5.2.2. Generating a signature</a> <a href="#ref-for-clientdatahash-12">(2)</a>
    <li><a href="#ref-for-clientdatahash-13">5.2.3. Verifying a signature</a> <a href="#ref-for-clientdatahash-14">(2)</a>
    <li><a href="#ref-for-clientdatahash-15">5.3.1. Attestation Formats</a>
    <li><a href="#ref-for-clientdatahash-16">5.3.3. Generating an Attestation Statement</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="enumdef-scopedcredentialtype">
   <b><a href="#enumdef-scopedcredentialtype">#enumdef-scopedcredentialtype</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-enumdef-scopedcredentialtype-1">4.1.1. Create a new credential (makeCredential() method)</a>
    <li><a href="#ref-for-enumdef-scopedcredentialtype-2">4.4. Parameters for Credential Generation (dictionary ScopedCredentialParameters)</a>
    <li><a href="#ref-for-enumdef-scopedcredentialtype-3">4.10.2. Credential Type enumeration (enum ScopedCredentialType)</a>
    <li><a href="#ref-for-enumdef-scopedcredentialtype-4">4.10.3. Unique Identifier for Credential (interface ScopedCredential)</a> <a href="#ref-for-enumdef-scopedcredentialtype-5">(2)</a>
    <li><a href="#ref-for-enumdef-scopedcredentialtype-6">4.10.4. Credential Descriptor (dictionary ScopedCredentialDescriptor)</a>
    <li><a href="#ref-for-enumdef-scopedcredentialtype-7">5.1.1. The authenticatorMakeCredential operation</a> <a href="#ref-for-enumdef-scopedcredentialtype-8">(2)</a> <a href="#ref-for-enumdef-scopedcredentialtype-9">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="scopedcredential">
   <b><a href="#scopedcredential">#scopedcredential</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-scopedcredential-1">4.2. Information about Scoped Credential (interface ScopedCredentialInfo)</a>
    <li><a href="#ref-for-scopedcredential-2">4.6. Web Authentication Assertion (interface AuthenticationAssertion)</a>
    <li><a href="#ref-for-scopedcredential-3">4.10.3. Unique Identifier for Credential (interface ScopedCredential)</a>
    <li><a href="#ref-for-scopedcredential-4">4.10.4. Credential Descriptor (dictionary ScopedCredentialDescriptor)</a>
    <li><a href="#ref-for-scopedcredential-5">5.1.1. The authenticatorMakeCredential operation</a> <a href="#ref-for-scopedcredential-6">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-scopedcredentialdescriptor">
   <b><a href="#dictdef-scopedcredentialdescriptor">#dictdef-scopedcredentialdescriptor</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-scopedcredentialdescriptor-1">4.5. Additional options for Credential Generation (dictionary ScopedCredentialOptions)</a>
    <li><a href="#ref-for-dictdef-scopedcredentialdescriptor-2">4.7. Additional options for Assertion Generation (dictionary AssertionOptions)</a>
    <li><a href="#ref-for-dictdef-scopedcredentialdescriptor-3">4.10.4. Credential Descriptor (dictionary ScopedCredentialDescriptor)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="enumdef-transport">
   <b><a href="#enumdef-transport">#enumdef-transport</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-enumdef-transport-1">4.10.4. Credential Descriptor (dictionary ScopedCredentialDescriptor)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="authenticatormakecredential">
   <b><a href="#authenticatormakecredential">#authenticatormakecredential</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-authenticatormakecredential-1">3. Terminology</a> <a href="#ref-for-authenticatormakecredential-2">(2)</a>
    <li><a href="#ref-for-authenticatormakecredential-3">4.1.1. Create a new credential (makeCredential() method)</a>
    <li><a href="#ref-for-authenticatormakecredential-4">5.1.3. The authenticatorCancel operation</a> <a href="#ref-for-authenticatormakecredential-5">(2)</a>
    <li><a href="#ref-for-authenticatormakecredential-6">7. WebAuthn Extensions</a>
    <li><a href="#ref-for-authenticatormakecredential-7">7.2. Defining extensions</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="authenticatorgetassertion">
   <b><a href="#authenticatorgetassertion">#authenticatorgetassertion</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-authenticatorgetassertion-1">3. Terminology</a> <a href="#ref-for-authenticatorgetassertion-2">(2)</a>
    <li><a href="#ref-for-authenticatorgetassertion-3">4.1.2. Use an existing credential (getAssertion() method)</a>
    <li><a href="#ref-for-authenticatorgetassertion-4">5.1.3. The authenticatorCancel operation</a> <a href="#ref-for-authenticatorgetassertion-5">(2)</a>
    <li><a href="#ref-for-authenticatorgetassertion-6">5.2.1. Authenticator data</a>
    <li><a href="#ref-for-authenticatorgetassertion-7">7. WebAuthn Extensions</a>
    <li><a href="#ref-for-authenticatorgetassertion-8">7.2. Defining extensions</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="authenticatorcancel">
   <b><a href="#authenticatorcancel">#authenticatorcancel</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-authenticatorcancel-1">4.1.1. Create a new credential (makeCredential() method)</a> <a href="#ref-for-authenticatorcancel-2">(2)</a> <a href="#ref-for-authenticatorcancel-3">(3)</a>
    <li><a href="#ref-for-authenticatorcancel-4">4.1.2. Use an existing credential (getAssertion() method)</a> <a href="#ref-for-authenticatorcancel-5">(2)</a> <a href="#ref-for-authenticatorcancel-6">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="authenticator-data">
   <b><a href="#authenticator-data">#authenticator-data</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-authenticator-data-1">5.3.1. Attestation Formats</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="authenticatordata">
   <b><a href="#authenticatordata">#authenticatordata</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-authenticatordata-1">5.1.2. The authenticatorGetAssertion operation</a>
    <li><a href="#ref-for-authenticatordata-2">5.2.1. Authenticator data</a> <a href="#ref-for-authenticatordata-3">(2)</a>
    <li><a href="#ref-for-authenticatordata-4">5.2.2. Generating a signature</a> <a href="#ref-for-authenticatordata-5">(2)</a> <a href="#ref-for-authenticatordata-6">(3)</a> <a href="#ref-for-authenticatordata-7">(4)</a>
    <li><a href="#ref-for-authenticatordata-8">5.3.3. Generating an Attestation Statement</a> <a href="#ref-for-authenticatordata-9">(2)</a>
    <li><a href="#ref-for-authenticatordata-10">5.3.5.3. Attestation Certificate Hierarchy</a>
    <li><a href="#ref-for-authenticatordata-11">6.4. Android Key Attestation Format</a> <a href="#ref-for-authenticatordata-12">(2)</a> <a href="#ref-for-authenticatordata-13">(3)</a>
    <li><a href="#ref-for-authenticatordata-14">7. WebAuthn Extensions</a> <a href="#ref-for-authenticatordata-15">(2)</a>
    <li><a href="#ref-for-authenticatordata-16">7.2. Defining extensions</a> <a href="#ref-for-authenticatordata-17">(2)</a>
    <li><a href="#ref-for-authenticatordata-18">7.5. Extending authenticator processing</a> <a href="#ref-for-authenticatordata-19">(2)</a>
    <li><a href="#ref-for-authenticatordata-20">7.6. Example extension</a>
    <li><a href="#ref-for-authenticatordata-21">8.5. User Verification Index (UVI) Extension</a>
    <li><a href="#ref-for-authenticatordata-22">8.6. Location Extension</a>
    <li><a href="#ref-for-authenticatordata-23">8.7. User Verification Mode (UVM) Extension</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attestation-format">
   <b><a href="#attestation-format">#attestation-format</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attestation-format-1">3. Terminology</a>
    <li><a href="#ref-for-attestation-format-2">4.9. Credential Attestation Structure (interface AuthenticationAttestation)</a>
    <li><a href="#ref-for-attestation-format-3">5.3.3. Generating an Attestation Statement</a> <a href="#ref-for-attestation-format-4">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attestation-type">
   <b><a href="#attestation-type">#attestation-type</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attestation-type-1">3. Terminology</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="basic-attestation">
   <b><a href="#basic-attestation">#basic-attestation</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-basic-attestation-1">5.3.5.1. Privacy</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="self-attestation">
   <b><a href="#self-attestation">#self-attestation</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-self-attestation-1">3. Terminology</a> <a href="#ref-for-self-attestation-2">(2)</a> <a href="#ref-for-self-attestation-3">(3)</a> <a href="#ref-for-self-attestation-4">(4)</a>
    <li><a href="#ref-for-self-attestation-5">4.9. Credential Attestation Structure (interface AuthenticationAttestation)</a>
    <li><a href="#ref-for-self-attestation-6">5.1.1. The authenticatorMakeCredential operation</a>
    <li><a href="#ref-for-self-attestation-7">5.3. Credential Attestation Statements</a>
    <li><a href="#ref-for-self-attestation-8">5.3.5.2. Attestation Certificate and Attestation Certificate CA Compromise</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="privacy-ca">
   <b><a href="#privacy-ca">#privacy-ca</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-privacy-ca-1">5.3.5.1. Privacy</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="direct-anonymous-attestation">
   <b><a href="#direct-anonymous-attestation">#direct-anonymous-attestation</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-direct-anonymous-attestation-1">5.3.5.1. Privacy</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="atttobesigned">
   <b><a href="#atttobesigned">#atttobesigned</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-atttobesigned-1">5.3.1. Attestation Formats</a>
    <li><a href="#ref-for-atttobesigned-2">5.3.3. Generating an Attestation Statement</a>
    <li><a href="#ref-for-atttobesigned-3">6.2. Packed Attestation Format</a>
    <li><a href="#ref-for-atttobesigned-4">6.4. Android Key Attestation Format</a> <a href="#ref-for-atttobesigned-5">(2)</a>
    <li><a href="#ref-for-atttobesigned-6">6.5. Android SafetyNet Attestation Format</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-packedattestation-x5c">
   <b><a href="#dom-packedattestation-x5c">#dom-packedattestation-x5c</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-packedattestation-x5c-1">6.2. Packed Attestation Format</a> <a href="#ref-for-dom-packedattestation-x5c-2">(2)</a> <a href="#ref-for-dom-packedattestation-x5c-3">(3)</a> <a href="#ref-for-dom-packedattestation-x5c-4">(4)</a> <a href="#ref-for-dom-packedattestation-x5c-5">(5)</a> <a href="#ref-for-dom-packedattestation-x5c-6">(6)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-packedattestation-daakey">
   <b><a href="#dom-packedattestation-daakey">#dom-packedattestation-daakey</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-packedattestation-daakey-1">6.2. Packed Attestation Format</a> <a href="#ref-for-dom-packedattestation-daakey-2">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-packedattestation-alg">
   <b><a href="#dom-packedattestation-alg">#dom-packedattestation-alg</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-packedattestation-alg-1">6.2. Packed Attestation Format</a> <a href="#ref-for-dom-packedattestation-alg-2">(2)</a> <a href="#ref-for-dom-packedattestation-alg-3">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-packedattestation-signature">
   <b><a href="#dom-packedattestation-signature">#dom-packedattestation-signature</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-packedattestation-signature-1">6.2. Packed Attestation Format</a> <a href="#ref-for-dom-packedattestation-signature-2">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-tpmattestation-tpmversion">
   <b><a href="#dom-tpmattestation-tpmversion">#dom-tpmattestation-tpmversion</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-tpmattestation-tpmversion-1">6.3. TPM Attestation Format</a> <a href="#ref-for-dom-tpmattestation-tpmversion-2">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-tpmattestation-x5c">
   <b><a href="#dom-tpmattestation-x5c">#dom-tpmattestation-x5c</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-tpmattestation-x5c-1">6.3. TPM Attestation Format</a> <a href="#ref-for-dom-tpmattestation-x5c-2">(2)</a> <a href="#ref-for-dom-tpmattestation-x5c-3">(3)</a> <a href="#ref-for-dom-tpmattestation-x5c-4">(4)</a> <a href="#ref-for-dom-tpmattestation-x5c-5">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-tpmattestation-daakey">
   <b><a href="#dom-tpmattestation-daakey">#dom-tpmattestation-daakey</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-tpmattestation-daakey-1">6.3. TPM Attestation Format</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-tpmattestation-certifyinfo">
   <b><a href="#dom-tpmattestation-certifyinfo">#dom-tpmattestation-certifyinfo</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-tpmattestation-certifyinfo-1">6.3. TPM Attestation Format</a> <a href="#ref-for-dom-tpmattestation-certifyinfo-2">(2)</a> <a href="#ref-for-dom-tpmattestation-certifyinfo-3">(3)</a> <a href="#ref-for-dom-tpmattestation-certifyinfo-4">(4)</a> <a href="#ref-for-dom-tpmattestation-certifyinfo-5">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-tpmattestation-alg">
   <b><a href="#dom-tpmattestation-alg">#dom-tpmattestation-alg</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-tpmattestation-alg-1">6.3. TPM Attestation Format</a> <a href="#ref-for-dom-tpmattestation-alg-2">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-tpmattestation-signature">
   <b><a href="#dom-tpmattestation-signature">#dom-tpmattestation-signature</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-tpmattestation-signature-1">6.3. TPM Attestation Format</a> <a href="#ref-for-dom-tpmattestation-signature-2">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-androidkeyattestation-signature">
   <b><a href="#dom-androidkeyattestation-signature">#dom-androidkeyattestation-signature</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-androidkeyattestation-signature-1">6.4. Android Key Attestation Format</a> <a href="#ref-for-dom-androidkeyattestation-signature-2">(2)</a> <a href="#ref-for-dom-androidkeyattestation-signature-3">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-androidsafetynetattestation-version">
   <b><a href="#dom-androidsafetynetattestation-version">#dom-androidsafetynetattestation-version</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-androidsafetynetattestation-version-1">6.5. Android SafetyNet Attestation Format</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-androidsafetynetattestation-safetynetresponse">
   <b><a href="#dom-androidsafetynetattestation-safetynetresponse">#dom-androidsafetynetattestation-safetynetresponse</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-androidsafetynetattestation-safetynetresponse-1">6.5. Android SafetyNet Attestation Format</a> <a href="#ref-for-dom-androidsafetynetattestation-safetynetresponse-2">(2)</a> <a href="#ref-for-dom-androidsafetynetattestation-safetynetresponse-3">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="client-argument">
   <b><a href="#client-argument">#client-argument</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-client-argument-1">7.3. Extending request parameters</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="content">
   <b><a href="#content">#content</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-content-1">8.2. Transaction authorization</a> <a href="#ref-for-content-2">(2)</a> <a href="#ref-for-content-3">(3)</a> <a href="#ref-for-content-4">(4)</a> <a href="#ref-for-content-5">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="typedefdef-aaguid">
   <b><a href="#typedefdef-aaguid">#typedefdef-aaguid</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-typedefdef-aaguid-1">8.3. Authenticator Selection Extension</a>
   </ul>
  </aside>
<script>/* script-dfn-panel */

        document.body.addEventListener("click", function(e) {
            var queryAll = function(sel) { return [].slice.call(document.querySelectorAll(sel)); }
            // Find the dfn element or panel, if any, that was clicked on.
            var el = e.target;
            var target;
            var hitALink = false;
            while(el.parentElement) {
                if(el.tagName == "A") {
                    // Clicking on a link in a <dfn> shouldn't summon the panel
                    hitALink = true;
                }
                if(el.classList.contains("dfn-paneled")) {
                    target = "dfn";
                    break;
                }
                if(el.classList.contains("dfn-panel")) {
                    target = "dfn-panel";
                    break;
                }
                el = el.parentElement;
            }
            if(target != "dfn-panel") {
                // Turn off any currently "on" or "activated" panels.
                queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(function(el){
                    el.classList.remove("on");
                    el.classList.remove("activated");
                });
            }
            if(target == "dfn" && !hitALink) {
                // open the panel
                var dfnPanel = document.querySelector(".dfn-panel[data-for='" + el.id + "']");
                if(dfnPanel) {
                    console.log(dfnPanel);
                    dfnPanel.classList.add("on");
                    var rect = el.getBoundingClientRect();
                    dfnPanel.style.left = window.scrollX + rect.right + 5 + "px";
                    dfnPanel.style.top = window.scrollY + rect.top + "px";
                    var panelRect = dfnPanel.getBoundingClientRect();
                    var panelWidth = panelRect.right - panelRect.left;
                    if(panelRect.right > document.body.scrollWidth && (rect.left - (panelWidth + 5)) > 0) {
                        // Reposition, because the panel is overflowing
                        dfnPanel.style.left = window.scrollX + rect.left - (panelWidth + 5) + "px";
                    }
                } else {
                    console.log("Couldn't find .dfn-panel[data-for='" + el.id + "']");
                }
            } else if(target == "dfn-panel") {
                // Switch it to "activated" state, which pins it.
                el.classList.add("activated");
                el.style.left = null;
                el.style.top = null;
            }

        });
        </script>